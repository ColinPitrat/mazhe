% This is part of Mes notes de mathématique
% Copyright (c) 2011-2016
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Changement de variables dans une intégrale multiple}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Dans ce qui suit, \( U\) et \( V\) sont des ouverts de \( \eR^N\) et \( \phi\colon U\to V\) est un \( C^1\)-difféomorphisme. Nous notons \( \mQ\) l'ensemble des cubes fermés dans \( U\) dont les cotés sont parallèles aux axes.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Des lemmes}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}[\cite{PMTIooJjAmWR}]      \label{LemooJYCGooIkkDVn}
    Soient \( \mu\) et \( \nu\) deux mesures de Borel sur l'ouvert \( U\) de \( \eR^N\). Si \( \mu(Q)\leq \nu(Q)\) pour tout \( Q\in \mQ\) alors \( \mu(B)\leq \nu(B)\) pour tout borélien \( B\).
\end{lemma}

\begin{proof}
    Si \( Q\) est un cube semi-ouvert, c'est à dire de la forme
    \begin{equation}
        Q=\prod_{i=1}N\mathopen[ a_n , a_n+h \mathclose[\subset U
    \end{equation}
    alors \( Q\) est une réunion croissante de cubes fermés du type \( \mathopen[ a_n+\epsilon , a_n+h-\epsilon \mathclose]\), et donc \( \mu(Q)\leq \nu(Q)\) par le lemme \ref{LemAZGByEs}\ref{ItemJWUooRXNPci}. La propriété est donc vraie pour les cubes semi-ouverts.

    Si \( \Omega\) est un ouvert, alors il est réunion disjointe dénombrable de cubes semi-ouverts par la proposition \ref{PropSKXGooRFHQst}. Donc pour tout ouvert \( \Omega\subset U\) nous avons \( \mu(\Omega)\leq\nu(\Omega)\). En vertu de la proposition \ref{PropNCASooBnbFrc} et de la remarque \ref{RemooOAGCooRHpjxd}, les mesures \( \mu\) et \( \nu\) sont régulières, et l'inégalité au niveau des ouverts se répercute en inégalité pour tout boréliens de \( U\) :
    \begin{equation}
        \mu(B)\leq \nu(B)
    \end{equation}
    pour tout \( B\in\Borelien(U)\). Notons que \( U\) étant ouvert dans \( \eR^N\), les boréliens de \( U\) sont exactement les boréliens de \( \eR^N\) inclus à \( U\) par le corollaire \ref{CorooMJQYooFfwoTd}.
\end{proof}

\begin{lemma}[\cite{PMTIooJjAmWR}]      \label{LemooJCEDooBRyjRg}
    Soit une application \( \theta\colon U\to \eR^N\) de classe \( C^1\) où \( U\) est ouvert dans \( \eR^N\). Pour tout \( Q\in\mQ\) nous avons
    \begin{equation}
        \lambda_N\big( \theta(Q) \big)\leq\sup_{s\in Q}\| d\theta_s \|^N\lambda_N(Q).
    \end{equation}
\end{lemma}

\begin{proof}
    Nous notons \( h\) la longueur du côté du cube. Le théorème des accroissements finis \ref{val_medio_2}, pour la composante \( \theta_i\) donne, pour \( u,v\in Q\) :
    \begin{equation}        \label{EqooFZMAooKWdzxJ}
        \big|  \theta_i(u)-\theta_i(v) \big|\leq\sup_{s\in Q}\| (d\theta_i)_s \|\| u-v \|\leq \sum_{s\in Q}\| (d\theta_i)_s \|h.
    \end{equation}
    D'autre part nous avons (nous écrivons pour \( N=2\) pour être plus court) :
    \begin{equation}
        d\theta_s(u)=\Dsdd{ \theta_1(s+tu)e_1+\theta_2(s+tu)e_2 }{t}{0}=(d\theta_1)_s(u)e_1+(d\theta_2)_s(u)e_2.
    \end{equation}
    Donc pour chaque \( i\) : \( \| d\theta_s \|\geq \| (d\theta_i)_s \|\), et nous continuons la majoration \eqref{EqooFZMAooKWdzxJ} :
    \begin{equation}
        \big|  \theta_i(u)-\theta_i(v) \big|\leq\leq \sum_{s\in Q}\| (d\theta_i)_s \|h\leq \sup_{s\in Q}\| d\theta_s \|h.
    \end{equation}
    
    Les points \( \theta(u)\) et \( \theta(v)\) sont donc dans un cube de côté \( \sup_{s\in Q}\| d\theta_s \|h\), ce qui permet de majorer \( \lambda_N\big( \theta(Q) \big)\) par
    \begin{equation}
        \lambda_N\big( \theta(Q) \big)\leq \left( \sup_{s\in Q}\| d\theta_s \|h \right)^N=\left( \sup_{s\in Q}\| d\theta_s \| \right)^N\lambda_N(Q)
    \end{equation}
    où le dernier facteur provient de l'égalité \( h^N=\lambda_N(Q)\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Déterminant et mesure de Lebesgue}
%---------------------------------------------------------------------------------------------------------------------------

Dans la suite, \( Q_0\) désigne le cube unité : \( Q_0=\big( \mathopen[ 0 , 1 \mathclose[ \big)^N\).

\begin{theorem}[Interprétation géométrique du déterminant\cite{PMTIooJjAmWR}]    \label{ThoBVIJooMkifod}
    Soit une application linéaire \( T\colon \eR^N\to \eR^N\). Alors pour tout borélien \( B\) de \( \eR^N\),
    \begin{equation}
        \lambda_N\big( T(B) \big)=| \det(T) |\lambda_N(B).
    \end{equation}
\end{theorem}
\index{déterminant!interprétation géométrique}

\begin{proof}
    Nous considérons la mesure positive \( \mu\) donnée par \( \mu(B)=\lambda_N\big( T(B) \big)\), qui est bien une mesure par la proposition \ref{PropJCJQooAdqrGA}. Cette mesure est invariante par translation parce que \( \lambda_N\) l'est :
    \begin{equation}
        \mu(B+a)=\lambda_N\big( T(B)+a \big)=\lambda_N\big( T(B) \big)=\mu(B).
    \end{equation}
    De plus, \( T(Q_0)\) est borné et nous notons \( \mu(Q_0)=C\). Nous avons \( \mu=C\lambda_N\) par le corollaire \ref{CorKGMRooHWOQGP}.

    \begin{subproof}
        \item[\( C(T_1T_2)=C(T_1)C(T_2)\)]
            Par définition, 
            \begin{equation}
                C(T_1T_2)\lambda_N(B)=\lambda_N\big( (T_1T_2)(B) \big)=\lambda_N\big( T_1(T_2B) \big)=C(T_1)\lambda_N\big( T_2(B) \big)=C(T_1)C(T_2)\lambda_N(B).
            \end{equation}
            Par conséquent la fonction \( C\) est multiplicative : 
            \begin{equation}
                C(T_1T_2)=C(T_1)C(T_2).
            \end{equation}
            Et en plus, \( C(\id)=1\).
        \item[Matrice diagonale]
            Nous considérons pour \( T=D\) l'application linéaire diagonale \( D=\diag(d_1,\ldots, d_N)\) qui fait
            \begin{equation}
                T(Q_0)=\mathopen[ 0 , d_1 \mathclose[\times \ldots\times \mathopen[  0, d_N \mathclose[
            \end{equation}
            La mesure de cela est \( |d_1\cdots d_N|\), ce qui nous donne
            \begin{equation}
                C(D)=| d_1\ldots d_N |=| \det(D) |.
            \end{equation}
        \item[Matrice orthogonale]
            Nous considérons maintenant \( T=U\) où \( U\) est une matrice orthogonale (\( UU^t=1\)). Une matrice orthogonale est une isométrie\footnote{Proposition \ref{PropKBCXooOuEZcS}.} qui conserve donc la boule unité : \( UB(0,1)=B(0,1)\). Nous avons
            \begin{equation}
                \lambda_N\big( B(0,1) \big)=\lambda_N\big( UB(0,1) \big)=C(U)\lambda_N\big( B(0,1) \big)
            \end{equation}
            par conséquent \( C(U)=1\), et \( 1\) est justement le déterminant de \( U\).
        \item[Matrice quelconque]
            Nous savons par le corollaire \ref{CorAWYBooNCCQSf} de la décomposition polaire que toute matrice peut être écrite sous la forme \( T=U_1DU_2\) où \( U_i\) sont orthogonales et \( D\) est diagonale. Donc \( C(T)=C(U_1)C(D)C(U_2)=\det(U_1)\det(D)\det(U_2)=\det(U_2DU_2)=\det(T)\) parce que le déterminant est multiplicatif (proposition \ref{PropYQNMooZjlYlA}\ref{ItemUPLNooYZMRJy}).
    \end{subproof}
\end{proof}

Ce théorème donne une interprétation géométrique du déterminant en tant que facteur de dilatation des volumes lors de l'utilisation d'une application linéaire. Si \( T\) est une application linéaire quelconque,
\begin{equation}
    \lambda_N\big( T(Q_0) \big)=| \det(T) |\lambda_N(Q_0)=| \det(T) |.
\end{equation}
Le déterminant de \( T\) est le volume de l'image du cube unité par l'application \( T\).

De la même façon, en utilisant l'application linéaire \( T(x)=ax\) nous avons pour tout borélien \( B\) :
\begin{equation}
    \lambda_N(aB)=a^N\lambda_N(B).
\end{equation}
Une dilatation d'un facteur \( a\) des longueurs provoque une multiplication par \( a^N\) des volumes.


%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Le théorème et sa démonstration}
%---------------------------------------------------------------------------------------------------------------------------

\begin{theorem}[Changement de variable\cite{VSMEooLwNLHd,PMTIooJjAmWR}]         \label{THOooUMIWooZUtUSg}
    Soient \( U\) et \( V\) des ouverts de \( \eR^N\) ainsi qu'un \( C^1\)-difféomorphisme \(\phi\colon U\to V\).
    \begin{enumerate}
        \item   \label{ItemVWYDooOzwnyfi}
            Si \( E\subset U\) est borélien, alors \( \phi(E)\) est borélien et
            \begin{equation}
                \lambda_N\big( \phi(E) \big)=\int_E| J_{\phi} |d\lambda_N,
            \end{equation}
            c'est à dire \( \phi^{-1}(\lambda_N)=| J_{\phi} |\cdot \lambda_N\).
        \item       \label{ITEMooEZUBooGBuDOS}
            Si \( f\colon V\to \mathopen[ 0 , +\infty \mathclose]\) est mesurable alors la fonction
            \begin{equation}
                (f\circ\phi)\times | J_{\phi} |\colon U\to \mathopen[ 0 , \infty \mathclose]
            \end{equation}
            l'est également et\footnote{L'intégrabilité d'une fonction est la définition \ref{DefTCXooAstMYl} qui stipule que l'intégrale de \( | f(x) |\) est finie. L'égalité proposée a un sens si les deux membres sont infinis. Il n'y a donc pas d'hypothèses d'intégrabilité obligatoire pour écrire une intégrale lorsque la fonction a des valeurs positives.}
            \begin{equation}        \label{EqRANEooQsFhbC}
                \int_Vfd\lambda_N=\int_U(f\circ\phi)(x)| J_{\phi}(x) |d\lambda_N(x).
            \end{equation}
        \item       \label{ITEMooAJGDooGHKnvj}
            Si \( f\colon V\to \eC\) est mesurable alors elle est intégrable si et seulement si \( (f\circ \phi)\times | J_{\phi} |\colon U\to \eC\) est intégrable. Si c'est le cas, alors nous avons encore la formule de changement de variables :
            \begin{equation}        \label{EQooLYAWooTArAZR}
                \int_Vfd\lambda_N=\int_U (f\circ \phi)| J_{\phi} |d\lambda_N.
            \end{equation}
    \end{enumerate}
\end{theorem}


\begin{proof}
    Attention : la preuve va être longue.
    \begin{enumerate}
        \item
            Le fait que \( \phi(E)\) soit borélien lorsque \( E\) l'est est la proposition \ref{PropRDRNooFnZSKt}. En ce qui concerne la formule annoncée, il faut travailler.
            \begin{subproof}
            \item[Inégalité dans un sens (cubes)]
                Nous commençons par prouver l'inégalité
                \begin{equation}        \label{EqooQCXXooSjGzks}
                    \lambda_N\big( \phi(Q) \big)\leq \int_Q| J_{\phi}(x) |dx
                \end{equation}
                pour tout \( Q\in \mQ\). On peut diviser le côté du cube \( Q\) en \( k\) éléments de longueurs égales. Le cube est alors divisé en \( k^N\) petits cubes d'intérieurs disjoints. Nous les nommons \( Q_i\) (\( i=1,\ldots, k^N\)) Nous avons alors
                \begin{equation}
                    \sum_i\lambda_N(Q_i)=\sum_i\lambda_N\big( \Int(Q_i) \big)=\lambda_N\big( \bigcup_i\Int(Q_i) \big)\leq \lambda_N(Q)\leq \sum_i\lambda_N(Q_i).
                \end{equation}
                La dernière inégalité est le fait que les intersections ne sont pas disjointes. Toutes ces inégalités sont en réalité des égalités et en particulier : \( \lambda_N(Q)=\sum_i\lambda_N(Q_i)\).

                Soit \( a\in Q_i\) et posons
                \begin{equation}
                    \begin{aligned}
                        \theta&\colon U&\to U \\
                        \theta&=(d\phi_{a})^{-1}\circ\phi 
                    \end{aligned}
                \end{equation}
                Cela appelle deux commentaires. D'abord l'application \( d\phi_{a}\colon U\to V\) est inversible parce que \( \phi\) est un difféomorphisme (lemme \ref{LemooTJSZooWkuSzv}). Ensuite, l'application \( \theta\) est la composée de \( (d\phi_{a})\) (qui est linéaire) et de \( \phi\) qui est de classe \( C^1\); donc \( \theta\) est de classe \( C^1\). Donc le lemme \ref{LemooJCEDooBRyjRg} s'applique. La différentielle de \( \theta\) n'est pas trop compliquée à écrire parce que nous avons la formule de différentielle d'une composée (théorème \ref{ThoAGXGuEt}) et le fait que \( (d\phi_{a})^{-1}\) qui est linéaire et donc sa propre différentielle (lemme \ref{LemooXXUGooUqCjmp}). Nous avons donc \( d\theta=(d\phi_a)^{-1}\circ d\phi\), et le lemme donne
                \begin{equation}
                    \lambda_N\left( (d\phi_a)^{-1}\phi(a) \right)\leq \sup_{s\in Q_i}\|    (d\phi_a)^{-1}\circ d\phi_s  \|^N\lambda_N(Q_i)
                \end{equation}
                Étant donné que \( (d\phi_a)^{-1}\) est une application linéaire, la proposition \ref{ThoBVIJooMkifod} s'applique, et donc
                \begin{equation}
                    \lambda_N\left( (d\phi_a)^{-1}\phi(a) \right)=| \det(d\phi_a)^{-1} |\lambda_N\big( \phi(a) \big).
                \end{equation}
                Le déterminant d'une application réciproque est donné par la proposition \ref{PropYQNMooZjlYlA}\ref{ItemooPJVYooYSwqaE} :
                \begin{equation}
                    \det\big( (d\phi_a)^{-1} \big)=\frac{1}{ \det\big( d\phi_a \big) }=\frac{1}{ J_{\phi}(a) }.
                \end{equation}
                Recollant les morceaux,
                \begin{equation}
                    \lambda_N\big( \phi(Q_i) \big)\frac{1}{ J_{\phi}(a) }\leq \sup_{s\in Q_i}\| (d\phi_a)^{-1}\circ d\phi_s \|^N\lambda_N(Q_),
                \end{equation}
                ou encore :
                \begin{equation}
                    \lambda_N\big( \phi(Q_i) \big)\leq | J_{\phi}(a) |\sup_{s\in Q_i}\| (d\phi_a)^{-1}\circ d\phi_s \|^N\lambda_N(Q_i).
                \end{equation}
                Vu que \( a\) et \( s\) sont proches l'un de l'autre (on peut choisir encore la taille du cube), nous pouvons espérer que \( (d\phi_a)^{-1}\) ne soit pas loin d'être l'inverse de \( d\phi_s\). Et c'est en effet le cas. Pour s'en assurer, remarquons que l'application
                \begin{equation}
                    d\phi\colon Q_i\to \aL(\eR^N,\eR^N)
                \end{equation}
                est continue et même uniformément continue parce que \( Q_i\) est compact. De plus la composition de différentielles étant un produit de matrices nous pouvons permuter la limite dans le calcul suivant :
                \begin{equation}
                    \lim_{s\to a}(d\phi_a)^{-1}\circ d\phi_s=(d\phi_a)^{-1}\circ\lim_{s\to a}d\phi_s=\mtu.
                \end{equation}
                Donc si \( \epsilon>0\) est donné, il existe \( \delta\) tel que pour tout \( s\in B(a,\delta)\), \( \| (d\phi_a)^{-1}\circ d\phi_s-\mtu \|\leq \epsilon\). En ce qui concerne les  normes, si \( \| A-\mtu \|\leq \epsilon\) alors \( \| A \|\leq \| A-\mtu \|+\| \mtu \|\leq \epsilon+1\).

                Cela étant dit, nous nous souvenons que nous avions découpé \( U\) en un nombre fini de cubes \( Q_i\) d'égales dimensions; il suffit de prendre \( k\) suffisamment grand pour que la diagonale des cubes sot plus petite que le minimum des \( \delta_i\). Avec un tel découpage,
                \begin{equation}
                    \sup_{s\in Q_i}\| (d\phi_a)^{-1}\circ d\phi_s \|\leq 1+\epsilon
                \end{equation}
                et par conséquent
                \begin{equation}        \label{EqooQRMNooZduAkX}
                    \lambda_N\big( \phi(Q_i) \big)\leq (1+\epsilon)^N| J_{\phi}(a_i) |\lambda_N(Q_i)
                \end{equation}
                où nous avons ajouté un indice \( i\) au point \( a\) pour nous rappeler que nous avons choisit \( a\in Q_i\). 

                Le théorème des valeurs intermédiaires \ref{ThoooEZLGooMChwLT} appliqué à l'intégrale \( \int_{Q_i}| J_{\phi}(t) |d\lambda_N(t)\) donne l'existence d'un \( a_i\in Q_i\) tel que
                \begin{equation}
                    | J_{\phi}(a_i) |=\frac{1}{ \lambda_N(Q_i) }\int_{Q_i}| J_{\phi} |d\lambda_N.
                \end{equation}
                Ce point \( a_i\) vérifie l'inégalité \eqref{EqooQRMNooZduAkX} comme tout point de \( Q_i\). Nous sommons ces inégalités sur tous les \( i\) :
                \begin{subequations}
                    \begin{align}
                        \lambda_N\big( \phi(Q) \big)&\leq\sum_i\lambda_N\big( \phi(Q_i) \big)\\
                        &\leq (1+\epsilon^N\sum_i\left( \frac{1}{ \lambda_N(Q_i)\int_{Q_i}| J_{\phi} |d\lambda_N } \right)\lambda_N(Q_i)\\
                        &=(1+\epsilon)^N\sum_i\int_{Q_i}| J_{\phi} |d\lambda_N\\
                        &=(1+\epsilon)^N\int_Q| J_{\phi} |d\lambda_N
                    \end{align}
                \end{subequations}
                où nous avons utilisé le fait que \( \mtu_Q=\sum_i\mtu_{Q_i}\) presque partout. En prenant le limite \( \epsilon\to 0\) nous trouvons
                \begin{equation}
                    \lambda_N\big( \phi(Q) \big)\leq \int_Q| J_{\phi} |d\lambda_N.
                \end{equation}
                L'inégalité \eqref{EqooQCXXooSjGzks} est prouvée.
            \item[Inégalité pour les boréliens]

                Soit \( B\) un borélien de \( U\). Vu que \( U\) et \( V\) sont des ouverts de \( \eR^N\), les mesures de Lebesgue sur \( U\) et sur \( V\) sont les mêmes que celles sur \( \eR^n\)  par le corollaire \ref{CorooMJQYooFfwoTd}.

                Par les définitions \ref{PropooVXPMooGSkyBo} et \ref{PropJCJQooAdqrGA}, les applications \( \mu\) et \( n\) définies par \( \mu=\phi^{-1}(\lambda_N)\) et \( \nu=| J_{\phi} |\lambda_N\) sont des mesures positives sur \( U\) (de Borel, qui plus est). L'inégalité \eqref{EqooQCXXooSjGzks} à peine prouvée s'écrit \( \mu(Q)\leq \nu(Q)\) pour tout cube \( Q\). Le lemme \ref{LemooJYCGooIkkDVn} nous dit alors que l'inégalité tient pour tout borélien.

            \item[Inégalité dans l'autre sens]

                En utilisant la notation de la mesure image et du produit d'une mesure par une fonction\footnote{Définition \ref{PropJCJQooAdqrGA} et \ref{PropooVXPMooGSkyBo}}, nous pouvons écrire l'inégalité prouvée sous la forme \( \phi^{-1}(\lambda_N)\leq | J_{\phi} |\lambda_N\). En inversant les rôles de \( U\) et \( V\) (et donc de \( \phi\) et \( \phi^{-1}\)) nous avons aussi
                \begin{equation}
                    \phi(\lambda_N)\leq| J_{\phi^{-1}} |\lambda_N.
                \end{equation}
                En y appliquant \( \phi^{-1}\) et le lemme \ref{PropJCJQooAdqrGA},
                \begin{equation}        \label{EqooHJCHooVIaheI}
                    \lambda_N\leq \phi^{-1}\big( | J_{\phi^{-1}} |\lambda_N \big).    
                \end{equation}
                Nous prouvons à présent que \( \phi^{-1}\big( | J_{\phi^{-1}} |\cdot \lambda_N \big)=\Big( | J_{\phi^{-1}} |\circ\phi \Big)\cdot \phi^{-1}(\lambda_N)\) en appliquant à un borélien \( B\) de \(U\).
                D'une part 
                \begin{subequations}
                    \begin{align}
                        \phi^{-1}\big( | J_{\phi^{-1}} |\cdot\lambda_N \big)(B)&=\big( | J_{\phi^{-1}} |\cdot\lambda_N \big)\phi(B)\\
                        &=\int_{\phi(B)}| J_{\phi^{-1}} |d\lambda_N,
                    \end{align}
                \end{subequations}
                et d'autre part,
                \begin{subequations}
                    \begin{align}
                        \big( | J_{\phi^{-1}} |\circ\phi \big)\cdot\phi^{-1}(\lambda_N)B&=\int_{\eR^N}\mtu_B(x)\big( | J_{\phi^{-1}} |\circ\phi \big)(x)d\big( \phi^{-1}(\lambda_N) \big)(x)\\
                        &=   \int_{\eR^N}\mtu_B\big( \phi^{-1}(x) \big)\big( | J_{\phi^{-1}} |\circ\phi \big)\big( \phi^{-1}(x) \big)d\lambda_N(x)       \label{ooDKSWooXwQwgO}\\
                        &=\int_{\eR^N}\mtu_{\phi(B)}| J_{\phi^{-1}} |\\
                        &=\int_B| J_{\phi^{-1}} |d\lambda_N.
                    \end{align}
                \end{subequations}
                Justification :
                \begin{itemize}
                    \item Pour \eqref{ooDKSWooXwQwgO}, le théorème \ref{THOooVADUooLiRfGK}\ref{ItemooLAPYooUreDEl}.
                \end{itemize}

                L'équation \eqref{EqooHJCHooVIaheI} devient alors
                \begin{equation}
                    \lambda_N\leq \big( | J_{\phi^{-1}} |\circ\phi \big)\cdot \phi^{-1}(\lambda_N).
                \end{equation}
                Nous allons faire le produit de cette mesure par \( | J_{\phi} |\) en nous souvenant que \( J_{\phi}(x)=\det\big( d\phi_x \big)\). Par le lemme \ref{LemooTJSZooWkuSzv} nous avons aussi \(   (d\phi_x)^{-1}=d\phi^{-1}_{\phi(x)} \) et donc, par la propriété \ref{PropYQNMooZjlYlA}\ref{ITEMooZMVXooLGjvCy} du déterminant,
                \begin{equation}
                    J_{\phi}(x)=\frac{1}{ \det\big( d\phi^{-1}_{\phi(x)} \big) }=\frac{1}{ J_{\phi^{-1}}\big( \phi(x) \big) }.
                \end{equation}
                Nous avons
                \begin{equation}
                    | J_{\phi} |\cdot\lambda_N\leq | J_{\phi} |\cdot\big( | J_{\phi^{-1}} |\circ\phi \big)\cdot\phi^{-1}(\lambda_N).
                \end{equation}
                En utilisant la proposition \ref{PropooJMWAooDzfpmB}, il s'agit de multiplier la mesure \( \phi^{-1}(\lambda_N)\) par la fonction
                \begin{equation}
                    x\mapsto | J_{\phi}(x)J_{\phi^{-1}}\big( \phi(x) \big) |=1.
                \end{equation}
                Nous avons donc bien
                \begin{equation}
                    | J_{\phi} |\cdot \lambda_N\leq \phi^{-1}(\lambda_N),
                \end{equation}
                et donc l'égalité
                \begin{equation}
                    | J_{\phi} |\cdot\lambda_N=\phi^{-1}(\lambda_N),
                \end{equation}
                c'est à dire le point \ref{ItemVWYDooOzwnyfi}.
            \end{subproof}
        \item
            Le fait que la fonction proposée soit mesurable est le fait que la mesurabilité n'est pas affectée par produit et composition (propositions \ref{PROPooODDVooEEmmTX} et \ref{PROPooEFHKooARJBwW}), et le fait que pour les mêmes raisons, l'application \( J_{\phi}\colon U\to \eR\) est également mesurable. En ce qui concerne la formule nous allons la démontrer dans le cas de fonctions de plus en plus générales.
            \begin{subproof}
            \item[Pour les fonctions indicatrices]
                Soit \( B\) un borélien de \( U\), et considérons la fonction \( f=\mtu_{\phi(B)}\). Alors
                \begin{equation}    \label{EqYXRFooJEqVBH}
                        \int_V fd\lambda_N=\int_{\eR^N}\mtu_{\phi(B)}(y)\mtu_V(y)d\lambda_N(y)
                        =\int_{\eR^N}\mtu_{\phi(B)}d\lambda_N
                        =\lambda_N\big( \phi(B) \big).
                \end{equation}
                parce que \( V=\phi(U)\) et \( B\subset U\), donc \( \mtu_{\phi(B)}\mtu_{\phi(U)}=\mtu_{\phi(B)}\). D'autre part, pour calculer l'autre membre de \eqref{EqRANEooQsFhbC} nous remarquons que \( f=\mtu_{\phi(B)}=\mtu_B\circ\phi^{-1}\), ce qui donne
                \begin{equation}        \label{EqHWRQooKIfPTu}
                    \int_Uf\big( \phi(x) \big)| J_{\phi}(x) |d\lambda_N(x)=\int_U\mtu_B| J_{\phi} |d\lambda_N=\int_B| J_{\phi} |d\lambda_N.
                \end{equation}
                L'ensemble \( B\) étant borélien, il est extrêmement mesurable, ce qui fait que le point \ref{ItemVWYDooOzwnyfi} s'applique : les expressions \eqref{EqYXRFooJEqVBH} et \eqref{EqHWRQooKIfPTu} sont égales.

            \item[Pour les fonctions étagées]

                   Soit \( f\colon V\to \eR^+\) une fonction étagée :
                   \begin{equation}
                       f(x)=\sum_{i=1}^na_i\mtu_{A_i}(x)
                   \end{equation}
                   Nous pouvons faire le calcul suivant :
                   \begin{subequations}
                       \begin{align}
                           \int_Vfd\lambda_N&=\int_V\sum_ia_i\mtu_{A_i}d\lambda_N\\
                           &=\sum_ia_i\int_{V}\mtu_{A_i}d\lambda_N      \label{ooNESRooDuNUYF}\\
                           &=\sum_i\int_U(\mtu_{a_i}\circ\phi)(x)| J_{\phi}(x) |d\lambda_N(x)   \label{ooYXHSooKMPrIT}\\
                           &=\sum_ia_i\int_U\mtu_{\phi^{-1}(A_i)}| J_{\phi}(x) |d\lambda_N(x)\\
                           &=\int_V\underbrace{\sum_ia_i\mtu_{\phi^{-1}(A_i)}(x)}_{=(f\circ\phi)(x)}| J_{\phi}(x) |d\lambda_N(x)\\
                           &=\int_V(f\circ\phi)| J_{\phi} |d\lambda_N.
                       \end{align}
                   \end{subequations}
                   Justifications :
                   \begin{itemize}
                       \item Pour \eqref{ooNESRooDuNUYF} : linéarité de l'intégrale, théorème \ref{ThoooCZCXooVvNcFD}\ref{ITEMooBLEVooDznQTY}\footnote{Il est remarquable que nous n'utilisons cette linéarité que pour les fonction étagées.}
                       \item Pour \eqref{ooYXHSooKMPrIT} : le cas des fonctions indicatrices est utilisé pour chaque \( i\) entre \( 1\) et \( n\).
                   \end{itemize}

               \item[Fonction mesurable positive]
                   Soit \( f\colon V\to \mathopen[ 0 , \infty \mathclose]\). Par le théorème fondamental d'approximation \ref{THOooXHIVooKUddLi}, il existe une suite croissante de fonctions étagées et mesurables \( \varphi_n\colon V\to \mathopen[ 0 , \infty \mathclose[\) dont la limite ponctuelle est \( f\).  Nous avons alors le calcul suivant :
                       \begin{subequations}
                           \begin{align}
                               \int_Vfd\lambda_N&=\lim_{n\to \infty} \int_V\varphi_nd\lambda_N  \label{ooGMMFooXLHijj}\\
                               &=\lim_{n\to \infty} \int_U(\varphi_n\circ\phi)| J_{\phi} |d\lambda_N \label{ooWIFWooXELNUs}\\
                               &=\int_U\lim_{n\to \infty} (\varphi_n\circ\phi)| J_{\phi} |d\lambda_N \label{ooNKXNooUYeWKo}\\
                               &=\int_U(f\circ\phi)| J_{\phi} |d\lambda_N       \label{ooOAIDooAILHIB}.
                           \end{align}
                       \end{subequations}
                       Justifications :
                       \begin{itemize}
                           \item Pour \eqref{ooGMMFooXLHijj}, c'est le théorème de la convergence monotone \ref{ThoRRDooFUvEAN}.
                           \item Pour \eqref{ooWIFWooXELNUs}, c'est le présent théorème pour la fonction étagée \( \varphi_n\).
                           \item Pour \eqref{ooNKXNooUYeWKo}, c'est encore la convergence dominée, justifiée par le fait que \(  \varphi_n\circ\phi    \) est également une suite croissante : si \( x\in U\) alors \( \varphi_{n+1}\big( \phi(x) \big)\geq \varphi_n\big( \phi(x) \big)   \).\
                           \item Pour \eqref{ooOAIDooAILHIB}, c'est la limite ponctuelle \( \varphi_n\big( \phi(x) \big)\to f\big( \phi(x) \big)\).
                       \end{itemize}
            \end{subproof}
        \item
            La partie sur l'intégrabilité repose sur le fait que  \( | f |\circ\phi=| f\circ\phi |\). Ici \( | . |\) est le module et non une valeur absolue. Les faits suivants sont équivalents :
            \begin{itemize}
                \item la fonction \( f\colon V\to \eC\) est intégrable
                \item la fonction \( | f |\colon V\to \eR\) est intégtrable
                \item la fonction \( (| f |\circ\phi)| J_{\phi} |\colon U\to \eR\) est intégrable (par le point \ref{ITEMooEZUBooGBuDOS}).
                \item la fonction \( (f\circ\phi)| J_{\phi} |\colon U\to \eR\) est intégrable.
            \end{itemize}
            En ce qui concerne la formule, il s'agit seulement d'appliquer le point \ref{ITEMooEZUBooGBuDOS} aux parties positives, négatives, imaginaires et réelles de \( f\).
    \end{enumerate}
\end{proof}

Notons que la formule peut être écrite sous la forme
\begin{equation}        \label{EQooQKARooELPCFO}
    \langle f, g\rangle_V=\langle f\circ\phi, (g\circ\phi)| J |\rangle_U,
\end{equation}
qui est plus pratique lorsqu'on parle de produits scalaires. Pour rappel, \( \phi\colon U\to C\) est un \( C^1\)-difféomorphisme.

\begin{normaltext}
La formule de changement de variables peut être comprise de la façon suivante. Si $\phi$ est linéaire  alors le facteur $|J_{\phi}|$ est la mesure de l'image par $\phi$ d'une portion de $\eR^p$ de mesure $1$, sinon  $|J_{\phi}|$ est le rapport entre la mesure de l'image d'un élément infinitésimale de volume de $\eR^p$ et sa mesure originale. 

Soit $\phi(u,v)=g(u,v)e_1+h(u,v)e_2$ un difféomorphisme dans $\eR^2$. Soit $(x_0, y_0)$ l'image par $\phi$ de $(u_0,v_0)$. On considère le petit rectangle $R$ de sommets $(u_0,v_0)$, $(u_0+\Delta u,v_0)$, $(u_0+\Delta u,v_0+\Delta v)$ et $(u_0,v_0+\Delta v)$. L'image de $R$ n'est pas un rectangle en général, mais peut être bien approximée par le rectangle de sommets $(x_0,y_0)$, $(x_0 ,y_0)+ \phi_{u}\Delta u$, $(x_0 ,y_0)+\phi_{u}\Delta u +\phi_{v}\Delta v$ et  $(x_0 ,y_0)+ \phi_{v}\Delta v$ et son aire est $\| \phi_{u}\times \phi_{v}\| \Delta u\Delta v$. La valeur $|\phi_{u}\times \phi_{v}|$ est exactement $|J_{\phi}|$ 
\end{normaltext}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Exemples}
%---------------------------------------------------------------------------------------------------------------------------

\begin{example}
Soit $V$ la région trapézoïdale de sommets $(0,-1)$, $(1,0)$, $(2,0)$, $(0,-2)$, comme à la figure \ref{LabelFigZTTooXtHkcissLabelSubFigZTTooXtHkci0}. Calculons ensemble l'intégrale double  
\[
\int_{V}e^{\frac{x+y}{x-y}}\,dV,
\] 
avec le changement de variable $\psi(x,y)=(x+y,x-y)$. C'est à dire que nous considérons les nouvelles variables
\begin{subequations}
	\begin{numcases}{}
		u=x+y\\
		v=x-y.
	\end{numcases}
\end{subequations}
Il faut remarquer d'abord que le changement de variable proposé est dans le mauvais sens. On écrit alors $\phi(u,v)=\psi^{-1}(u,v)=\big((u+v)/2, (u-v)/2\big)$, c'est à dire
\begin{subequations}
	\begin{numcases}{}
		x=\frac{ u+v }{ 2 }\\
		y=\frac{ u-v }{2}.
	\end{numcases}
\end{subequations}
La région qui correspond à $V$ est $U$, le trapèze de sommets  $(-1,1)$, $(1,1)$, $(2,2)$ et $(-2,2)$, qu'on voit sur la figure \ref{LabelFigZTTooXtHkcissLabelSubFigZTTooXtHkci1} et qu'on décrit par
\[
U=\{ (u,v)\in\eR^2\,\vert\, 1\leq v\leq 2, \, -v\leq u\leq v\}.
\] 

% Celui-ci a été supprimée le 17 juillet 2014
%\ref{LabelFigexamplechangementvariables}
%\newcommand{\CaptionFigexamplechangementvariables}{Avant et après le changement de variables}
%\input{auto/pictures_tex/Fig_examplechangementvariables.pstricks}

%The result is on figure \ref{LabelFigZTTooXtHkci}. % From file ZTTooXtHkci
%See also the subfigure \ref{LabelFigZTTooXtHkcissLabelSubFigZTTooXtHkci0}
%See also the subfigure \ref{LabelFigZTTooXtHkcissLabelSubFigZTTooXtHkci1}
\newcommand{\CaptionFigZTTooXtHkci}{Avant et après le changement de variables}
\input{auto/pictures_tex/Fig_ZTTooXtHkci.pstricks}

On observe que $U$ est une région du premier type tandis que $V$ n'est pas du premier ou du deuxième type. Le déterminant de la  matrice  jacobienne de $\psi^{-1}$ est  $J_{\psi^{-1}}$,
\begin{equation}
 J_{\psi^{-1}}(u,v)= \left\vert\begin{array}{cc}
\frac{1}{2} & \frac{1}{2} \\
\frac{1}{2}  & -\frac{1}{2}
\end{array}\right\vert= -\frac{1}{2}.
\end{equation}
On a alors 
\[
\int_{V}e^{\frac{x+y}{x-y}}\,dV=\int_{U}e^{\frac{u}{v}}\,\frac{1}{2}\,dV=\int_1^2\int_{-v}^{v}e^{\frac{u}{v}}\,\frac{1}{2}\, du\,dv= \frac{3}{4}(e-e^{-1}).
\] 
\end{example}

\begin{example} 
\textbf{Coordonnées polaires : }On veut évaluer l'intégrale de la fonction $f(x,y)= x^2+y^2$ sur la région $V$ suivante :
\[
V=\{(x,y) \in \eR^2\,\vert\, x^2+y^2\leq 1,\, x>0,\, y>0\}.
\]
On peut faire le calcul directement,
\[
\int_{V}f(x,y)\, dV=\int_0^1\int_0^{\sqrt{1-x^2}}x^2+y^2\, dy\,dx=\int_0^1x^2\sqrt{1-x^2} + \frac{(1-x^2)^{3/2}}{3}\, dx  
\] 
mais c'est un peu ennuyeux. On peut simplifier beaucoup les calculs avec un changement de variables vers les coordonnées polaires. Dans ce cas, on sait bien que le difféomorphisme à utiliser est $\phi(r,\theta)=(r\cos \theta, r\sin\theta)$. Le jacobien  $J_{\phi}$ est
\begin{equation}
 J_{\phi}(r, \theta)= \left\vert\begin{array}{cc}
\cos \theta & \sin \theta \\
-r\sin \theta  & r\cos \theta
\end{array}\right\vert= r,
\end{equation}
qui est toujours positif. La fonction $f$ peut s'écrire comme $f(\phi(r,\theta))=r^2$ et $\phi^{-1}(V)=]0,1]\times]0, \pi/2[$.  
La formule du changement de variables nous donne
\[
\int_{V}f(x,y)\, dV=\int_0^{\pi/2}\int_0^{1}r^3 dr\,d\theta=\int_0^{\pi/2}\frac{1}{4}\,d\theta=\frac{\pi}{8}.  
\] 
\end{example}

\begin{example}
\textbf{Coordonnées cylindriques : }On veut calculer le volume de la région $A$ définie par  l'intersection entre la boule unité et le cylindre qui a pour base un disque de rayon $1/2$ centré en $(0, 1/2)$
\[
A=\{(x,y,z) \in\eR^3 \,\vert\, x^2+y^2+z^1\leq 1\}\cap\{(x,y,z) \in \eR^3\,\vert\, x^2+(y-1/2)^2\leq 1/4\}.
\]
On peut décrire $A$ en coordonnées cylindriques
\begin{equation}
  \begin{aligned}
    A=\Big\{(r,\theta,z) &\in ]0, +\infty[\times [-\pi,\pi[\times \eR\,\vert\,\\
& -\pi/2<\theta<\pi, \, 0<r\leq \sin\theta, \, -\sqrt{1-r^2}\leq z\leq\sqrt{1-r^2} \Big\}.
  \end{aligned}
\end{equation}
Le jacobien de ce changement de variables,  $J_{cyl}$, est
\begin{equation}
 J_{cyl}(r, \theta), z= \left\vert\begin{array}{ccc}
\cos \theta & \sin \theta & 0\\
-r\sin \theta  & r\cos \theta &0 \\
0&0&
\end{array}\right\vert= r,
\end{equation}
qui est toujours positif. Le volume de $A$ est donc
\[
\int_{\eR^3}\chi_{A}(x,y,z)\, dV=\int_{-\pi/2}^{\pi/2}\int_0^{\sin\theta}\int_{-\sqrt{1-r^2}}^{\sqrt{1-r^2}} r dz\,dr\,d\theta=\frac{2\pi}{8}+\frac{8}{9}.  
\] 
\end{example}

\begin{example}
\textbf{Volume d'un solide de révolution : }Soit $g:[a,b]\to\eR_+$ une fonction continue et positive. On dit que le solide $A$ décrit par
\[
A=\left\{(x,y,z)\in\eR^3\, \vert \, z\in[a,b], \,\sqrt{x^2+y^2}\leq g^2(z) \right\}
\]
est un solide de révolution. Afin de calculer son volume, on peut décrire $A$ en coordonnées cylindriques, 
\[
A=\left\{(r,\theta,z) \in ]0, +\infty[\times [-\pi,\pi[\times \eR\,\vert\, a\leq z\leq b, \, 0<r^2\leq g^2(z) \right\}.
\]
Le jacobien de ce changement de variables est  $J_{cyl}=r$, comme dans l'exemple précédent. Le volume de $A$ est donc
\[
\int_{\eR^3}\chi_{A}(x,y,z)\, dV=\int_a^{b}\int_{-\pi}^{\pi}\int_{0}^{g(z)} r  \,dr\,d\theta\, dz=\int_a^{b} \pi g^2(z) \, dz.
\] 
Cette formule peut être utilisée pour tout solide de révolution. 
\end{example}

\begin{example}
\textbf{Coordonnées sphériques : }On veut calculer le volume du cornet de glace  $A$ 
\[
A=\left\{(x,y,z)\in\eR^3\, \vert \, (x,y)\in \mathbb{S}^2, \,\sqrt{x^2+y^2}\leq z\leq \sqrt{1-x^2-y^2} \right\}. 
\]
On peut décrire $A$ en coordonnées sphériques. 
\[
A=\{(\rho,\theta,\phi) \in ]0, +\infty[\times [-\pi,\pi[\times [0,\pi[\,\vert\, 0<\phi\leq\pi/4, \, 0<\rho\leq 1 \}.
\]
Le jacobien de ce changement de variables  $J_{sph}$ est
\begin{equation}
 J_{sph}(\rho, \theta, \phi)= \left\vert\begin{array}{ccc}
\cos \theta \sin\phi & \sin \theta\sin\phi & \cos\phi\\
-\rho\sin \theta\sin\phi  & \rho\cos \theta\sin\phi & 0 \\
\rho\cos\theta\cos\phi&\rho\sin\theta\cos\phi& -\rho\sin\phi
\end{array}\right\vert= \rho^2\sin\phi,
\end{equation}
Le volume de $A$ est donc
\[
\int_{\eR^3}\chi_{A}(x,y,z)\, dV=\int_{-\pi}^{\pi}\int_0^{\pi/4}\int_{0}^{1}\rho^2\sin\phi \,d\rho\,d\phi\,d\theta=\frac{2\pi}{3}\left(1-\frac{1}{\sqrt{2}}\right).  
\] 
\end{example}

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Changement de variables}
%---------------------------------------------------------------------------------------------------------------------------

Le domaine $E=\{ (x,y)\in\eR^2\tq x^2+y^2<1 \}$ s'écrit plus facilement $E=\{ (r,\theta)\tq r<1 \}$ en coordonnées polaires. Le passage aux coordonnées polaire permet de transformer une intégration sur un domaine rond à une intégration sur le domaine rectangulaire $\mathopen]0,2\pi\mathclose[\times\mathopen]0,1\mathclose[$. La question est évidement de savoir si nous pouvons écrire
\begin{equation}
	\int_Ef=\int_{0}^{2\pi}\int_0^1f(r\cos\theta,r\sin\theta)drd\theta.
\end{equation}
Hélas, non; la vie n'est pas aussi simple.

\begin{theorem}
Soit $g\colon A\to B$ un difféomorphisme. Soient $F\subset B$ un ensemble mesurable et borné et $f\colon F\to \eR$ une fonction bornée et intégrable. Supposons que $g^{-1}(F)$ soit borné et que $Jg$ soit borné sur $g^{-1}(F)$. Alors
\begin{equation}
	\int_Ff(x)dy=\int_{g^{-1}(F)f\big( g(x) \big)}| Jg(x) |dx
\end{equation}
\end{theorem}
Pour rappel, $Jg$ est le déterminant de la matrice \href{http://fr.wikipedia.org/wiki/Matrice_jacobienne}{jacobienne} (aucun lien de \href{http://fr.wikipedia.org/wiki/Jacob}{parenté}) donnée par
\begin{equation}
	Jg=\det\begin{pmatrix}
	\partial_xg_1	&	\partial_yg_1	\\ 
	\partial_xg_2	&	\partial_tg_2	
\end{pmatrix}.
\end{equation}
Un \defe{difféomorphisme}{difféomorphisme} est une application $g\colon A\to B$ telle que $g$ et $g^{-1}\colon B\to A$ soient de classe $C^1$.

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
					\subsubsection{Coordonnées polaires}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Les coordonnées polaires sont données par le difféomorphisme
\begin{equation}
	\begin{aligned}
		g\colon \mathopen]0,\infty\mathclose[\times\mathopen]0,2\pi\mathclose[ &\to\eR^2\setminus D\\
		(r,\theta)&\mapsto \big( r\cos(\theta),r\sin(\theta) \big)
	\end{aligned}
\end{equation}
où $D$ est la demi droite $y=0$, $x\geq 0$. Le fait que les coordonnées polaires ne soient pas un difféomorphisme sur tout $\eR^2$ n'est pas un problème pour l'intégration parce que le manque de difféomorphisme est de mesure nulle dans $\eR^2$. Le jacobien est donné par
\begin{equation}
	Jg=\det\begin{pmatrix}
	\partial_rx	&	\partial_{\theta}x	\\ 
	\partial_ry	&	\partial_{\theta}y
\end{pmatrix}=\det\begin{pmatrix}
	\cos(\theta)	&	-r\sin(\theta)	\\ 
	\sin(\theta)	&	r\cos(\theta)	
\end{pmatrix}=r.
\end{equation}

\begin{example}    
    Montrons comment intégrer la fonction $f(x,y)=\sqrt{1-x^2-y^2}$ sur le domaine délimité par la droite $y=x$ et le cercle $x^2+y^2=y$, représenté sur la figure \ref{LabelFigQXyVaKD}. Pour trouver le centre et le rayon du cercle $x^2+y^2=y$, nous commençons par écrire $x^2+y^2-y=0$, et ensuite nous reformons le carré : $y^2-y=(y-\frac{ 1 }{2})^2-\frac{1}{ 4 }$.
    \newcommand{\CaptionFigQXyVaKD}{Passage en polaire pour intégrer sur un morceau de cercle.}
\input{auto/pictures_tex/Fig_QXyVaKD.pstricks}

    Le passage en polaire transforme les équations du bord du domaine en
    \begin{equation}
        \begin{aligned}[]
            \cos(\theta)&=\sin(\theta)\\
            r^2&=r\sin(\theta).
        \end{aligned}
    \end{equation}
    L'angle $\theta$ parcours donc $\mathopen] 0 , \pi/4 \mathclose[$, et le rayon, pour chacun de ces $\theta$ parcours $\mathopen] 0 , \sin(\theta) \mathclose[$. La fonction à intégrer se note maintenant $f(r,\theta)=\sqrt{1-r^2}$. Donc l'intégrale à calculer est
    \begin{equation}		\label{PgRapIntMultFubiniBoutCercle}
        \int_{0}^{\pi/4}\left( \int_0^{\sin(\theta)}\sqrt{1-r^2}r\,rd \right).
    \end{equation}
    Remarquez la présence d'un $r$ supplémentaire pour le jacobien.

    Notez que les coordonnées du point $P$ sont $(1,1)$.
\end{example}

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées sphériques}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Les coordonnées sphériques sont données par
\begin{equation}		\label{EqChmVarSpherique}
	\left\{
\begin{array}{lllll}
x=r\cos\theta\sin\varphi	&			&r\in\mathopen] 0 , \infty \mathclose[\\
y=r\sin\theta\sin\varphi	&	\text{avec}	&\theta\in\mathopen] 0 , 2\pi \mathclose[\\
z=r\cos\varphi			&			&\phi\in\mathopen] 0 , \pi \mathclose[.
\end{array}
\right.
\end{equation}
Le jacobien associé est $Jg(r,\theta,\varphi)=-r^2\sin\varphi$. Rappelons que ce qui rentre dans l'intégrale est la valeur absolue du jacobien.

Si nous voulons calculer le volume de la sphère de rayon $R$, nous écrivons donc
\begin{equation}
	\int_0^Rdr\int_{0}^{2\pi}d\theta\int_0^{\pi}r^2 \sin(\phi)d\phi=4\pi R=\frac{ 4 }{ 3 }\pi R^3.
\end{equation}
Ici, la valeur absolue n'est pas importante parce que lorsque $\phi\in\mathopen] 0,\pi ,  \mathclose[$, le sinus de $\phi$ est positif.

Des petits malins pourraient remarquer que le changement de variable \eqref{EqChmVarSpherique} est encore une paramétrisation de $\eR^3$ si on intervertit le domaine des angles : 
\begin{equation}
	\begin{aligned}[]
		\theta&\colon 0 \to \pi\\
		\phi	&\colon 0\to 2\pi,
	\end{aligned}
\end{equation}
alors nous paramétrons encore parfaitement bien la sphère, mais hélas
\begin{equation}		\label{EqVolumeIncorrectSphere}
	\int_0^Rdr\int_{0}^{\pi}d\theta\int_0^{2\pi}r^2 \sin(\phi)d\phi=0.
\end{equation}
Pourquoi ces «nouvelles» coordonnées sphériques sont-elles mauvaises ? Il y a que quand l'angle $\phi$ parcours $\mathopen] 0 , 2\pi \mathclose[$, son sinus n'est plus toujours positif, donc la \emph{valeur absolue} du jacobien n'est plus $r^2\sin(\phi)$, mais $r^2\sin(\phi)$ pour les $\phi$ entre $0$ et $\pi$, puis $-r^2\sin(\phi)$ pour $\phi$ entre $\pi$ et $2\pi$. Donc l'intégrale \eqref{EqVolumeIncorrectSphere} n'est pas correcte. Il faut la remplacer par
\begin{equation}
	\int_0^Rdr\int_{0}^{\pi}d\theta\int_0^{\pi}r^2 \sin(\phi)d\phi- \int_0^Rdr\int_{0}^{\pi}d\theta\int_{\pi}^{2\pi}r^2 \sin(\phi)d\phi = \frac{ 4 }{ 3 }\pi R^3
\end{equation}

\subsection{Coordonnées polaires}
Soit $T$ la fonction de $]0, +\infty[\times \eR$ dans $\eR^2\setminus\{(0,0)\}$ définie par
\begin{equation}
  \begin{array}{lccc}
    T: &]0, +\infty[\times \eR & \to & \eR^2\setminus\{(0,0)\}\\
 & (r, \theta)&\mapsto& (r\cos \theta, r \sin \theta),
  \end{array}
\end{equation}
Cette fonction est surjective. Elle est bijective sur chaque bande de la forme  $]0, +\infty[\times [a-\pi,a+\pi[$. Si $a=0$ l'inverse de $T$  est la fonction $T^{-1}(x,y)= (\sqrt{x^2+y^2}, \arctg (y/x))$. Soit $P=(x,y)$ un élément dans $\eR^2$, on dit que $r=\sqrt{x^2+y^2}$ est le rayon de $P$ et que $\theta=\arctg (y/x) $ est son argument principal. L'origine ne peut pas être décrite en coordonnées polaires parce que si son rayon est manifestement zéro, on ne peut pas lui associer une valeur univoque de l'angle $\theta$. 

\begin{example}
L'équation du cercle de rayon $a$ et centre $(0, 0)$ en coordonnées polaires est $r=a$. 
\end{example}

\begin{example}
	Une équation possible pour la demi-droite $x=y$, $x>0$,  est $\theta=\pi/4$.         
\end{example}

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++   
\subsection{Coordonnées cylindriques}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Soit $T$ la fonction de $]0, +\infty[\times \eR^2$ dans $\eR^3\setminus\{(0,0,0)\}$ définie par
\begin{equation}
  \begin{array}{lccc}
    T: &]0, +\infty[\times \eR\times \eR & \to & \eR^3\setminus\{(0,0,0)\}\\
 & (r, \theta, z)&\mapsto& (r\cos \theta, r \sin \theta, z),
  \end{array}
\end{equation}
Cette fonction est surjective. Elle est bijective sur chaque bande de la forme  $]0, +\infty[\times [a-\pi,a+\pi[\times \eR$, $a$ dans $\eR$. Il n'y a presque rien de nouveau par rapport aux coordonnées polaires. Les coordonnées  cylindriques sont intéressantes si on décrit un objet invariant par rapport aux rotations autour de l'axe des $z$. 

\begin{example}
Il faut savoir ce que décrivent les équations les plus simples en coordonnées cylindriques, 
\begin{itemize}
\item $r\leq a$, pour $a$ constant dans  $]0, +\infty[$, est le cylindre de hauteur infinie qui a pour axe l'axe des $z$ et pour base le disque de rayon $a$ centré à l'origine, 
\item $r= a$ est  la surface du cylindre,
\item $\theta = b$ est un demi-plan ouvert et sa fermeture contient l'axe des $z$,
\item $z=c$ est un plan parallèle au plan $x$-$y$. 
\end{itemize}
\end{example}

\begin{example}
  Un demi-cône qui a  son sommet en l'origine et  pour axe l'axe des $z$ est décrit par $z=d r$.  Si $d$ est positif  il s'agit  de la moitié supérieure du cône, si $d<0$ de la moitié inférieure.
\end{example}

\begin{example}
 De même,  la sphère de rayon $a$ et centrée à l'origine est l'assemblage des calottes $z=\sqrt{a^2-r^2}$ et $z=-\sqrt{a^2-r^2}$. 
\end{example}

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++   
\subsection{Coordonnées sphériques}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit $T$ la fonction de $]0, +\infty[\times \eR^2$ dans $\eR^3\setminus\{(0,0,0)\}$ définie par
\begin{equation}
  \begin{array}{lccc}
    T: &]0, +\infty[\times \eR\times \eR & \to & \eR^3\setminus\{(0,0,0)\}\\
 & (\rho, \theta, \phi)&\mapsto& (\rho\cos \theta\sin \phi, \rho \sin \theta\sin \phi, \rho\cos \phi),
  \end{array}
\end{equation}
Cette fonction est surjective. Elle est bijective sur chaque bande de la forme  $]0, +\infty[\times [a-\pi,a+\pi[\times [b-\pi/2, b+\pi/2[$, $a$ et $b$ dans $\eR$.  Si $a =0$ et $b=-\pi/2$ la fonction inverse $T^{-1}$ est donnée donnée
\begin{equation}
  \begin{array}{lccc}
    T: &\eR^3\setminus\{(0,0,0)\} & \to & ]0, +\infty[\times [-\pi,\pi[\times [0, \pi[\\
 & (x,y,z)&\mapsto& \left(\sqrt{x^2+y^2+z^2}, \arctg \frac{y}{x}, \arccos \left(\frac{z}{\sqrt{x^2+y^2+z^2}}\right)\right). 
  \end{array}
\end{equation}
Soit $ P$ un point dans $\eR^3$. L'angle $\phi$ est l'angle entre le demi-axe positif des $z$ et le vecteur $\overrightarrow{OP}$, $\rho$ est la norme de $\overrightarrow{OP}$ et $\theta$ est l'argument en coordonnées polaires de la projection de $\overrightarrow{OP}$ sur le plan $x$-$y$.  

\begin{remark}
	Dans la littérature, les angles $\theta$ et $\phi$ sont parfois inversés (voire, changent de nom, par exemple $\varphi$ au lieu de $\phi$). Il faut donc être très prudent lorsqu'on veut utiliser dans un cours des formules données dans un autre cours.
\end{remark}

\begin{example}
Il faut connaître le sens des équations plus simples, 
\begin{itemize}
\item $\rho\leq a$, pour $a$ constant dans  $]0, +\infty[$, est la boule fermée de rayon $a$ centrée à l'origine, 
\item $\rho= a$ est  la sphère de rayon $a$ centrée à l'origine,
\item $\theta = b$ est un demi-plan ouvert et sa fermeture contient l'axe des $z$,
\item $\phi= c$ est un demi-cône qui a  son sommet à l'origine et  pour axe l'axe des $z$.  Si $c$ est positif  il s'agit  de la moitié supérieure du cône, si $d<0$ de la moitié inférieure. 
\end{itemize}
 \end{example}

%--------------------------------------------------------------------------------------------------------------------------- 
 \subsection{Coordonnées cylindriques et sphériques}
%---------------------------------------------------------------------------------------------------------------------------

Les \defe{coordonnées cylindriques}{coordonnées!cylindrique} sont un perfectionnement des coordonnées polaires. Il s'agit simplement de donner le point $(x,y,z)$ en faisant la conversion $(x,y)\mapsto(r,\theta)$ et en gardant le $z$. Les formules de passage sont
\begin{subequations}
	\begin{numcases}{}
		x=r\cos(\theta)\\
		y=r\sin(\theta)\\
		z=z.
	\end{numcases}
\end{subequations}

Les \defe{coordonnées sphériques}{coordonnées!sphériques} sont ce qu'on appelle les «méridiens» et «longitudes» en géographie. Les formules de transformation sont 
\begin{subequations}		%\label{SubEqsCoordSphe}
	\begin{numcases}{}
		x=\rho\sin(\theta)\cos(\varphi)\\
		y=\rho\sin(\theta)\sin(\varphi)\\
		z=\rho\cos(\theta)
	\end{numcases}
\end{subequations}
avec $0\leq\theta\leq\pi$ et $0\leq\varphi<2\pi$.

\begin{remark}
	Attention : d'un livre à l'autre les conventions sur les noms des angles changent. N'essayez donc pas d'étudier par cœur des formules concernant les coordonnées sphériques trouvées autre part. Par exemple sur le premier dessin de \href{http://fr.wikipedia.org/wiki/Coordonnées_sphériques}{wikipédia}, l'angle $\varphi$ est noté $\theta$ et l'angle $\theta$ est noté $\Phi$. Mais vous noterez que sur cette même page, les convention de noms de ces angles changent plusieurs fois.
\end{remark}

Trouvons le changement inverse, c'est à dire trouvons $\rho$, $\theta$ et $\varphi$ en termes de $x$, $y$ et $z$. D'abord nous avons
\begin{equation}
	\rho=\sqrt{x^2+y^2+z^2}.
\end{equation}
Ensuite nous savons que
\begin{equation}
	\cos(\theta)=\frac{ z }{ \rho }
\end{equation}
détermine de façon unique\footnote{Le problème $\rho=0$ ne se pose pas; pourquoi ?} un angle $\theta\in\mathopen[ 0 , \pi \mathclose]$. Dès que $\rho$ et $\theta$ sont connus, nous pouvons poser $r=\rho\sin\theta$ et alors nous nous trouvons avec les équations
\begin{subequations}
	\begin{numcases}{}
		x=r\cos(\varphi)\\
		y=r\sin(\varphi),
	\end{numcases}
\end{subequations}
qui sont similaires à celles déjà étudiées dans le cas des coordonnées polaires.

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Récapitulatif des changements de variables}
%---------------------------------------------------------------------------------------------------------------------------

En pratique, nous retiendrons les formules suivantes:
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées polaires}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

\begin{subequations}
    \begin{numcases}{}
        x=r\cos\theta\\
        y=r\sin\theta
    \end{numcases}
\end{subequations}
avec \( r\in\mathopen] 0 , \infty \mathclose[\) et \( \theta\in\mathopen[ 0 , 2\pi [\). Le jacobien vaut \( r\).

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées cylindriques}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

\begin{subequations}
    \begin{numcases}{}
        x=r\cos\theta\\
        y=r\sin\theta\\
        z=z
    \end{numcases}
\end{subequations}
avec \( r\in\mathopen] 0 , \infty \mathclose[\), \( \theta\in\mathopen[ 0 , 2\pi [\) et \( z\in\eR\). Le jacobien vaut \( r\).

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées sphériques}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

\begin{subequations}
    \begin{numcases}{}
        x=\rho\cos\theta\sin\phi\\
        y=\rho\sin\theta\sin\phi\\
        z=\rho\cos\phi
    \end{numcases}
\end{subequations}
avec \( \rho\in\mathopen] 0 , \infty \mathclose[\), \( \theta\in\mathopen[ 0 , 2\pi [\) et \( \phi\in\mathopen[ 0 , \pi [\). Le jacobien vaut \( -\rho^2\sin(\phi)\). 

N'oubliez pas que lorsqu'on effectue un changement de variables dans une intégrale, la \emph{valeur absolue} du jacobien apparaît.

Cependant notre convention de coordonnées sphériques fait venir \( \sin(\phi)\) avec \( \phi\in\mathopen[ 0 , \pi [\); vu que le signe de \( \sin(\phi)\) y est toujours positif, cette histoire de valeur absolue est sans grandes conséquent. Ce n'est pas le cas de toutes les conventions possibles.
