% This is part of (everything) I know in mathematics
% Copyright (c) 2011-2017
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

\begin{proposition}[\cite{ooIEJXooIYpBbd}]      \label{PROPooWZFGooMVLtFz}
    Soient des fonction \( f,g\colon I\to \eR\) de classe \(  C^{1}\) sur l'ouvert \( I\) de \( \eR\) telles que \( f^2+g^2=1\). Soit \( t_0\in I\) et \( \theta_0\) tel que \( f(t_0)=\cos(\theta_0)\) et \( g(t_0)=\sin(\theta_0)\).

    Alors il existe une unique fonction continue \( \theta\colon I\to \eR\) telle que 
    \begin{subequations}
        \begin{numcases}{}
            \theta(t_0)=\theta_0\\
            f=\cos\circ \theta\\
            g=\sin\circ \theta.
        \end{numcases}
    \end{subequations}
\end{proposition}

\begin{proof}
    Nous commençons par l'existence, en passant par les nombres complexes. Soit \( h\colon I\to \eC\) définie par \( h=f+ig\). Nous avons \( h\bar h=1\) et nous définissons
    \begin{equation}
        \theta(t)=\theta_0-i\int_{t_0}^th'(s)\overline{ h(s) }ds.
    \end{equation}
    Cette intégrale existe pour tout \( t\) parce que les fonctions \( f\) et \( g\) étant de classe \(  C^{\infty}\), elles sont bornées sur le compact \( \mathopen[ t_0 , t  \mathclose]\). De plus \( \theta\) est une fonction continue parce que c'est une primitive (proposition \ref{PropEZFRsMj})\footnote{En réalité nous appliquons la proposition \ref{PropEQRooQXazLz} à chacune des parties réelles et imaginaires de la fonction \( s\mapsto h'(s)\overline{ h(s) }\).}.

    La dérivée de \( \theta\) est la fonction \( s\mapsto -i h'(s)\overline{ h(s) }\).

    Utilisant la formule du lemme \ref{LEMooHOYZooKQTsXW} sur la forme trigonométrique des nombres complexes, nous calculons :
    \begin{equation}
        \Dsdd{ h e^{-i\theta} }{t}{0}= e^{-i\theta}(h'-h\theta')= e^{-i\theta}(h'-ih(-i)h'\bar h)=0.
    \end{equation}
    Par conséquent il existe \( c\in \eC\) tel que \( h e^{-i\theta}=c\). Mais \( h(t_0)=f(t_0)+ig(t_0)=\cos(\theta_0)+i\sin(\theta_0)= e^{i\theta_0}\), du coup
    \begin{equation}
        h(t_0) e^{-i\theta(t_0)}=c
    \end{equation}
    donne immédiatement \( c=1\), ou encore \(  e^{i\theta(t)}=h(t)\), c'est à dire que
    \begin{equation}
        f+ig=\cos\circ\theta+i\sin\circ\theta,
    \end{equation}
    ce qu'il fallait pour l'existence.

    Pour l'unicité nous supposons avoir une autre fonction, \(\alpha\) qui satisfait aux exigences. Pour tout \( t\in I\) nous avons
    \begin{equation}
        e^{i\theta(t)}= e^{i\alpha(t)}.
    \end{equation}
    Il existe donc une fonction \( n\colon I\to \eN\) telle que \( \theta(t)=\alpha(t)+2n(t)\pi\). Par continuité de \( \theta\) et \( \alpha\), la fonction \( n\) doit être constante, mais vu que \( \theta(t_0)=\alpha(t_0)\) nous avons \( n=1\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Très modeste approximation de \( \pi\)}
%---------------------------------------------------------------------------------------------------------------------------
\label{SUBSECooPQVKooAOyxOe}

Nous sommes en droit de vouloir une valeur approchée de \( \pi\). 
\begin{lemma}       \label{LEMooJWSGooExmtDA}
    Nous avons l'approximation numérique
    \begin{equation}
        2\sqrt{ 2 }<\pi<4.
    \end{equation}
\end{lemma}

\begin{proof}
    Grace au lemme \ref{LEMooIGNPooPEctJy} nous savons que la fonction \( \sin\) passe de \( 0\) à \( \sqrt{ 2 }/2\) sur un intervalle de taille \( \pi/4\) avec une dérivé majorée par \( 1\). Par conséquent
    \begin{equation}
        \frac{ \pi }{ 4 }>\frac{ \sqrt{ 2 } }{2}
    \end{equation}
    et donc\footnote{Sérieusement, êtes vous capables de trouver une approximation de \( \sqrt{ 2 }\) en ne vous basant que sur des choses vues jusqu'ici ?}
    \begin{equation}
        \pi>2\sqrt{ 2 }\simeq 2.82
    \end{equation}
    De plus la fonction \( \sin\) passe de \( 0\) à \( \sqrt{ 2 }/2\) sur un intervalle de taille \( \pi/4\) avec une dérivée majorée par \( \sqrt{ 2 }/2\), donc
    \begin{equation}
        \frac{ \pi }{ 4 }<\frac{ \sqrt{ 2 }/2 }{ \sqrt{ 2 }/2 },
    \end{equation}
    ce qui donne
    \begin{equation}
        \pi<4.
    \end{equation}
\end{proof}

Pour avoir une meilleur approximation de \( \pi\), nous pouvons remarquer que \( \pi\in\mathopen] 2.82 , 4 \mathclose[\), et que cet intervalle est suffisamment petit pour ne pas recouvrir l'intervalle correspondant pour \( 2\pi\). L'équation \( \cos(x)=-1\) possède donc une unique solution dans cet intervalle (et cette solution est \( \pi\)). Nous pouvons donc faire une dichotomie pour trouver la valeur de \( \pi\), pourvu que nous ayons une façon d'évaluer des valeurs de \( \cos(x)\) de façon pas trop ridicule.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Cercle trigonométrique}
%---------------------------------------------------------------------------------------------------------------------------

Le \href{http://fr.wikiversity.org/wiki/Trigonométrie/Cosinus_et_sinus_dans_le_cercle_trigonométrique}{cercle trigonométrique} est le cercle de rayon $1$ représenté à la figure \ref{LabelFigCercleTrigono}. Sa longueur est $2\pi$.
\newcommand{\CaptionFigCercleTrigono}{Le cercle trigonométrique.}
\input{auto/pictures_tex/Fig_CercleTrigono.pstricks}

Nous verrons plus tard que la longueur de l'arc de cercle intercepté par un angle $\theta$ est égal à $\theta$. Les radians sont donc l'unité d'angle les plus adaptés au calcul de longueurs sur le cercle. 

%TODO : remettre ce lien après le fork
%Voir exercice \ref{exoGeomAnal-0034}.


%---------------------------------------------------------------------------------------------------------------------------
\subsection{Les fonctions tangente et arc tangente}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}
    La fonction \defe{tangente}{tangente} est :
    \begin{equation}
        \tan(x)=\frac{ \sin(x) }{ \cos(x) }
    \end{equation}
    où \( \sin\) et \( \cos\) sont de la définition \ref{PROPooZXPVooBjONka}.
\end{definition}
La fonction tangente n'est pas définie sur les points de la forme \( x=\frac{ \pi }{2}+k\pi\), \( k\in \eZ\). Une interprétation géométrique, qui justifie le nom, est donnée sur la figure \ref{LabelFigTgCercleTrigono}.
\newcommand{\CaptionFigTgCercleTrigono}{Interprétation géométrique de la fonction tangente. La tangente de l'angle $\theta$ est positive (et un peu plus grande que $1$) tandis que celle de la tangente de l'angle $\varphi$ est négative.}
\input{auto/pictures_tex/Fig_TgCercleTrigono.pstricks}

\begin{proposition}
    La fonction
    \begin{equation}
        \begin{aligned}
        \tan\colon \mathopen] -\frac{ \pi }{ 2 } , \frac{ \pi }{2} \mathclose[&\to \eR \\
            x&\mapsto \tan(x) 
        \end{aligned}
    \end{equation}
    est une bijection.
\end{proposition}

\begin{proof}
    Le cosinus ne s'annulant pas sur l'intervalle donné, la fonction est bien définie. Nous avons
    \begin{equation}
        \lim_{x\to \pi/2^-} \tan(x)=+\infty
    \end{equation}
    parce que la limite du sinus est \( 1\) est celle du cosinus est zéro par les valeurs positives. Le même raisonnement donne la limite en \( -\pi/2\) qui vaut \( -\infty\). Le théorème des valeurs intermédiaires\footnote{Théorème \ref{ThoValInter}.} dit que la fonction tangente est alors surjective sur \( \eR\).

    Par ailleurs en utilisant les règles de calcul comme la dérivation du quotient \ref{PROPooOUZOooEcYKxn}\ref{ITEMooMUNQooLiKffz} nous trouvons
    \begin{equation}
        \tan'(x)=\tan^2(x)+1,
    \end{equation}
    ce qui nous donne une dérivée partout strictement positive, et donc une fonction strictement croissante et donc injective.
\end{proof}

Le graphe de la fonction tangente est sur la figure \ref{LabelFigPVJooJDyNAg}. % From file PVJooJDyNAg
\newcommand{\CaptionFigPVJooJDyNAg}{Le graphe de la fonction tangente.}
\input{auto/pictures_tex/Fig_PVJooJDyNAg.pstricks}

En ce qui concerne la bijection réciproque nous avons le théorème suivant.
\begin{theorem}     \label{THOooUSVGooOAnCvC}
    La fonction
    \begin{equation}
        \begin{aligned}
        \arctan\colon \eR&\to \left] -\frac{ \pi }{2} , \frac{ \pi }{2} \right[ \\
            x&\mapsto \arctan(x) 
        \end{aligned}
    \end{equation}
    nommée \defe{arc tangente}{arc tangente} est
    \begin{enumerate}
        \item
            impaire et strictement croissante sur \( \eR\).
        \item       \label{ITEMooMNHLooOVhIIb}
            dérivable sur \( \eR\) de dérivée
            \begin{equation}
                \arctan'(x)=\frac{1}{ 1+x^2 }.
            \end{equation}
    \end{enumerate}
\end{theorem}

\begin{proof}
    La fonction sinus étant impaire (visible sur son développement de définition \eqref{EQooCMRFooCTtpge}), et la fonction cosinus étant paire, la fonction tangente est impaire et sa réciproque l'est tout autant.

    La fonction arc tangente est également dérivable (donc continue) par la proposition \ref{PropMRBooXnnDLq} parce que la fonction tangente l'est. Notons qu'ici nous nous sommes restreint à \( \mathopen] -\pi/2 , \pi/2 \mathclose[\). Sinon, le résultat est faux.

    La formule proposée pour la dérivée provient également de la proposition \ref{PropMRBooXnnDLq} et de la dérivée de la tangente :
\end{proof}

\begin{lemma}       \label{LEMooJKIUooEMMOrs}
    Nous avons la valeur remarquable
    \begin{equation}
        \arctan(1/\sqrt{ 3 })=\frac{ \pi }{ 6 }.
    \end{equation}
\end{lemma}

Le nombre \( \arctan(x_0)\) se calcule en cherchant l'angle \( \theta\in\mathopen[ -\frac{ \pi }{2} , \frac{ \pi }{2} \mathclose]\) dont la tangente vaut \( x_0\). Nous obtenons le tableau de valeurs suivant :
\begin{equation*}
    \begin{array}[]{|c|c|c|c|c|}
        \hline
        x&0&\frac{1}{ \sqrt{3} }&1&\sqrt{3}\\
        \hline
        \arctan(x)&0&\frac{ \pi }{ 6 }&\frac{ \pi }{ 4 }&\frac{ \pi }{ 3 }\\
        \hline
    \end{array}
\end{equation*}

En ce qui concerne la représentation graphique de la fonction \( x\mapsto\arctan(x)\), elle s'obtient «en retournant» la partie entre \( -\frac{ \pi }{2}\) et \( \frac{ \pi }{ 2 }\) du graphique de la fonction tangente :
\begin{center}
   \input{auto/pictures_tex/Fig_UQZooGFLNEq.pstricks}
\end{center}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{La fonction arc sinus}
%---------------------------------------------------------------------------------------------------------------------------

Nous voulons étudier la fonction
\begin{equation}
    \begin{aligned}
        \sin\colon \eR&\to \mathopen[ -1 , 1 \mathclose] \\
        x&\mapsto \sin(x) 
    \end{aligned}
\end{equation}
et sa réciproque éventuelle.

La fonction sinus est continue sur \( \eR\) mais n'est pas bijective : elle prend une infinité de fois chaque valeur de \( J=\mathopen[ -1 , 1 \mathclose]\). Pour définir une bijection réciproque de la fonction sinus en utilisant le théorème \ref{ThoKBRooQKXThd}, nous devons donc choisir un intervalle à partir duquel la fonction sinus est monotone. Nous choisissons l'intervalle
\begin{equation}
    I=\mathopen[ -\frac{ \pi }{ 2 } , \frac{ \pi }{2} \mathclose].
\end{equation}
La fonction
\begin{equation}
    \begin{aligned}
        \sin\colon \mathopen[ -\frac{ \pi }{2} , \frac{ \pi }{2} \mathclose]&\to \mathopen[ -1 , 1 \mathclose] \\
        x&\mapsto \sin(x) 
    \end{aligned}
\end{equation}
est une bijection croissante et continue. Nous avons donc le résultat suivant.
\begin{theorem}[Définition et propriétés de arc sinus]
    Nous nommons \defe{arc sinus}{arc sinus} la bijection inverse de la fonction \( \sin\colon I\to J\). La fonction
    \begin{equation}
        \begin{aligned}
            \arcsin\colon \mathopen[ -1 , 1 \mathclose]&\to \mathopen[ -\frac{ \pi }{2} , \frac{ \pi }{2} \mathclose] \\
            x&\mapsto \arcsin(x) 
        \end{aligned}
    \end{equation}
    ainsi définie est
    \begin{enumerate}
        \item
            continue et strictement croissante;
        \item
            impaire : pour tout \( x\in\mathopen[ -1 , 1 \mathclose]\) nous avons \( \arcsin(-x)=-\arcsin(x)\).
    \end{enumerate}
\end{theorem}

\begin{proof}
    Nous prouvons le fait que \( \arcsin\) est impaire. Un élément de l'ensemble de définition de \( \arcsin\) est de la forme \( y=\sin(x)\) avec \( x\in\mathopen[ -\pi/2 , \pi/2 \mathclose]\). La relation \eqref{EqHQRooNmLYbF} s'écrit dans notre cas
    \begin{equation}    \label{EqVUWooUwVxVp}
        x=\arcsin\big( \sin(x) \big).
    \end{equation}
    Nous écrivons d'une part cette équation avec \( -x\) au lieu de \( x\) :
    \begin{equation}    \label{EqRLYooIwOvSz}
        -x=\arcsin\big( \sin(-x) \big)=\arcsin\big( -\sin(x) \big)=\arcsin(-y);
    \end{equation}
    et d'autre part nous multiplions \eqref{EqVUWooUwVxVp} par \( -1\) :
    \begin{equation}    \label{EqTGIooDeRYyT}
        -x=-\arcsin\big( \sin(x) \big)=-\arcsin(y).
    \end{equation}
    En égalisant les valeurs \eqref{EqRLYooIwOvSz} et \eqref{EqTGIooDeRYyT} nous trouvons
    \begin{equation}
        \arcsin(-y)=-\arcsin(y),
    \end{equation}
    ce qui signifie que \( \arcsin\) est une fonction impaire.
\end{proof}
Notons que cette preuve repose sur le fait que tout élément de l'ensemble de définition de la fonction arc sinus peut être écrit sous la forme \( \sin(x)\) pour un certain \( x\).

Si \( x_0\in\mathopen[ -1 , 1 \mathclose]\) est donné, calculer \( \arcsin(x_0)\) revient à trouver un angle \( \theta_0\) dans \( \mathopen[ -\frac{ \pi }{2} , \frac{ \pi }{2} \mathclose]\) pour lequel \( \sin(\theta_0)=x_0\). Un tel angle sera forcément unique.

\begin{remark}
  La définition de arc sinus découle du choix de l'intervalle $I$, qui est une convention. Il aurait été possible de faire un choix différent : pourriez vous trouver la réciproque de la fonction sinus sur l'intervalle $[\pi/2, 3\pi/2]$ ? Le mieux est de l'écrire comme une translatée de arc sinus, en utilisant le fait que sinus est une fonction périodique. 
\end{remark}

\begin{example}
    Pour calculer \( \arcsin(1)\), il faut chercher un angle entre \( -\frac{ \pi }{2}\) et \( \frac{ \pi }{ 2 }\) ayant \( 1\) pour sinus : résoudre \( \sin(\theta)=1\). La solution est \( \theta=\frac{ \pi }{2}\) et nous avons donc \( \arcsin(1)=\frac{ \pi }{2}\).
\end{example}

À l'aide des valeurs remarquables de la fonction sinus nous obtenons le tableau suivant de valeurs remarquables pour l'arc sinus.
\begin{equation*}
    \begin{array}[]{|c|c|c|c|c|c|}
        \hline
        x&0&\frac{ 1 }{2}&\frac{ \sqrt{2} }{2}&\frac{ \sqrt{3} }{2}&1\\
          \hline
          \arcsin(x)&0&\frac{ \pi }{ 6 }&\frac{ \pi }{ 4 }&\frac{ \pi }{ 3 }&\frac{ \pi }{ 2 }\\ 
          \hline 
           \end{array}
\end{equation*}
Les autres valeurs remarquables peuvent être déduites du fait que l'arc sinus est une fonction impaire.

En ce qui concerne la dérivabilité de la fonction arc sinus, en application de la proposition \ref{PropMRBooXnnDLq} elle est dérivable en tout \( y=\sin(x)\) tel que \( \sin'(x)\neq 0\), c'est à dire tel que \( \cos(x)\neq 0\). Or \( \cos(x)=0\) pour \( x=\pm\frac{ \pi }{2}\), ce qui correspond à \( y=\sin(\pm\frac{ \pi }{2})=\pm 1\). La fonction arc sinus est donc dérivable sur \( \mathopen] -1 , 1 \mathclose[\). Nous avons donc la propriété suivante pour la dérivabilité.

\begin{proposition}
    La fonction arc sinus est continue sur \( \mathopen[ -1 , 1 \mathclose]\) et dérivable sur \( \mathopen] -1 , 1 \mathclose[\). Pour tout \( y\in\mathopen] -1 , 1 \mathclose[\), la dérivée est donnée par la formule \eqref{EqWWAooBRFNsv}, qui dans ce cas s'écrit
        \begin{equation}
            \arcsin'(y)=\frac{1}{ \cos\big( \arcsin(y) \big) }=\frac{1}{ \sqrt{1-y^2} }.
        \end{equation}
\end{proposition}
La dernière égalité viens du fait que si $x=\arcsin(y)$ alors $y = \sin(x)$ et $\cos(x)= \sqrt{1-\sin^2(x)} = \sqrt{1-y^2}$. 

Pour comprendre la dernière égalité, remarquer que dans le dessin suivant, \( \theta=\arcsin(y)\), donc $y = \sin(\theta)$, et \( x=\cos(\theta)\).
\begin{center}
    \input{auto/pictures_tex/Fig_BIFooDsvVHb.pstricks}
\end{center}

Notons enfin que le graphe de la fonction arc sinus est donné à la figure \ref{LabelFigFGRooDhFkch}. % From file FGRooDhFkch
\newcommand{\CaptionFigFGRooDhFkch}{Le graphe de la fonction \( x\mapsto \arcsin(x)\)}
\input{auto/pictures_tex/Fig_FGRooDhFkch.pstricks}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{La fonction arc cosinus}
%---------------------------------------------------------------------------------------------------------------------------

Nous voulons étudier la fonction
\begin{equation}
        \cos\colon \eR\to \mathopen[ -1 , 1 \mathclose] 
\end{equation}
et son éventuelle réciproque. Encore une fois il n'est pas possible d'en prendre la réciproque globale parce que ce n'est pas une bijection; ne fut-ce que parce qu'elle est périodique (proposition \ref{PROPooFRVCooKSgYUM}). Nous choisissons de considérer l'intervalle \( \mathopen[ 0 , \pi \mathclose]\) sur lequel la fonction cosinus est continue et strictement monotone décroissante.

Nous avons alors le résultat suivant :

\begin{propositionDef}     \label{PROPooZOZHooSMoYQD}
    Pour définir la fonction arcsinus.  
    
    \begin{enumerate}
        \item
    La fonction
    \begin{equation}
            \cos\colon \mathopen[ 0 , \pi \mathclose]\to \mathopen[ -1 , 1 \mathclose] 
    \end{equation}
    est une bijection continue strictement décroissante. 
    \item
    Sa bijection réciproque est la fonction 
    \begin{equation}
            \arccos\colon \mathopen[ -1 , 1 \mathclose]\to \mathopen[ 0 , \pi \mathclose] \\
    \end{equation}
    nommée \defe{arc cosinus}{arc cosinus}.
    \item
        La fonction arc cosinus est continue, strictement décroissante.
    \item
        Elle est dérivable et pour tout \( y\in\mathopen] -1 , 1 \mathclose[\), sa dérivée est donnée par
    \begin{equation}
        \arccos'(y)=\frac{1}{ -\sin\big( \arccos(y) \big) }=\frac{ -1 }{ \sqrt{1-y^2} }.
    \end{equation}
    \end{enumerate}
\end{propositionDef}

\begin{proof}
    La fonction cosinus est continue et même de classe \(  C^{\infty}\) par la proposition \ref{PROPooZXPVooBjONka}. Elle est strictement décroissant parce que sa dérivée (\( -\sin\)) y est strictement positive (strictement à dans l'intérieur du domaine).

    Le fait que arc cosinus soit une bijection continue strictement monotone est dans le théorème de la bijection \ref{ThoKBRooQKXThd}. La dérivabilité et la formule sont de la proposition \ref{PropMRBooXnnDLq}.
\end{proof}

Pour \( y_0\in\mathopen[ -1 , 1 \mathclose]\), trouver la valeur de \( \arccos(y_0)\) revient à résoudre l'équation \( \cos(x_0)=y_0\). Cela nous permet de construire une tableau de valeurs :
\begin{equation*}
    \begin{array}[]{|c|c|c|c|c|c|c|c|c|c|}
        \hline
        x&-1&-\frac{ \sqrt{3} }{2}&-\frac{ \sqrt{2} }{2}&-\frac{ 1 }{2}&0&\frac{ 1 }{2}&\frac{ \sqrt{2} }{2}&\frac{ \sqrt{3} }{2}&1\\
          \hline
          \arccos(x)&\pi&\frac{ 5\pi }{ 6 }&\frac{ 3 }{ 4 }\pi&\frac{ 2 }{ 3 }\pi&\frac{ 1 }{2}\pi&\frac{ \pi }{ 3 }&\frac{1}{ 4 }\pi&\frac{1}{ 6 }\pi&0\\
          \hline 
           \end{array}
\end{equation*}

\begin{remark}
    Certes la fonction cosinus est paire (vue sur \( \eR\)), mais la fonction arc cosinus ne l'est pas car elle est une bijection entre \(\mathopen[ -1 , 1 \mathclose]\) et \(\mathopen[ 0 , \pi \mathclose]\).
\end{remark}

\begin{example}
    Cherchons \( \arccos(\frac{ 1 }{2})\). Il faut trouver un angle \( \theta\in\mathopen[ 0 , \pi \mathclose]\) tel que \( \cos(\theta)=\frac{ 1 }{2}\). La solution est \( \theta=\frac{ \pi }{ 3 }\). Donc \( \arccos(\frac{ 1 }{2})=\frac{ \pi }{ 3 }\).

    Il n'est cependant pas immédiat d'en déduire la valeur de \( \arccos(-\frac{ 1 }{2})\). En effet \( \theta=\arccos(-\frac{ 1 }{2})\) si et seulement si \( \cos(\theta)=-\frac{ 1 }{2}\) avec \( \theta\in\mathopen[ 0 , \pi \mathclose]\). La solution est \( \theta=\frac{ 2\pi }{ 3 }\).
\end{example}

En ce qui concerne la représentation graphique, il suffit de tracer la fonction cosinus entre \( 0\) et \( \pi\) puis de prendre le symétrique par rapport à la droite \( y=x\).

\begin{center}
    \input{auto/pictures_tex/Fig_GMIooJvcCXg.pstricks}
\end{center}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Une meilleure approximation de \( \pi\)}
%---------------------------------------------------------------------------------------------------------------------------

Nous avions laissé le nombre \( \pi\) avec l'approximation assez minable de \( 2\sqrt{ 2 }<\pi<4\) en le lemme \ref{LEMooJWSGooExmtDA}. Nous pouvons maintenant faire nettement mieux.

Le lemme \ref{LEMooJKIUooEMMOrs} donne
\begin{equation}
    \arctan(1/\sqrt{ 3 })=\pi/6
\end{equation}
et l'idée est de donner un développement de \( \arctan\) autour de zéro, de l'évaluer en \( 1/\sqrt{ 3 }\) et d'égaliser le résultat à \( \pi/6\). Tout cela donne lieux à des calcules peut-être fastidieux, mais comme un gars l'a fait dès l'an 1424\cite{ooOMUNooGROVUu} pour trouver \( 16\) décimales corrects, nous faisons comme si c'était facile.

Le développement en série de Taylor \ref{SubEqsDevTauil} d'arc tangente autour de \( x=0\) est donné par
\begin{equation}
    \arctan(x)=\sum_{k=0}^{\infty}\frac{ (-1)^{k}x^{2k+1} }{ 2k+1 },
\end{equation}
valable pour \( x\in \mathopen] -1 , 1 \mathclose[\). Avec cela nous avons
\begin{equation}
    \arctan(\frac{1}{ \sqrt{ 3 } })=\sum_{k=0}^{\infty}\frac{ (-1)^k }{ (2k+1)3^k }\times \frac{1}{ \sqrt{ 3 } }=\frac{ \pi }{ 6 },
\end{equation}
et donc
\begin{equation}
    \pi=\frac{ 6 }{ \sqrt{ 3 } }\sum_{k=0}^{\infty}\frac{ (-1)k }{ (2k+1)3^k }.
\end{equation}

Pour donner une idée du fait que ça fonctionne pas mal, voici le calcul pour quelque termes :
\lstinputlisting{tex/sage/sageSnip012.sage}
Calculer \( 5\) termes donne déjà \( 3.15\). Et on est à \( 10^{-6}\) de la bonne réponse avec \( 20\) termes. Et avec $58$ termes, on n'est à \( 10^{-16}\).

\begin{probleme}
    Pour bien faire, il faudrait étudier le reste et donner un encadrement.
\end{probleme}

%---------------------------------------------------------------------------------------------------------------------------
\subsection[Forme trigonométrique des nombres complexes]{Forme polaire ou trigonométrique des nombres complexes}
%---------------------------------------------------------------------------------------------------------------------------

Un nombre complexe étant représenté par deux nombres, on peut le représenter dans un plan appelé « plan de Gauss ». La plupart des opérations sur les nombres complexes ont leur interprétation géométrique dans ce plan.  

Dans le plan de Gauss, le module d'un complexe $z$ représente la distance entre $0$ et $z$. On appelle \Defn{argument} de $z$ (noté $\arg z$) l'angle (déterminé à $2\pi$ près) entre le demi-axe des réels positifs et la demi-droite qui part de $0$ et passe par $z$. Le module et l'argument d'un complexe permettent de déterminer univoquement ce complexe puisqu'on a la formule
\[z = a + bi = \module z \left( \cos(\arg(z)) + i \sin(\arg(z)) \right)\]

L'argument de $z$ se détermine via les formules 
\[\frac a {\module z} = \cos(\arg(z)) \quad \frac b {\module z} = \sin(\arg(z))\]
ou encore par la formule
\[
\frac b a = \tan(\arg(z)) \quad \text{en vérifiant le quadrant.}
\]
La vérification du quadrant vient de ce que la tangente ne détermine l'angle qu'à $\pi$ près.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Angle entre deux vecteurs}
%---------------------------------------------------------------------------------------------------------------------------

Si $a$ et $b$ sont des réels, l'inégalité $| a |\leq b$ peut se développer en une double inégalité
\begin{equation}
	-b\leq a\leq b.
\end{equation}
L'inégalité de Cauchy-Schwarz \eqref{EQooZDSHooWPcryG} devient alors
\begin{equation}
	-\| X \|\| Y \|\leq X\cdot Y\leq\| X \|\| Y \|.
\end{equation}
Si $X\neq 0$ et $Y\neq 0$, nous avons alors
\begin{equation}
	-1\leq\frac{ X\cdot Y }{ \| X \|\| Y \| }\leq 1.
\end{equation}
Il existe donc par la proposition \ref{PROPooZOZHooSMoYQD} un angle $\theta\in\mathopen[ 0 , \pi \mathclose]$ tel que
\begin{equation}		\label{eqDefAngleVect}
	\cos(\theta)=\frac{ X\cdot Y }{ \| X \|\| Y \| }.
\end{equation}

\begin{definition}      \label{DEFooSVDZooPWHwFQ}
L'angle ainsi défini est l'\defe{angle}{angle!entre vecteurs} entre $X$ et $Y$. La définition \eqref{eqDefAngleVect} est souvent utilisée sous la forme
\begin{equation}		\label{eqPropCosThet}
	X\cdot Y=\| X \|\| Y \|\cos(\theta).
\end{equation}
\index{cosinus!angle entre deux vecteurs}
\end{definition}

Notez que les angles sont toujours des angles plus petits ou égaux à \unit{180}{\degree}.

La longueur de la projection du point $P$ sur la droite horizontale va naturellement être égale à $\cos(\theta)$. En effet, si nous notons $X$ un vecteur horizontal de norme $1$, cette projection est donné par $P\cdot X$. Mais en reprenant l'équation \eqref{eqPropCosThet}, nous voyons que
\begin{equation}
	P\cdot X=\| P \|\| X \|\cos(\theta),
\end{equation}
tandis qu'ici nous avons $\| P \|=\| X \|=1$.

Nous appelons $\sin(\theta)$ la longueur de la projection sur l'axe vertical.

Quelques dessins nous convainquent que 
\begin{equation}
	\begin{aligned}[]
		\sin(\theta+2\pi)&=\sin(\theta)&\cos(\theta+2\pi)&=\sin(\theta),\\
		\sin(\theta+\frac{ \pi }{2})&=\cos(\theta)&\cos(\theta+\frac{ \pi }{2})&=-\sin(\theta),\\
		\sin(\pi-\theta)&=\sin(\theta)&\cos(\pi-\theta)&=-\cos(\theta).
	\end{aligned}
\end{equation}
Le théorème de Pythagore nous montre aussi l'importante relation
\begin{equation}
	\sin^2(\theta)+\cos^2(\theta)=1.
\end{equation}

Quelques valeurs remarquables pour les sinus et cosinus :
\begin{equation}
	\begin{aligned}[]
		\sin 0&=0,&\sin\frac{ \pi }{ 6 }&=\frac{ 1 }{2},&\sin\frac{ \pi }{ 4 }&=\frac{ \sqrt{2} }{2},&\sin\frac{ \pi }{ 3 }&=\frac{ \sqrt{3} }{2},&\sin\frac{ \pi }{2}&=1,&\sin\pi&=0\\
		\cos 0&=1,&\cos\frac{ \pi }{ 6 }&=\frac{ \sqrt{3} }{2},&\cos\frac{ \pi }{ 4 }&=\frac{ \sqrt{2} }{2},&\cos\frac{ \pi }{ 3 }&=\frac{ 1 }{2},&\cos\frac{ \pi }{2}&=0,&\cos\pi&=-1
	\end{aligned}
\end{equation}

Nous pouvons prouver simplement que $\sin(\unit{30}{\degree})=\frac{ 1 }{2}$ et $\cos(\unit{30}{\degree})=\frac{ \sqrt{3} }{2}$ en s'inspirant de la figure \ref{LabelFigGVDJooYzMxLW}. % From file GVDJooYzMxLW
\newcommand{\CaptionFigGVDJooYzMxLW}{Un triangle équilatéral de côté $1$.}
\input{auto/pictures_tex/Fig_GVDJooYzMxLW.pstricks}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Aire du parallélogramme}
%---------------------------------------------------------------------------------------------------------------------------

\begin{remark}      \label{RemaAireParalProdVect}
    Le nombre $\| a \|\| b \|\sin(\theta)$ est l'aire du parallélogramme formé par les vecteurs $a$ et $b$, comme cela se voit sur la figure \ref{LabelFigBNHLooLDxdPA}. % From file BNHLooLDxdPA
\newcommand{\CaptionFigBNHLooLDxdPA}{Calculer l'aire d'un parallélogramme.}
\input{auto/pictures_tex/Fig_BNHLooLDxdPA.pstricks}
\end{remark}

\begin{proposition}     \label{PropNormeProdVectoabsint}
    Nous avons
    \begin{equation}
        \| a\times b \|=\| a \|\| b \|\sin(\theta)
    \end{equation}
    où $\theta\in\mathopen[ 0.\pi \mathclose]$ est l'angle formé par $a$ et $b$.
\end{proposition}

\begin{proof}
    En utilisant la décomposition du produit vectoriel, nous avons
    \begin{equation}
        \begin{aligned}[]
            \| a\times b \|^2&=\begin{vmatrix}
                a_2    &   a_3    \\ 
                b_2    &   b_3    
            \end{vmatrix}^2+\begin{vmatrix}
                a_1    &   a_3    \\ 
                b_1    &   b_3    
            \end{vmatrix}^2+\begin{vmatrix}
                a_1    &   a_2    \\ 
                b_1    &   b_2    
            \end{vmatrix}^2\\
            &=(a_2b_3-b_2a_3)^2+(a_1b_3-a_3b_1)^2+(a_1b_2-a_2b_1)^2\\
            &=(a_1^2+a_2^2+a_3^2)(b_1^2+b_2^2+b_3^2)-(a_1b_1+a_2b_2+a_3b_3)^2\\
            &=\| a \|^2\| b \|^2-(a\cdot b)^2\\
            &=\| a \|^2\| b \|^2-\| a \|^2\| b \|^2\cos^2(\theta)\\
            &=\| a \|^2\| b \|^2\big( 1-\cos^2(\theta) \big)\\
            &=\| a \|^2\| b \|^2\sin^2(\theta).
        \end{aligned}
    \end{equation}
    D'où le résultat. Nous avons utilisé la formule de la définition \eqref{DEFooSVDZooPWHwFQ} donnant l'angle en fonction du produit scalaire.
\end{proof}

\begin{normaltext}      \label{NORMooWWOKooWzScnZ}
Si les vecteurs $a$, $b$ et $c$ ne sont pas coplanaires, alors la valeur absolue du produit mixte (voir équation \eqref{EqProduitMixteDet}) $a\cdot(b\times c)$ donne le volume du parallélépipède construit sur les vecteurs $a$, $b$ et $c$.

En effet si $\varphi$ est l'angle entre $b\times c$ et $a$, alors la hauteur du parallélépipède vaut $\| a \|\cos(\varphi)$ parce que la direction verticale est donnée par $b\times c$, et la hauteur est alors la «composante verticale» de $a$. Par conséquent, étant donné que $\| b\times c \|$ est l'aire de la base, le volume du parallélépipède vaut\footnote{Le calcul de ce volume mériterait une certaine réflexion, surtout à partir du moment où nous avons décidé de définir les fonctions trigonométriques à partir de son développement (définition \ref{PROPooZXPVooBjONka}).}
\begin{equation}
    V=\| b\times c\|  \| a \|\cos(\varphi).
\end{equation}
Or cette formule est le produit scalaire de $a$ par $b \times c$; ce dernier étant donné par le déterminant de la matrice formée des composantes de $a$, $b$ et $c$ grâce à la formule \eqref{EqProduitMixteDet}.
\end{normaltext}

La valeur absolue du déterminant 
\begin{equation}        \label{EqDeratb}
    \begin{vmatrix}
        a_1    &   a_2    \\ 
        b_1    &   b_2    
    \end{vmatrix}
\end{equation}
est l'aire du parallélogramme déterminé par les vecteurs $\begin{pmatrix}
    a_1    \\ 
    a_2    
\end{pmatrix}$ et $\begin{pmatrix}
    b_1    \\ 
    b_2    
\end{pmatrix}$. En effet, d'après la remarque \ref{RemaAireParalProdVect}, l'aire de ce parallélogramme est donnée par la norme du produit vectoriel
\begin{equation}
    \begin{pmatrix}
        a_1    \\ 
        a_2    \\ 
        0    
    \end{pmatrix}\times
    \begin{pmatrix}
          b_1  \\ 
        b_2    \\ 
        0    
    \end{pmatrix}=\begin{vmatrix}
        e_x    &   e_y    &   e_z    \\
        a_1    &   a_2    &   0    \\
        b_1    &   b_2    &   0
    \end{vmatrix}=
    \begin{vmatrix}
        a_1    &   a_2    \\ 
        b_1    &   b_2    
    \end{vmatrix}e_z,
\end{equation}
donc la norme $\| a\times b \|$ est bien donnée par la valeur absolue du déterminant \eqref{EqDeratb}.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Classification des isométries dans \( \eR^2\)}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Réflexions}
%---------------------------------------------------------------------------------------------------------------------------

Soit un espace vectoriel \( E\) de dimension \( 2\) muni d'un produit scalaire\footnote{Définition \ref{DefVJIeTFj}.}. Cela pourrait très bien être \( \eR^2\), mais nous allons nous efforcer de l'appeler \( E\) pour rester un peu général.

\begin{lemmaDef}[Caractérisation des réflexions]        \label{DEFooLJKDooUaamen}
    Soit une droite \( \ell\) de \( \eR^2\). Il existe une unique application \( f\colon \eR^2\to \eR^2\) telle que
    \begin{enumerate}
        \item
            \( f(x)=x\) pour tout \( x\in \ell\).
        \item
            \( f\) échange les côtés de \( \ell\).
        \item
            \( f\) laisse invariants les droites perpendiculaires à \( \ell\) et les cercles dont le centre est sur \( \ell\).
    \end{enumerate}
    Cette application est la \defe{réflexion}{réflexion!dans \( \eR^2\)} d'axe \( \ell\).
\end{lemmaDef}

\begin{proof}
    Soit \( x\) hors de \( \ell\) et \( p\) la droite perpendiculaire à \( \ell\) et passant par \( x\). Nous avons \( f(x)\in p\). En nommant \( P\) l'intersection entre \( \ell\) et \( p\), nous considérons le cercle \( S(P,\| Px \|)\) qui est un cercle dont le centre est sur \( \ell\). Il contient \( x\) et donc \( f(x)\in S(P,\| Px \|)\).

    Donc \( f(x)\in p\cap S(P,\| Px \|)\). L'intersection entre un cercle et une droite contient de façon générique deux point. L'un est \( x\), mais \( f(x)=x\) n'est pas possible parce que \( x\) est hors de \( \ell\) et \( f\) doit inverser les côtés de \( \ell\). Donc \( f(x)\) est l'autre.

    Cela prouve l'unicité. En ce qui concerne l'existence, il suffit de noter que la réflexion \( \sigma_{\ell}\) satisfait les contraintes.
\end{proof}

\begin{lemma}       \label{LEMooZSDRooUkNYer}
    Soit une droite \( \ell\) est \( A\in E\). Alors
    \begin{equation}        \label{EQooVUQDooKuwszl}
        \sigma_{\ell}(A)=2\pr_{\ell}(A)-A
    \end{equation}
    où \( \pr_{\ell}\) est l'opération de projection orthogonale sur la droite \( \ell\).
\end{lemma}

\begin{proof}
    Nous posons \( f(X)=2\pr_{\ell}(X)-X\) et nous allons montrer que \( f=\sigma_{\ell}\) en vérifiant les conditions de la définition \ref{DEFooLJKDooUaamen}. Nous nous gardons bien de faire un raisonnement du type «nous allons montrer que \( f\) et \( \sigma_{\ell}\) coïncident sur deux points, et sont donc égales par le corollaire \ref{CORooZHZZooDgTzsW}» parce que nous ne savons pas encore que \( \sigma_{\ell}\) est une application affine, ni même que c'est une isométrie.

    Si \( X\in\ell\) alors \( \pr_{\ell}(X)=X\) et nous avons \( f(X)=2X-X=X\). Donc \( \ell\) est conservée.

    En ce qui concerne les deux côtés de \( \ell\), il existe une application linéaire \( s\colon E\to \eR\) et une constante \( c\in \eR\) telles qu'en posant \( \ell(X)=s(X)+c\), la droite \( \ell\) soit le lieux des points \( X\) tels que \( \ell(X)=0\). Un côté de la droite est \( \ell<0\) et l'autre côté est \( \ell>0\). Nous avons :
    \begin{subequations}
        \begin{align}
            \ell\big( f(A) \big)&=\ell\big( 2\pr_{\ell}(A)-A \big)\\
            &=s(2\pr_{\ell}(A)-A)+c\\
            &=2s\big( \pr_{\ell}(A) \big)-s(A)+c\\
            &=s\big( \pr_{\ell}(A) \big)-s(A)\\
            &=-c-s(A)\\
            &=-\ell(A)
        \end{align}
    \end{subequations}
    où nous avons utilisé le fait que, \( \pr_{\ell}(A)\) étant sur \( \ell\), \( s\big( \pr_{\ell}(A) \big)+c=0\). Nous avons donc \( \ell\big( f(A) \big)=-\ell(A)\), ce qui indique que \( A\) et \( f(A)\) sont de part et d'autre de \( \ell\).

    Si \( d\) est une droite perpendiculaire à \( \ell\) et si \( A\in d\) alors \( f(A)=2\pr_{\ell}(A)-A=  \big( \pr_{\ell}(A)-A \big)+A\in d  \) parce que \( \pr_{\ell}(A)\in d\) du fait que \( d\) soit précisément perpendiculaire à \( \ell\). Nous avons aussi utilisé le fait que si \( A,B,C\in d\) alors \( (B-A)+C\in d\); pensez que \( B-A\) est un vecteur directeur et que \( C\) est un point de \( d\).

    Enfin soit \( K\in\ell\) et un cercle \( S(K,r)\) centré en \( K\). Soit \( A\in S(K,r)\); nous devons vérifier que \( f(A)=S(K,r)\). Le segment \( [A,f(A)]\) est par définition perpendiculaire à \( \ell\). Soit \( M\), le milieu, qui est sur la droite \( \ell\). Les triangles \( AMK\) et \( f(A)MK\) sont rectangles en \( M\), et \( \| AM \|=\| Mf(A) \|\). Le théorème de Pythagore donne \( \| AK \|=\| f(A)K \|\). Donc le cercle centré en \( K\) est donc préservé par \( f\).

    Nous en déduisons que \( f=\sigma_{\ell}\).
\end{proof}

\begin{proposition}[\cite{ooIIMKooJpdFyk}]      \label{PROPooFSVEooWmJsnv}
    Une réflexion est une isométrie de \( (E,d)\) où \( d(A,B)=\| A-B \|\).
\end{proposition}

\begin{proof}
    Soient \( A,B\in E\); il faut vérifier que \( \| A-B \|=\| \sigma_{\ell}(A)-\sigma_{\ell}(B) \|\). Pour cela nous écrivons
    \begin{equation}
        B-A=\underbrace{B-\pr_{\ell}(B)}_{=a}+\underbrace{\pr_{\ell}(B)-\pr_{\ell}(A)}_{=b}+\underbrace{\pr_{\ell}(A)-A}_{=c}.
    \end{equation}
    Vu que \( b\perp a\) et \( b\perp c\) nous avons
    \begin{equation}
        \| B-A \|=\langle B-A, B-A\rangle =\| a \|^2+2\langle a, c\rangle +\| b \|^2+\| c \|^2.
    \end{equation}
    Nous pouvons faire le même jeu avec \( \sigma_{\ell}(B)-\sigma_{\ell}(A)\) en tenant compte du fait que \( \pr_{\ell}\big( \sigma_{\ell}(X) \big)=\pr_{\ell}(X)\) et que
    \begin{equation}
        \sigma_{\ell}(A)-\pr_{\ell}(A)=2\pr_{\ell}(A)-A-\pr_{\ell}(A)=-\big( A-\pr_{\ell}(A) \big).
    \end{equation}
    Là nous avons utilisé le lemme \ref{LEMooZSDRooUkNYer}. Ce que nous trouvons est que
    \begin{equation}
        \sigma_{\ell}(B)-\sigma_{\ell}(A)=-a+b-c,
    \end{equation}
    et donc encore une fois 
    \begin{equation}
        \| \sigma_{\ell}(B)-\sigma_{\ell}(A) \|=\| a \|^2-2\langle a, c\rangle +\| b \|^2+\| c \|^2.
    \end{equation}
\end{proof}

\begin{remark}
    Il faut bien comprendre que si l'axe de la réflexion ne passe par par \( 0\) (le zéro de l'espace vectoriel normé \( (E,\| . \|)\)), la réflexion n'est pas une isométrie de \( (E,\| . \|)\) au sens où nous n'avons pas \( \| \sigma_{\ell}(x) \|=\| x \|\).
\end{remark}

\begin{lemma}       \label{LEMooTCIEooXdyuHu}
    Si \( A'\) est l'image de \( A\) par \( \sigma_{\ell}\) alors \( \ell\) est la médiatrice du segment \( [A,A']\).
\end{lemma}

\begin{proof}
    Soit \( M\in\ell\). Nous avons
    \begin{equation}
        \| A-M \|^2=\| \pr_{\ell}(A)-A \|^2+\| \pr_{\ell}(A)-M \|^2
    \end{equation}
    parce que \( A-\pr_{ell}(A)\perp M-\pr_{\ell}(A)\). Par ailleurs, vu que \( \sigma_{\ell}(A)=2\pr_{\ell}(A)-A\) et que \( \pr_{\ell}(A)=\pr_{\ell}(A')\),
    \begin{equation}
        \| \pr_{\ell}(A)-A \|=\| \pr_{\ell}(A')-A' \|.
    \end{equation}
    Nous avons donc
    \begin{equation}
        \| \sigma_{\ell}(A)-M \|^2=\| A-M \|^2,
    \end{equation}
    ce qui prouve que \( M\) est sur la médiatrice de \( [A',A]\) par le lemme \ref{LEMooSZZWooPDHnGl}.
\end{proof}

\begin{normaltext}
    Si \( l\) est une droite dans \( \eR^2\), nous avons la réflexion \( \sigma_l\in\Isom(\eR^2)\) d'axe \( l\). Cela est une isométrie et donc une application affine par le théorème \ref{ThoDsFErq}. Le lemme suivant détermine comment la réflexion \( \sigma_{\ell}\) se décompose en une translation et une application linéaire.
\end{normaltext}

\begin{lemma}   \label{LEMooVOJLooCFgdNG}
    Soit une droite \( \ell\). Alors
    \begin{equation}
        \sigma_{\ell}=\tau_{2w}\circ\sigma_{\ell_0}
    \end{equation}
    où \( \ell_0\) est la droite parallèle à \( \ell\) passant par l'origine, et \( w\) est le vecteur perpendiculaire à \( \ell\) tel que \( \ell_0=\ell+v\).
\end{lemma}

\begin{proof}
    Il faut trouver trois points non alignés sur lesquels les deux applications coïncident; cela suffira par le corollaire \ref{CORooZHZZooDgTzsW}. 

    Pour tous les points de \( \ell_0\), l'égalité fonctionne parce que si \( x\in\ell_0\),
    \begin{equation}
        \sigma_{\ell}(x)=x+2w,
    \end{equation}
    tandis que
    \begin{equation}
        \sigma_{\ell_0}(x)+2w=x+2w
    \end{equation}
    du fait que \( \sigma_{\ell_0}(x)=x\).

    Si \( x\in\ell\), alors
    \begin{equation}
        \sigma_{\ell}(x)=x
    \end{equation}
    tandis que
    \begin{equation}
        \sigma_{\ell_0}(x)+2w=x-2w+2w=x.
    \end{equation}
    Donc les applications affines \( \sigma_{\ell}\) et \( x\mapsto \sigma_{\ell_0}(x)+2w\) coïncident sur \( \ell\) et \( \ell_0\). Elles coïncident donc partout.
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Rotations}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}[Rotation en dimension \( 2\)]        \label{DEFooFUBYooHGXphm}
    Une \defe{rotation}{rotation!en dimension \( 2\)} d'un espace euclidien de dimension \( 2\) est une composée de deux réflexions d'axes non parallèles. L'identité est une rotation.
\end{definition}

\begin{normaltext}
    Quelque remarques à propos de cette définition.
    \begin{enumerate}
        \item
            Attention : nous ne parlons pas encore de rotations «vectorielles» : ici le centre de la rotation (que nous n'avons pas encore défini) peut ne pas être \( 0\).
        \item
            Dans la même veine : plus tard, lorsque nous saurons que les rotations sont des isométries de \( (E,d)\) où \( d(X,Y)=\| X-Y \|\), nous allons en réalité beaucoup plus souvent parler de rotations centrées en l'origine qu'en un point quelconque. C'est pourquoi à partir de \ref{NORMooOUDJooRfbDEX} nous dirons le plus souvent «rotation»  pour «rotation centrée en \( 0\)». D'où les énoncés comme «les rotations sont les matrice orthogonales» (corollaire \ref{CORooVYUJooDbkIFY}) , qui \emph{stricto senus} de la définition \ref{DEFooFUBYooHGXphm} sont faux.
        \item
            Une rotation est composée de deux réflexions d'axes non parallèles. Il est cependant trop tôt pour décréter que l'intersection de ces axes est le centre de la rotation. Rien ne dit en effet pour l'instant que deux décompositions différentes de la même rotation, avec des axes différents donnent le même point d'intersection.
        \item
            Pourquoi ajouter l'identité  ? Pour avoir un groupe. Dans le cas vectoriel, il est suffisant de demander d'être une composée de deux réflexions, parce que toutes les réflexions vectorielles ont des axes qui s'intersectent en \( 0\). Le cas des axes parallèles est seulement le cas des axes confondus et revient à l'identité.

            Si nous voulons avoir un groupe même pour les rotations centrées ailleurs qu'en zéro, nous devons ajouter «à la main» l'identité.
    \end{enumerate}

    Toutes ces remarques se résument par : «tout devient compliqué du fait que nous voulons considérer également les rotations centrées ailleurs qu'en zéro». En se contentent du cas vectoriel, de nombreuses choses sont plus simples.
\end{normaltext}

\begin{corollary}       \label{CORooNKKIooPGOUJl}
    Si \( A\neq B\) dans \( E\) alors il existe une unique réflexion envoyant \( A\) sur \( B\).
\end{corollary}

\begin{proof}
    En ce qui concerne l'existence, la réflexion dont l'axe est la médiatrice de \( [A,B]\) fait l'affaire. En ce qui concerne l'unicité, le lemme \ref{LEMooTCIEooXdyuHu} nous dit que si \( A\) est envoyé sur \( B\), l'axe est forcément la médiatrice de \( [A,B]\).
\end{proof}

\begin{lemma}[\cite{ooYPVPooYGSlNU}]        \label{LEMooIJELooLWqBfE}
    La rotation \( r=\sigma_1\circ\sigma_2\), si elle est différente de l'identité, ne fixe que le point d'intersection \( \ell_1\cap\ell_2\).
\end{lemma}

\begin{proof}
    Nous nommons \( O=\ell_1\cap\ell_2\). Soit \( A\in E\), et supposons que \( r(A)=A\). Nous avons \( \sigma_1\circ r=s_2\) et donc
    \begin{equation}
        \sigma_1(A)=(\sigma_1\circ r)(A)=s_2(A).
    \end{equation}
    On pose \( B=\sigma_1(A)\). Alors \( \sigma_1\) et \( \sigma_2\) envoient tout deux \( A\) sur \( B\). 
    
    Si \( A=B\) alors \( A\) est fixé par \( \sigma_1\) et donc appartient à \( \ell_1\). Même chose pour \( A\) est fixé par \( \sigma_2\) et donc \( A\in\ell_2\). Cela donne \( A=B=O\), et donc le point fixé par \( r\) est \( O\).

    Si \( A\neq B\) alors il existe une unique réflexion envoyant \( A\) sur \( B\) (corollaire \ref{CORooNKKIooPGOUJl}). L'unicité signifie que \( \sigma_1=\sigma_2\). Dans ce cas, \( r=\sigma_1\circ\sigma_2=\id\).
\end{proof}

\begin{normaltext}      \label{NORMooDPBOooKkRuTn}
    La rotation \( \sigma_1\circ\sigma_2\) laisse évidemment fixé le point \( \ell_1\cap \ell_2\). Si \( \sigma_1\circ\sigma_2=\sigma_a\circ\sigma_b\) alors rien n'oblige les axes de \( \sigma_1\) et \( \sigma_2\) d'être identiques à ceux que \( \sigma_a\) et \( \sigma_b\). Mais l'intersection \( \ell_1\cap\ell_2\) doit être la même que l'intersection \( \ell_a\cap \ell_b\) parce que c'est l'unique point fixé par la composée. Cela nous permet de poser les définition suivante.
\end{normaltext}

\begin{definition}
    Le \defe{centre}{centre!d'une rotation} d'une rotation (autre que l'identité) est l'unique point fixé par la rotation.
\end{definition}
Comme expliqué dans \ref{NORMooDPBOooKkRuTn}, le centre de la rotation s'obtient en l'écrivant comme composée de deux réflexions et en considérant le point d'intersection des axes.

\begin{lemma}       \label{LEMooTZNWooTVOklu}
    Les rotation sont des isométries pour la distance : \( \| X-Y \|=\| r(X)-r(Y) \|\).
\end{lemma}

\begin{proof}
    Si \( r=\sigma_1\circ\sigma_2\), en utilisant le fait que \( \sigma_1\) et \( \sigma_2\) sont des isométries de \( (E,d)\) (\ref{PROPooFSVEooWmJsnv}) nous avons :
    \begin{equation}
        d(X,Y)=d\big( \sigma_2(X),\sigma_2(Y) \big)=d\big( \sigma_1\sigma_2(X),\sigma_1\sigma_2(Y) \big)=d\big( r(X),r(Y) \big).
    \end{equation}
\end{proof}

Ce lemme nous dit qu'une rotation de centre \( O\) vérifie \( \| OX \|=\| Or(X) \|\) pour tout \( X\).

\begin{proposition}[\cite{ooYPVPooYGSlNU}]      \label{PROPooNXJKooEDOczh}
    Soient \( A,B,O\in E\) tels que \( \| AO \|=\| BO \|\neq 0\). Alors il existe une unique rotation \( r\) centrée en \( O\) telle que \( r(A)=B\).
\end{proposition}

\begin{probleme}
    Attention : la preuve qui suit contient de nombreuses galipettes et improvisations personnelles. Relisez-la attentivement avant de la prendre pour argent comptant.

    La difficulté tient essentiellement à ce que cette preuve traite de façon vectorielle (tous les points sont des éléments de \( E\)) un énoncé qui est essentiellement affine : tous les points doivent être vus comme vecteurs partant de \( O\).

    Si vous comparez la preuve donnée ici avec celle de \cite{ooYPVPooYGSlNU}, vous remarquerez que dans ce dernier, seule la partie «\( A\) et \( O\) son alignés» est présente. C'est parce que lui, il se met directement dans le cas vectoriel et \( O=0\). Il a donc une preuve un tout petit peu moins générale, mais au moins ses isométries sont linéaires et non affines.
\end{probleme}

\begin{proof}
    Existence et unicité séparément.
    \begin{subproof}
        \item[Existence]
            Si \( A=B\), l'identité fait l'affaire. Sinon, \( \| A-O \|=\| B-O \|\) implique que la médiatrice de \( [A,B]\) contient \( O\). Soit \( \sigma_m\) la réflexion selon cette médiatrice. La rotation \( \sigma_m\circ\sigma_{(AO)}\) convient.

        \item[Unicité]

            Soit \( r\) une rotation de centre \( O\) et telle que \( r(A)=B\). Si \( A=B\) alors \( r=\id\) parce qu'une rotation autre que l'identité ne fixe que son centre par le lemme \ref{LEMooIJELooLWqBfE}. Nous supposons que \( A\neq B\).

            Nous posons \( g=\sigma_m\circ r\). Alors \( g(A)=\sigma_m(B)=A\) parce que \( \sigma_m(B)=A\) et \( r(A)=B\). Cela signifie que \( g\) est une isométrie qui fixe \( A\). 
            
            \begin{subproof}
                \item[Si \( A\) et \( O\) ne sont pas alignés]
                
                    Attention : ici \( O\) est un point de \( E\), pas le zéro de l'espace vectoriel \( E\). Lorsqu'on dit que \( A\) et \( O\) ne sont pas alignés, nous parlons bien d'alignement avec le zéro de \( E\).

                    Nous avons \( g(A)=A\) et \( g(O)=O\). Donc \( g\) coïncide avec \( \sigma_{(AO)}\) en deux points non alignés, c'est à dire en deux points pour lesquels l'espace engendré est tout \( E\). Nous en déduisons que \( g=\sigma_{(AO)}\).

                \item[Si \( A\) et \( O\) sont alignés]
            
            
            Soit maintenant un point \( C\) tel que \( A-O\perp C-O\) et 
            \begin{equation}
                \| OC \|=\| OA \|=\| OB \|.
            \end{equation}
            Vu que \( g\) est une isométrie pour la distance sur \( E\), pas pour la norme, nous ne pouvons pas écrire \( g(C-O)\perp g(A-O)\) à partir de \( C-O\perp A-O\). Nous décomposons \( g(X)=s(X)+G\) où \( s\) est linéaire sur \( E\). Il est vite vu que \( s\) est une isométrie de \( (E,\| . \|)\) :
            \begin{equation}
                \| X-Y \|=\| g(X)-g(Y) \|=\| s(X)+G-s(y)-G \|=\| s(X)-s(Y) \|=\| s(X-Y) \|
            \end{equation}
            pour tout \( X,Y\in E\). Nous avons de plus \( g(A)=A\) et \( g(O)=O\), ce qui donne \( O=s(O)+G\) et \( A=s(A)+G\). En égalisant les valeurs de \( G\) nous avons
            \begin{equation}        \label{EQooPEWGooABHUvu}
                O-s(O)=A-s(A).
            \end{equation}
            Vu que \( s\) est une isométrie (une vraie) nous avons
            \begin{equation}
                s(A-O)\perp s(C-O),
            \end{equation}
            mais \( s(A-O)=s(A)-s(O)=A-O\) par \eqref{EQooPEWGooABHUvu}. Donc
            \begin{equation}
                A-O\perp s(C-O).
            \end{equation}
            Nous en concluons que \( s(C-O)=\pm (C-O)\). Parce que les vecteurs \( \pm(C-O)\) sont les deux seuls de norme \( \| AO \| =\| CO \|\) à être perpendiculaire à \( A-O\). Rappel : la définition de \( C\) et le fait que nous soyons en dimension \( 2\).o
            
            Est-il possible d'avoir \( s(C-O)=C-O\) ? Cela donnerait
            \begin{subequations}
                \begin{align}
                    g(A-O)&=s(A)-s(O)+G=s(A)-O+O-s(O)+G=A-O+G\\
                    g(C-O)&=C-O+G,
                \end{align}
            \end{subequations}
            ce qui signifierait que \( g\) et \( \tau_G\) coïncideraient sur les points \( A-O\) et \( C-O\), et donc seraient égaux par le corollaire \ref{CORooZHZZooDgTzsW}. Cela est cependant impossible parce que \( g\) fixe au moins les points \( A\) et \( O\) alors que la translation ne fixe aucun point. Nous en déduisons \( s(C-O)=-(C-O)\).

            Nous avons aussi, parce que \( (AO)\) est une droite passant par l'origine que
            \begin{equation}
                \sigma_{(AO)}(A-O)=A-O
            \end{equation}
            et parce que \( C-O\) est perpendiculaire à cette droite :
            \begin{equation}
                \sigma_{(AO)}(C-O)=-(C-O).
            \end{equation}
            Nous avons donc quand même que \( g\) et \( \sigma_{(AO)}\) coïncident sur deux points non alignés : \( A-O\) et \( C-O\).

            \end{subproof}

            Dans tous le cas, \( g=\sigma_{(AO)}\). Nous avons donc
            \begin{equation}
                \sigma_{(OA)}=\sigma_m\circ r,
            \end{equation}
            et donc \( r\) est fixé à
            \begin{equation}
                r=\sigma_m\circ\sigma_{(OA)}.
            \end{equation}
    \end{subproof}
\end{proof}

\begin{normaltext}
    Anticipons un peu et faisons semblant de déjà connaitre les matrices et les fonctions trigonométriques. La proposition \ref{PROPooNXJKooEDOczh} nous dit qu'il existe une seule rotation amenant \( A\) sur \( B\). Vous pourriez objecter que le point \( (1,0)\) peut être amené sur \( (0,-1)\) soit par la rotation d'angle \( 3\pi/2\), soit par celle d'angle \( -\pi/2\). Il n'en est rien parce que ces deux rotations sont les mêmes ! Pensez-y. En tant qu'application \( \eR^2\to \eR^2\), la rotation \( R_{3\pi/2}\) est égale à \( R_{-\pi/2}\).
\end{normaltext}

Une rotation donnée peut être écrite de beaucoup de façons comme composée de deux réflexions. En fait d'autant de façons qu'il y a de réflexions.
\begin{proposition}[\cite{ooYPVPooYGSlNU}]      \label{PROPooKAZEooLTHWKe}
    Soit une rotation \( r\) de \( E\) centrée en \( O\). Pour toute réflexion \( \sigma_{\ell}\) telle que le centre de \( r\) soit sur \( \ell\), il existe une réflexion \( \sigma_1\) tells que \( r=\sigma_1\circ\sigma_{\ell}\). Il existe aussi une réflexion \( \sigma_2\) telle que \( r=\sigma_{\ell}\circ s_2\).
\end{proposition}

\begin{proof}
    Si \( r=\id\) c'est bon avec \( s_1=s_2=\sigma_{\ell}\). Sinon nous considérons \( A\neq O\) sur \( \ell\), et \( B=r(A)\). Nous savons que \( B\neq A\) parce que \( O\) est le seul point de \( E\) fixé par \( r\) (proposition \ref{LEMooIJELooLWqBfE}). Il existe une réflexion (unique) \( \sigma_1\) faisant \( \sigma_1(A)=B\), et c'est le réflexion dont l'axe est la médiatrice de \( [A,B]\). Le point \( O\) est sur cette médiatrice parce que les rotations sont des isométries de \( (E,d)\) (lemme \ref{LEMooTZNWooTVOklu}).

    La rotation \( \sigma_1\circ \sigma_{\ell}\) vérifie
    \begin{equation}
        (\sigma_1\circ\sigma_{\ell})(A)=\sigma_1(A)=B.
    \end{equation}
    Or \( \| OA \|=\| OB \|\), donc il y a unicité de la rotation centrée en \( O\) portant \( A\) sur \( B\) (proposition \ref{PROPooNXJKooEDOczh}); nous avons donc \( r=\sigma_1\circ\sigma_{\ell}\).

    En ce qui concerne \( r=\sigma_{\ell}\circ\sigma_2\), il faut appliquer ce que nous venons de faire à la rotation \( r^{-1}\): il existe \( \sigma_2\) tel que \( r^{-1}=\sigma_2\circ\sigma_{\ell}\), ce qui donne
    \begin{equation}
        r=\sigma_{\ell}\circ\sigma_2.
    \end{equation}
\end{proof}

\begin{proposition}[\cite{ooYPVPooYGSlNU}]      \label{PROPooWMESooNJMdxf}
    Les rotations basées en \( O\) forment un groupe abélien.
\end{proposition}

\begin{proof}
    L'identité est une rotation par définition. En ce qui concerne l'inverse, si \( r=\sigma_1\sigma_2\) alors \( r^{-1}=\sigma_2\sigma_1\). Nous commençons maintenant les choses pas tout à fait évidentes.
    \begin{subproof}
        \item[Composition]
            Soient des rotations \( r,r'\) centrées en \( O\). Soit également une réflexion \( \sigma\) dont l'axe contient \( O\). Alors la proposition \ref{PROPooKAZEooLTHWKe} nous donne l'existence de \( \sigma_1\) et \( \sigma_2\) tels que \( r=\sigma_1\sigma\) et \( r'=\sigma\sigma_2\). Avec ça, la composition donne
            \begin{equation}
                rr'=\sigma_1\sigma\sigma\sigma_2=\sigma_1\sigma_2,
            \end{equation}
            qui est encore une rotation.
        \item[Commutativité]
            Soient deux rotations \( r\) et \( r'\) ainsi que des décompositions \( r=\sigma_1\sigma\), \( r'=\sigma\sigma_2\). Nous avons
            \begin{subequations}
                \begin{align}
                    rr'&=\sigma_1\sigma_2\\
                    r'r&=\sigma\sigma_2\sigma_2\sigma.
                \end{align}
            \end{subequations}
            Vu que \( t=\sigma_2\sigma_1\) est une rotation nous pouvons encore appliquer la proposition \ref{PROPooKAZEooLTHWKe} pour avoir \( t=\sigma_2\sigma_1=\sigma\sigma_3\). Avec ça,
            \begin{equation}
                r'r=\sigma\sigma\sigma_3\sigma=\sigma_3\sigma.
            \end{equation}
            Mais aussi \( rr'=\sigma_1\sigma_2=t^{-1}=\sigma_3\sigma\). Nous avons donc bien \( rr'=r'r\), et le groupe est commutatif.
    \end{subproof}
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Rotations vectorielles}
%---------------------------------------------------------------------------------------------------------------------------

\begin{normaltext}      \label{NORMooOUDJooRfbDEX}
    Jusqu'à présent nous avons parlé de rotations «affines». Parmi elles, Les rotations centrées en \( 0\) (zéro, l'origine de \( E\) comme espace vectoriel) sont de particulière importance. Ce sont des applications linéaires, et même des isométries. Dans la suite, nous allons souvent dire simplement «rotation» pour dire «rotation centrée en \( 0\)».

    Vu que nous allons maintenant prendre un point de vue plus vectoriel, nous allons noter les points de \( E\) avec des lettres comme \( x\), \( y\), \( u\), \( v\) et plus avec des majuscules, comme quand on avait un point de vue affin. En même temps, nous allons noter les applications \( E\to E \) par des lettres comme \( A\) et ne plus écrire les parenthèses. Bref, nous écrivons \( Au\) au lieu de \( r(A)\).
\end{normaltext}

\begin{lemma}       \label{LEMooSYZYooWDFScw}
    En dimension \( 2\), les réflexions (vectorielles, c'est à dire dont l'axe passe par \( 0\)) ont un déterminant \( -1\).
\end{lemma}

\begin{proof}
    Soit une réflexion d'axe \( \ell\). Prenons une base orthonormale de \( E\) constituée de \( e_1\) sur \( \ell\) et de \( e_2\perp \ell\). Alors \( \sigma_{\ell}(e_1)=e_1\) et \( \sigma_{\ell}(e_2)=-e_2\). la formule du déterminant donne
    \begin{equation}
        \det(\sigma_{\ell})=e_1^*\big( \sigma_{\ell}(e_1) \big)e_1^*\big( \sigma_{\ell}(e_2) \big)-e_2^*\big( \sigma_{\ell}(e_1) \big)e_1^*\big( \sigma_{\ell}(e_2) \big)=1\times (-1)-0\times 0=-1.
    \end{equation}
    Nous utilisons de façon cruciale le fait que le calcul du déterminant ne dépende pas de la base choisie, lemme \ref{LEMooQTRVooAKzucd}.
\end{proof}

\begin{proposition}     \label{PROPooTUJWooAjtEnQ}
    Les rotations\footnote{Centrées en \( 0\), nous ne le répéterons pas !} sont 
    \begin{enumerate}
        \item
            des applications orthogonales au sens de la définition \ref{DEFooYKCSooURQDoS},
        \item
             des applications de déterminant \( 1\),
    \end{enumerate}
\end{proposition}

\begin{proof}
    Nous avons, pour tout \( u\in E\) l'égalité de la norme \( \| u \|\) et \( \| Au \|\) par le lemme \ref{LEMooTZNWooTVOklu} appliqué à \( Y=0\). En terme de produits scalaires nous avons alors \( \langle Au, Au\rangle =\langle u, u\rangle \), et donc
    \begin{equation}
        \langle A^*Au, u\rangle =\| u \|^2.
    \end{equation}
    En particulier si \( \{ e_i \}_{i=1,\ldots, n}\) est une base orthonormée de \( E\) nous avons
    \begin{equation}
        (A^*Ae_i)_i=\| e_i \|^2=1,
    \end{equation}
    ce qui donne \( \| A^*Ae_i \|\geq 1\), avec égalité si et seulement si \( A^*Ae_i=e_i\). Ici nous avons utilisé le fait que \( \langle x, e_i\rangle =x_i\), et le fait que pour tout \( i\) nous ayons \( \| x \|\geq | x_i |\), avec égalité seulement si \( x\) est un multiple de \( e_i\).

    Par ailleurs l'inégalité de Cauchy-Schwarz \ref{ThoAYfEHG} nous donne
    \begin{equation}
        \| u \|^2=| \langle A^*Au, u\rangle  | \leq \| A^*Au \|\| u \|
    \end{equation}
    et donc
    \begin{equation}
        \| u \|\leq \| A^*Au \|.
    \end{equation}
    Encore une fois, en appliquant cela à \( u=e_i\) nous trouvons \( 1\leq \| A^*Ae_i \|\). Vu que nous avions déjà l'inégalité dans l'autre sens, \( \| A^*Ae_i \|=1\). Et le cas d'égalité est uniquement possible avec \( A^*Ae_i=e_i\).

    Donc pour tout \( i\) de la base nous avons \( A^*Ae_i=e_i\). Nous avons donc \( A^*A=\id\) et l'application \( A\) est orthogonale. 

    En ce qui concerne le déterminant, les réflexions sont de déterminant \( -1\) par le lemme \ref{LEMooSYZYooWDFScw}, donc \( A=\sigma_1\circ\sigma_2\) est de déterminant \( 1\). Nous avons utilisé le fait que le déterminant était un morphisme : proposition \ref{PropYQNMooZjlYlA}\ref{ItemUPLNooYZMRJy}.
\end{proof}

\begin{remark}
    Nous ne savons pas encore que les rotations forment tout le groupe \( \SO(2)\) des endomorphismes orthogonaux de déterminant \( 1\). Il faudra attendre le corollaire \ref{CORooVYUJooDbkIFY} pour le savoir.
\end{remark}

\begin{lemma}       \label{LEMooMIJXooCjiQqP}
    L'application \( -\id\) est une rotation.
\end{lemma}

\begin{proof}
    Soit une base orthonormée \( \{ e_1,e_2 \}\) de \( E\) et la rotation \( r=\sigma_1\sigma_2\) où \( \sigma_i\) est la réflexion le long de l'axe \( \ell_i=\{ te_i \}_{t\in \eR}\). Faut-il vous prouver que \( r=-\id\) ? La réflexion \( \sigma_2\) retourne la composante \( y\) d'un vecteur écrit dans la base \( \{ e_1,e_2 \}\) sans toucher à la composante \( x\). La réflexion \( \sigma_1\) fait le contraire.
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Angle}
%---------------------------------------------------------------------------------------------------------------------------

Avant d'aborder la classification des isométries, nous devons parler de l'angle entre deux droites. Si \( \ell_1\) et \( \ell_2\) sont deux droites, alors il est bien clair deux angles peuvent prétendre être «l'angle entre \( \ell_1\) et \( \ell_2\)». De plus chacun de ces deux angles sont doubles parce que si \( \alpha\) peut prétendre être l'angle entre \( \ell_1\) et \( \ell_2\), alors \( -\alpha\) peut également prétendre.

\begin{lemmaDef}        \label{DEFooEGKOooRPGOAs}
    Si \( \ell_1\) et \( \ell_2\) sont deux droites sécantes au point \( O\) et si \( x\in\ell_1\) n'est pas \( O\), alors il existe un unique \( \alpha\in \mathopen[ 0 , \pi \mathclose[\) tel que \( R_O(\alpha)x\in \ell_2\). La valeur de \( \alpha\) ne dépend pas du choix du point \( x\in \ell_1\).

        Cet angle \( \alpha\) est l'\defe{angle}{angle!entre deux droites} de \( \ell_1\) à \( \ell_2\).
\end{lemmaDef}

\begin{remark}
    Nous ne parlons pas de l'angle entre \( \ell_1\) et \( \ell_2\) mais bien de l'angle \emph{de} \( \ell_1\) \emph{à} \( \ell_2\). L'ordre des droites est important.
\end{remark}

\begin{normaltext}
    Pour la suite, \( R_O(\alpha)\) est la rotation d'angle \( \alpha\) autour du point \( O\) tandis que \( R(\alpha)\) est la rotation d'angle \( \alpha\) autour de l'origine. En termes matriciels, la rotation d'angle \( \alpha\) est donnée par
    \begin{equation}        \label{EQooQBEJooAHaBbJ}
        R(\alpha)=\begin{pmatrix}
            \cos(\alpha)    &   -\sin(\alpha)    \\ 
            \sin(\alpha)    &   \cos(\alpha)    
        \end{pmatrix},
    \end{equation}
\end{normaltext}

\begin{lemma}[\cite{MonCerveau}]        \label{LEMooJLHGooQIpKIE}
    Soit \( A\in \eR^2\) et une droite \( \ell_1\). Soit \( \ell_2\) une droite passant par \( A\) et intersectant \( \ell_1\) en \( O\). Alors
    \begin{equation}
        \sigma_{\ell_1}(A)=R_O(-2\alpha)A
    \end{equation}
    où \( \alpha\) est l'angle de \( \ell_1\) à \( \ell_2\).
\end{lemma}

\begin{proof}
    Nous allons utiliser des coordonnées autour de \( O\). Il existe un vecteur \( v\) tel que
    \begin{equation}
        A=O+v
    \end{equation}
    Par définition de l'angle \( \alpha\), la droite \( \ell_2\) s'obtient par rotation d'angle \( \alpha\) depuis la droite \( \ell_1\). Donc le point
    \begin{equation}
        B=R_O(-\alpha)A
    \end{equation}
    est sur \( \ell_1\).

    Nous allons prouver que le point
    \begin{equation}
        D=R_O(-2\alpha)A
    \end{equation}
    est \( D=\sigma_{\ell_1}A\).

    Nous commençons par montrer que la droite \( (DA)\) est perpendiculaire à \( \ell_1\), c'est à dire que
    \begin{equation}
        (D-A)\cdot (B-O)=0.
    \end{equation}
    En utilisant le fait que 
    \begin{equation}
        R_O(\alpha)(O+X)=O+R(\alpha)X,
    \end{equation}
    nous avons
    \begin{equation}
        D-A=R_O(-2\alpha)(O+v)-(O+v)=O+R(-2\alpha)v-O-v=R(-2\alpha)v-v
    \end{equation}
    et de la même façon,
    \begin{equation}
        B-O=R(-\alpha)v.
    \end{equation}
    Notons que tous les \( O\) se sont simplifiés et qu'il ne reste que des rotation usuelles. En utilisant le fait que \( R(\alpha)\) est une isométrie, nous pouvons alors calculer
    \begin{subequations}
        \begin{align}
            (D-A)\cdot (B-O)&=\langle R(-2\alpha)v-v, R(-\alpha)v\rangle \\
            &=\langle R(-\alpha)v-R(\alpha)v, v\rangle.
        \end{align}
    \end{subequations}
    En utilisant la matrice de rotation \eqref{EQooQBEJooAHaBbJ} nous trouvons
    \begin{equation}
        \big( R(-\alpha)-R(\alpha) \big)v=\begin{pmatrix}
            2\sin(\alpha)v_2    \\ 
            -2\sin(\alpha)v_1    
        \end{pmatrix}
    \end{equation}
    et donc
    \begin{equation}
        \langle  \big( R(-\alpha)-R(\alpha) \big)v  , v\rangle =0.
    \end{equation}

    Le point \( D\) est bien sûr la droite perpendiculaire à \( \ell_1\) et passant par \( A\). Mais vu que \( D\) est obtenu à partir de \( A\) par une rotation, le point \( D\) est également sur le cercle de rayon \( \| OA \|\) et centré en \( O\). Ce cercle possède exactement deux intersections avec cette droite. Le premier est \( A\) et le second est \( \sigma_{\ell_1}(A)\). Vu que \( D\) n'est pas \( A\), nous avons \( D=\sigma_{\ell}(A)\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Classification}
%---------------------------------------------------------------------------------------------------------------------------

\begin{theorem}[\cite{ooZYLAooXwWjLa}]      \label{THOooRORQooTDWFdv}
    Toute isométrie du plan est une composition d'au plus \( 3\) réflexions. 
\end{theorem}

\begin{proof}
    Encore une fois nous décomposons la preuve en fonction du nombre de points fixes.
    \begin{subproof}
        \item[Si \( f\) n'a pas de points fixes]
            Soit \( x\in \eR^2\) et \( l\), la médiatrice du segment \( [x,f(x)]\). Par construction, \( f(x)=\sigma_l(x)\). Nous posons \( g=\sigma_l\circ f\), et nous avons
            \begin{equation}
                g(x)=x.
            \end{equation}
            Donc nous avons \( f=\sigma_l\circ g\) avec \( x\in\Fix(g)\).
        \item[Si \( f\) a un unique point fixe]
            Soit \( x\) cet unique point fixe. Soit \( y\neq x\) et \( l\) la médiatrice de \( [y,f(y)]\). En posant \( g=\sigma_l\circ f\) nous avons 
            \begin{equation}
                g(y)=y
            \end{equation}
            et \( g(x)=x\) parce que
            \begin{equation}
                d\big( x,f(y) \big)=d\big( f(x),f(y) \big)=d(x,y),
            \end{equation}
            ce qui donne que \( x\) est à égale distance de \( y\) et de \( f(y)\), c'est à dire que \( x\in l\) et par conséquent \( g(x)=(\sigma_l\circ f)(x)=\sigma_l(x)=x\). 

            Donc \( g\) fixe \( x\) et \( y\) et donc toute la droite \( (xy)\).
        \item[Si \( f\) fixe une droite]
            Soit \( l\) une droite fixée par \( f\), et soient \( x,y\in l\) et \( z\notin l\) (avec \( x\neq y\)). Le fait que \( x\) et \( y\) soient des points fixes de \( f\) implique
            \begin{subequations}
                \begin{numcases}{}
                    d\big( x,f(z) \big)=d(x,z)\\
                    d\big( y,f(z) \big)=d(y,z)
                \end{numcases}
            \end{subequations}
            ce qui signifie que \( f(z)\) est sur l'intersection des deux cercles\footnote{L'intersection existe pare que \( d(x,z)+d(y,z)>d(x,y)\).} \( S\big( x,d(x,z) \big)\) et \( S\big( y, d(y,z) \big)\), et comme ce sont deux cercles centrés sur la droite \( l\), les intersections sont liées par \( \sigma_l\). Autrement dit, les intersections sont \( z\) et \( \sigma_l(z)\).

            Si \( f(z)=z\) alors \( f\) fixe trois points non alignés et fixe dont \( \eR^2\), c'est à dire \( f=\id\).

            Si par contre \( f(z)=\sigma_l(z)\) alors les isométries \( f\) et \( \sigma_l\) coïncident sur trois points et coïncident donc partout par le corollaire \ref{CORooZHZZooDgTzsW} : \( f=\sigma_l\).
        \item[Conclusion]

            Nous avons montré que si \( \Fix(f)\) a dimension \( m\), alors il existe une droite pour laquelle \( f=\sigma_l\circ g\) avec \( \dim\big( \Fix(g) \big)>m\). Donc il faux au maximum trois pas pour avoir \( \dim\big( \Fix(g) \big)=2\) c'est à dire pour avoir \( g=\id\).
    \end{subproof}
\end{proof}

\begin{definition}
    Une \defe{réflexion glissée}{réflexion!glissée} est une transformation du plan de la forme \( \tau_v\circ\sigma_{\ell}\) où le vecteur \( v\) est parallèle à la droite \( \ell\).
\end{definition}

\begin{theorem}[\cite{ooZYLAooXwWjLa}]      \label{THOooVRNOooAgaVRN}
    Les isométries du plan sont exactement
    \begin{enumerate}
        \item
            l'identité (composée de \( 0\) réflexions),
        \item
            les réflexions,
        \item
            les translations (composées de \( 2\) translations d'axes parallèles),
        \item
            les rotations (composées de \( 2\) réflexions d'axes non parallèles),
        \item
            les réflexions glissées (composées de \( 3\) réflexions)
    \end{enumerate}
\end{theorem}

\begin{proof}
    Nous savons déjà que \( f\in \Isom(\eR^2)\) est une composée de \( 0\), \( 1\), \( 2\) ou \( 3\) réflexions. 
    \begin{subproof}
        \item[Zéro réflexions]
            Alors c'est l'identité. Ce n'est pas très profond.
        \item[Une réflexion]
            Alors \( f\) est une réflexion. Toujours pas très profond.
        \item[Deux réflexions]
            Soit \( f=\sigma_{\ell_1}\circ\sigma_{\ell_2}\). Maintenant ça s'approfondit un bon coup.
            
            Nous supposons d'abord que \( \ell_1\parallel\ell_2\). Dans ce cas nous allons prouver que \( f=\tau_{2v}\) où \( v\) est le vecteur perpendiculaire à \(  \ell_1 \) tel que \( \ell_1+v=\ell_2\). Nous allons utiliser le lemme \ref{LEMooVOJLooCFgdNG} pour montrer que \( \sigma_{\ell_1}\circ\sigma_{\ell_2}=\tau_{2v}\). Nous avons
            \begin{subequations}
                \begin{align}
                    \ell_1=\ell_0+w\\
                    \ell_2=\ell_0+w+v
                \end{align}
            \end{subequations}
            où \( w\) est un vecteur perpendiculaire à \( \ell_1\) et \( \ell_0\) est la droite passant par l'origine et parallèle à \( \ell_1\) et \( \ell_2\). Avec cela,
            \begin{subequations}
                \begin{align}
                    (\sigma_{\ell_1}\circ\sigma_{\ell_2})(x)&=\sigma_{\ell_1}\big( \sigma_{\ell_0}(x)+2w \big)\\
                    &=\sigma_{\ell_0}\big( \sigma_{\ell_0}(x)+2w \big)+2(v+w)\\
                    &=x+\underbrace{\sigma_{\ell_0}(2w)}_{-2w}+2v+2w\\
                    &=x+2v.
                \end{align}
            \end{subequations}
            Donc si \( f\) est composée de deux réflexions d'axes parallèles, alors \( f\) est une translation.

            Toujours dans le cas où \( f\) est composée de deux réflexions, nous supposons que \( f=\sigma_{\ell_2}\circ\sigma_{\ell_1}\) avec \( \ell_1\) et \( \ell_2\) non parallèles. Nous notons \( O\) le point d'intersection, et nous allons voir que \( f=R_O(2\alpha)\) où \( \alpha\) est l'angle de \( \ell_1\) à \( \ell_2\) donné par le lemme \ref{DEFooEGKOooRPGOAs}.

            Soit \( x\in \ell_1\). Alors 
            \begin{equation}
                f(x)=\sigma_{\ell_2}(x),
            \end{equation}
            et le lemme \ref{LEMooJLHGooQIpKIE} nous donne un moyen de calculer \( \sigma_{\ell_2}(x)\) parce que \( \ell_1\) est une droite passant par \( x\) et coupant \( \ell_1\) au point \( O\). Le lemme dit que \( \sigma_{\ell_2}(x)=R_O(2\alpha)\). Remarque : c'est bien \( 2\alpha\) et non \( -2\alpha\) parce qu'il s'agit de l'angle de \( \ell_2\) à \( \ell_2\); il y a inversion des numéros entre ici et l'énoncé du lemme.

            Nous avons donc bien \( f(x)=R_O(2\alpha)x\) pour \( x\in \ell_1\).

            Si \( y\in\ell_2\) alors
            \begin{equation}
                f(y)=\sigma_{\ell_2}\big( R_O(-2\alpha)y \big)
            \end{equation}
            Nous posons \( z=\sigma_{\ell_1}(y)=R_O(-2\alpha)y\). Soit la droite \( \ell_3\) passant par \( O\) et \( z\). Vu que \( R_O(2\alpha)z=y\in \ell_2\), l'angle de \( \ell_3\) à \( \ell_2\) est \( 2\alpha\). Par conséquent 
            \begin{equation}
                \sigma_{\ell_2}(z)=R_O\big( -2\times (-2\alpha) \big)z=R_O(4\alpha)z=R_O(4\alpha)R_O(-2\alpha)y=R_O(2\alpha)y.
            \end{equation}
            
            Donc les transformations \( f\) et \( R_O(2\alpha)\) coïncident pour tous les points des droites \( \ell_1\) et \( \ell_2\), qui ne sont pas parallèles. Cela prouve que \( f=R_{O}(2\alpha)\).

        \item[Trois réflexions]
            Nous écrivons \( f=\sigma_{\ell_3}\circ\sigma_{\ell_2}\circ\sigma_{\ell_1}\). Nous allons transformer cela progressivement en une symétrie glissée en passant par plusieurs étapes :
            \begin{enumerate}
                \item       \label{ITEMooHVYCooPhFMiv}
                    \( f=\sigma_{\ell}\circ\tau_v\),
                \item       \label{ITEMooUKGLooFlCcjt}
                    \( f=\tau_v\circ\sigma_{\ell}\),
                \item       \label{ITEMooWUCWooZSjofe}
                    \( f=\tau_v\circ\sigma_{\ell} \) avec \( v\parallel\ell\).
            \end{enumerate}
            À chacune de ces étapes, \( v\) et \( \ell\) vont changer. La dernière est une réflexion glissée.

            Nous commençons par supposer \( \ell_2\parallel\ell_3\). Dans ce cas, \( \sigma_{\ell_3}\circ\sigma_{\ell_2}\) est une translation, comme nous l'avons déjà vu. Alors \( f= \tau_v\circ\sigma_{\ell_1}\) et nous sommes déjà dans le cas \ref{ITEMooUKGLooFlCcjt}.

            Nous supposons que \( \ell_2\) n'est pas parallèle à \( \ell_3\). Dans ce cas, si \( O=\ell_2\cap\ell_3\) nous avons 
            \begin{equation}
                \sigma_{\ell_3}\circ\sigma_{\ell_2}=R_O(2\alpha)
            \end{equation}
            où \( \alpha\) est l'angle de \( \ell_2\) à \( \ell_3\). En réalité tant que l'angle de \( \ell'_3\) à \( \ell'_2\) est \( \alpha\) nous avons
            \begin{equation}
                \sigma_{\ell'_3}\circ\sigma_{\ell'_2}= \sigma_{\ell_3}\circ\sigma_{\ell_2}=R_O(2\alpha).
            \end{equation}
            Nous choisissons \( \ell'_2\) parallèle à \( \ell_1\), de telle sorte à ce que \( \sigma_{\ell'_2}\circ\sigma_{\ell_1}\) soit une translation. Alors nous avons
            \begin{equation}
                f=\sigma_{\ell_3}\circ\sigma_{\ell_2}\circ\sigma_{\ell_1}=\sigma_{\ell_3}\circ\sigma_{\ell'_2}\circ\sigma_{\ell'_1}=\sigma_{\ell_3}\circ\tau_v.
            \end{equation}
            où \( v\) est le vecteur de la translation en question.

            Nous avons donc prouvé que toute composition de trois réflexions peut être écrite soit sous la forme \ref{ITEMooHVYCooPhFMiv} soit sous la forme \ref{ITEMooUKGLooFlCcjt}.

            Nous prouvons à présent que toute transformation de la forme \ref{ITEMooHVYCooPhFMiv} peut être écrite sous la forme \ref{ITEMooUKGLooFlCcjt}. Plus précisément nous allons prouver que si \( \ell\) est une droite, \( v\) un vecteur et \( \ell_0\) la droite parallèle à \( \ell\) passant par l'origine, alors
            \begin{equation}
                \sigma_{\ell}\circ\tau_v=\tau_{\sigma_{\ell_0}(v)}\circ\sigma_l
            \end{equation}
            D'abord nous savons que \( \sigma_{\ell}(x)=\sigma_{\ell_0}(x)+2w\) où \( w\) est le vecteur tel que \( \ell=\ell_0+w\). Ensuite c'est un simple calcul utilisant le fait que \( \sigma_{\ell_0}\) est linéaire :
            \begin{equation}
                (\sigma_{\ell}\circ\tau_v)(x)=\sigma_l(x+v)=\sigma_{\ell_0}(x)+\sigma_{\ell_0}(v)+2w,
            \end{equation}
            et
            \begin{equation}
                (\tau_{\sigma_{\ell_0}(v)}\circ\sigma_{\ell})(x)=\sigma_{\ell_0}(v)+\sigma_{\ell}(x)=\sigma_{\ell_0}(v)+\sigma_{\ell_0}(x)+2w.
            \end{equation}
            L'égalité est faite.

            Nous montrons maintenant que toute transformation de la forme \ref{ITEMooUKGLooFlCcjt} peut être mise sous la forme \ref{ITEMooWUCWooZSjofe}. Soit donc \( f=\tau_v\circ\sigma_{\ell}\) où \( v\) et \( \ell\) ne sont pas spécialement parallèles.

            Pour cela nous décomposons \( v=v_1+v_2\) avec \( v_1\perp \ell\) et \( v_2\parallel\ell\) et nous posons \( \ell'=\ell+\frac{ 1 }{2}v_1\). Nous montrons que
            \begin{itemize}
                \item \( \tau_v\circ\sigma_{\ell}=\tau_{v_2}\circ\sigma_{\ell'}\)
                \item \( v_2\parallel \ell'\).
            \end{itemize}
            Pour le deuxième point, \( v_2\parallel\ell\) et bien entendu \( \ell'\parallel\ell\). Donc \( v_2\parallel\ell'\).

            Soit \( \ell_0\) la droite parallèle à \(  \ell\) et \( \ell'\) et passant par l'origine. Soit aussi le vecteur \( w\) tel que \( \ell=\ell_0+w\). Alors nous avons
            \begin{subequations}
                \begin{numcases}{}
                    \sigma_{\ell}=\sigma_{\ell_0}+2w\\
                    \sigma_{\ell'}=\sigma_{\ell_0}+2w+v_1
                \end{numcases}
            \end{subequations}
            Nous avons
            \begin{equation}
                (\tau_v\circ\sigma_{\ell})(x)=v+\sigma_{\ell_0}(x)+2w
            \end{equation}
            et
            \begin{subequations}
                \begin{align}
                    (\tau_{v_2}\circ\sigma_{\ell'})(x)&=v_2+\sigma_{\ell_0}(x)+2w+v_1\\
                    &=\sigma_{\ell_0}(x)+v+2w
                \end{align}
            \end{subequations}
            où dans la dernière ligne, nous avons regroupé \( v_1+v_2=v\). Et voila.
    \end{subproof}
\end{proof}

\begin{corollary}[\cite{MonCerveau}] \label{CORooVYUJooDbkIFY}
    Les rotations vectorielles forment exactement le groupe \( \SO(2)\).
\end{corollary}

\begin{proof}
    Nous savons déjà de la proposition \ref{PROPooTUJWooAjtEnQ} que les rotations (composées de \( 2\) réflexions, par la définition \ref{DEFooFUBYooHGXphm}) sont toutes des applications de \( \SO(2)\).

    Pour l'autre sens, une application de \( \SO(2)\) est une isométrie et est donc, par le théorème \ref{THOooVRNOooAgaVRN} une des choses suivantes : 
    \begin{itemize}
        \item identité
        \item réflexion
        \item translation
        \item réflexion glissée
        \item rotation (composée de réflexions d'axes non parallèles).
    \end{itemize}
    L'identité est possible et c'est une rotation. La réflexion est impossible parce qu'une réflexion linéaire (non affine) est de déterminant \( -1\) (lemme \ref{LEMooSYZYooWDFScw}). Une translation c'est impossible parce que les éléments de \( \SO(2)\) laissent invariant un point alors que les translations ne laissent aucun point invariant.

    Quid des réflexions glissées ? Vue la forme \eqref{EQooVUQDooKuwszl} de la réflexion, la réflexion glissée \( \tau_v\circ \sigma_{\ell}\) a pour formule
    \begin{equation}
        \alpha(x)=(\tau_v\circ\sigma_{\ell})(x)=v+2\pr_{\ell}(x)-x.    
    \end{equation}
    Nous allons étudier les conditions nécessaires pour que cela décrive un élément de \( \SO(2)\), et nous allons voir que c'est impossible.

    D'abord si \( \ell\) passe par l'origine, alors \( \alpha(0)=v\) et nous devons avoir \( v=0\). Dans ce cas \( \alpha=\sigma_{\ell}\), ce qui n'est pas possible parce que \( \alpha\) doit avoir un déterminant \( 1\) alors que la réflexion a un déterminant \( -1\).

    Donc \( \ell\) ne passe pas par l'origine. La condition \( \alpha(0)=0\) impose \( v=-2\pr_{\ell}(0)\). Alors
    \begin{equation}
        \alpha(x)=-2\pr_{\ell}(0)+2\pr_{\ell}(x)-x.
    \end{equation}
    Le calcul de \( \alpha\big( \pr_{\ell}(0) \big)\) donne :
    \begin{equation}
        \alpha\big( \pr_{\ell}(0) \big)=-2\pr_{\ell}(0)+2\pr_{\ell}\big( \pr_{\ell}(0) \big)-\pr_{\ell}(0).
    \end{equation}
    Vu que la projection de la projection est la projection, cela se réduit à
    \begin{equation}
        \alpha\big( \pr_{\ell}(0) \big)=-\pr_{\ell}(0).
    \end{equation}
    Le vecteur \( \pr_{\ell}(0)\) est donc renversé par l'action de \( \alpha\).

    Considérons une base orthonormale \( \{ e_1,e_2 \}\) de \( E\) où \(e_1 \) est un multiple de norme \( 1\) de \( \pr_{\ell}(0)\). Le déterminant de \( \alpha\) pour cette base est\footnote{La définition \ref{DEFooODDFooSNahPb} avec la formule \eqref{EQooOJEXooXUpwfZ}.} :
    \begin{equation}
        \det(\alpha)=\langle e_1, \alpha(e_1)\rangle \langle e_2, \alpha(e_2)\rangle -\langle e_1, \alpha(e_2)\rangle \langle e_2, \alpha(e_1)\rangle.
    \end{equation}
    Là dedans nous avons \( \langle e_1, \alpha(e_1)\rangle =-1\) et \( \langle e_2, \alpha(e_1)\rangle =0\), et le tout doit faire \( 1\). Donc
    \begin{equation}
        \langle e_2, \alpha(e_2)\rangle =-1,
    \end{equation}
    ce qui implique que \( \alpha(e_2)=-e_2\). En particulier \( \alpha=-\id\). Nous avons prouvé jusqu'ici que si \( \alpha\) est une réflexion glissée dans \( \SO(2)\) alors \( \alpha=-\id\). 

    Même pas besoin de se poser de grandes questions sur savoir si il est possible de construire une symétrie glissée égale à \( -\id\) (c'est pas possible), il suffit de dire que de toutes façons, \( -\id\) est tout de même une rotation (lemme \ref{LEMooMIJXooCjiQqP}).
    
    Il reste les rotations. Tout élément de \( \SO(2)\) est une rotation.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Un peu de structure de \texorpdfstring{\( \gO(n)\)}{O(n)}}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Angles orientés, rotations}
%---------------------------------------------------------------------------------------------------------------------------

Nous avons défini les rotations planes en \ref{DEFooFUBYooHGXphm}, et montré que pour les rotations vectorielles, nous avions en réalité le groupe \( \SO(2)\) en le corollaire \ref{CORooVYUJooDbkIFY}. Il est temps de donner une forme matricielle aux rotations et de lier cela aux fonctions trigonométriques.

\begin{lemma}       \label{LEMooAJMAooXPSKtS}
    Si \( A\in \gO(2)\) alors il existe un unique \( \theta\in\mathopen[ 0 , 2\pi \mathclose[\) et un unique \( \epsilon=\pm 1\) tels que
    \begin{equation}
        A=\begin{pmatrix}
            \cos(\theta)    &   -\epsilon\sin(\theta)    \\ 
            \sin(\theta)    &   \epsilon\cos(\theta)    
        \end{pmatrix}
    \end{equation}
\end{lemma}

\begin{proof}
    Soit une matrice \( A=\begin{pmatrix}
        a    &   b    \\ 
        c    &   d    
    \end{pmatrix}\) et imposons qu'elle soit dans \( \gO(2)\). Le fait que \( A\) soit orthogonale impose
    \begin{equation}
        \begin{pmatrix}
            a    &   c    \\ 
            b    &   d    
        \end{pmatrix}\begin{pmatrix}
            a    &   b    \\ 
            c    &   d    
        \end{pmatrix}=\begin{pmatrix}
            a^2+c^2    &   ab+cd    \\ 
            ab+cd    &   b^2+d^2    
        \end{pmatrix}=\begin{pmatrix}
            1    &   0    \\ 
            0    &   1    
        \end{pmatrix}.
    \end{equation}
    Nous avons alors le système
    \begin{subequations}
        \begin{numcases}{}
            a^2+b^2=1\\
            b^2+d^2=1\\
            ab+cd=0
        \end{numcases}
    \end{subequations}
    La proposition \ref{PROPooKSGXooOqGyZj} nous permet de déduire qu'il existe un unique \( \theta\in\mathopen[ 0 , 2\pi \mathclose[\) tel que \( a=\cos(\theta)\), \( c=\sin(\theta)\), ainsi que plusieurs \( \alpha\in \eR\) tel que \( b=\cos(\alpha)\), \( d=\sin(\alpha)\).

        Note : si nous voulons \( \alpha\in\mathopen[ 0 , 2\pi \mathclose[\), alors il y a unicité. Ici nous ne nous attachons pas à cette contrainte; nous savons qu'il en existe plusieurs, et nous allons en fixer un en fonction de \( \theta\). Le \( \alpha\) ainsi fixé ne sera peut-être pas dans \( \mathopen[ 0 , 2\pi \mathclose[\), mais ce ne sera pas grave.

        Les angles \( \theta\) et \( \alpha\) sont alors liés par la contrainte
        \begin{equation}
            \cos(\theta)\cos(\alpha)+\sin(\theta)\sin(\alpha)=0.
        \end{equation}
        Utilisant l'identité \eqref{EQooCVZAooQfocya} cela signifie que \( \cos(\theta-\alpha)=0\). Donc
        \begin{equation}
            \alpha\in\{ \theta+\frac{ \pi }{2}+k\pi \}_{k\in \eZ}.
        \end{equation}
        Si \( k\) est pair, ça donne 
        \begin{subequations}
            \begin{align}
                \cos(\alpha)=-\sin(\theta)\\
                \sin(\alpha)=\cos(\theta)
            \end{align}
        \end{subequations}
        et alors
        \begin{equation}        \label{EQooNAMKooKACIfd}
            A=\begin{pmatrix}
                \cos(\theta)    &   -\sin(\theta)    \\ 
                \sin(\theta)    &   \cos(\theta)    
            \end{pmatrix}.
        \end{equation}
        Si au contraire \( k\) est impair, alors
        \begin{subequations}
            \begin{align}
                \cos(\alpha)=\sin(\theta)\\
                \sin(\alpha)=-\cos(\theta),
            \end{align}
        \end{subequations}
        et
        \begin{equation}        \label{EQooJMYFooGgAiMJ}
            A=\begin{pmatrix}
                \cos(\theta)    &   \sin(\theta)    \\ 
                \sin(\theta)    &   -\cos(\theta)    
            \end{pmatrix}.
        \end{equation}

        Nous avons démontré qu'une matrice de \( \gO(2)\) était forcément d'une des deux formes \eqref{EQooNAMKooKACIfd} ou \eqref{EQooJMYFooGgAiMJ}. Il est maintenant facile de vérifier que ces deux matrices sont effectivement dans \( \gO(2)\).
\end{proof}


\begin{lemma}       \label{LEMooHRESooQTrpMz}
    Toute rotation admet une matrice de la forme (dans la base canonique)
    \begin{equation}
        \begin{pmatrix}
            \cos(\theta)    &   -\sin(\theta)    \\ 
            \sin(\theta)    &   \cos(\theta)    
        \end{pmatrix}
    \end{equation}
    avec \( \theta\in\mathopen[ 0 , 2\pi \mathclose[\).
\end{lemma}

\begin{proof}
    Vu que \( \SO(2)\) est la partie de \( \gO(2)\) constitué des matrices de déterminant \( 1\), nous pouvons reprendre la forme donnée par le lemme \ref{LEMooAJMAooXPSKtS} et fixer \( \epsilon\) par la contrainte sur le déterminant.

    Nous avons, en utilisant la relation du lemme \ref{LEMooAEFPooGSgOkF},
    \begin{equation}
        \det\begin{pmatrix}
            \cos(\theta)    &   -\epsilon\sin(\theta)    \\ 
            \sin(\theta)    &   \epsilon\cos(\theta)    
        \end{pmatrix}=\epsilon,
    \end{equation}
    et donc il faut et suffit de fixer \( \epsilon=1\).
\end{proof}

\begin{proposition}[\cite{ooGEXYooMTrOdH}]      \label{PROPooDWIMooQPkobw}
    Si \( u\) et \( v\) sont des vecteurs unitaires\footnote{De norme \( 1\).} de \( \eR^2\) alors il existe une unique rotation\footnote{Définition \ref{DEFooFUBYooHGXphm}.} \( f\) telle que \( f(u)=v\).
\end{proposition}

\begin{proof}
    C'est la proposition \ref{PROPooNXJKooEDOczh} appliquée à \( O=(0,0)\).
\end{proof}

Notons l'unicité. Nous ne faisons pas de différences entre \( R_{\theta}\) et \( R_{\theta+2\pi}\) et les autres \( R_{\theta+2k\pi}\). En particulier si une rotation \( T\) est donnée, dire «\( T=R_{\theta}\)» ne définit pas un nombre \( \theta\) de façon univoque. Par contre ça définit une classe modulo \( 2\pi\), c'est à dire un élément \( \theta\in \eR/2\pi\).

Nous avons déjà défini le groupe \( \SO(2)\) en la définition \ref{DEFooJLNQooBKTYUy} et nous avons déterminé ses matrices dans \( \eR^2\) en le lemme \ref{LEMooHRESooQTrpMz}. 

La proposition \ref{PROPooDWIMooQPkobw} donne une application
\begin{equation}
    T\colon S^1\times S^1\to \SO(2).
\end{equation}
Et nous avons une relation d'équivalence sur \( S^1\times S^1\) donnée par \( (u,v)\sim(u',v')\) si et seulement si il existe \( g\in\SO(2)\) telle que \( g(u)=u'\) et \( g(v)=v'\). 

\begin{definition}[Angle orienté\cite{ooGEXYooMTrOdH}]      \label{DEFooVBKIooWlHvod}
    Les classes de \( S^1\times S^1\) pour cette relation d'équivalence sont les \defe{angles orientés de vecteurs}{angle!orienté de vecteurs}. Nous notons \( [u,v]\) la classe de \( (u,v)\).
\end{definition}

\begin{proposition}     \label{PROPooIWJQooGQJBWR}
    Nous avons \( T(u,v)=T(u',v')\) si et seulement si \( (u,v)\sim(u',v')\).
\end{proposition}

\begin{proof}
    En utilisant la commutativité du groupe \( \SO(2)\) nous avons équivalence entre les affirmations suivantes :
    \begin{itemize}
        \item \( (u,v)\sim (u',v')\)
        \item \( T(u,u')=T(v',v')\)
        \item \( T(u,u')\circ T(u',v)=T(v,v')\circ T(u',v)\)
        \item
            \( T(u,v)=T(u',v')\).
    \end{itemize}
\end{proof}

\begin{proposition}
    Nous avons une bijection
    \begin{equation}
        \begin{aligned}
            S\colon \frac{ S^1\times S^1 }{ \sim }&\to \SO(2) \\
            [u,v]&\mapsto T(u,v). 
        \end{aligned}
    \end{equation}
\end{proposition}

\begin{proof}
    En plusieurs points.
    \begin{subproof}
    \item[\( S\) est bien définie]
        En effet si \( [u,v]=[z,t]\) alors \( T(u,v)=T(z,t)\).
    \item[Injectif]
        Si \( S[u,v]=S[z,t]\) alors \( T(u,v)=T(z,t)\), qui implique \( (u,v)\sim (z,t)\) par la proposition \ref{PROPooIWJQooGQJBWR}.
    \item[Surjectif]
        Nous avons \( R_{\theta}=T(u,R_{\theta}u)\).
    \end{subproof}
\end{proof}

\begin{definition}[Somme d'angles orientés\cite{ooGEXYooMTrOdH}]
    Si \( [u,v]\) et \( [z,t]\) sont des angles orientés, nous définissons la somme par
    \begin{equation}
        [u,v]+[z,t]=S^{-1}\Big( S[u,v]\circ S[z,t] \Big).
    \end{equation}
\end{definition}

\begin{lemma}       \label{LEMooWISVooYsStJp}
    Quelque propriétés des angles plats liées à la somme.
    \begin{enumerate}
        \item
            \( (S^1\times S^1)/\sim\) est un groupe commutatif.
        \item       \label{ITEMooBKTFooWbEvIU}
            Relations de Chasles :
            \begin{equation}
                [u,v]+[v,w]=[u,w].
            \end{equation}
        \item
            \( -[u,v]=[v,u]\).
    \end{enumerate}
\end{lemma}

\begin{proof}
    Pour la relation de Chasles, ça se base sur la propriété correspondante sur \( T\) :
    \begin{subequations}
        \begin{align}
            [u,v]+[v,w]&=S^{-1}\Big( T(u,v)\circ T(v,w) \Big)\\
            &=S^{-1}\big( T(u,w) \big)\\
            &=[u,w].
        \end{align}
    \end{subequations}
    Pour l'inverse, la vérification est que
    \begin{equation}
        [u,v]+[v,u]=[u,u]=0.
    \end{equation}
\end{proof}

\begin{definition}
    La \defe{mesure}{mesure!angle entre vecteurs} de l'angle orienté \( [u,v]\) est \( [\theta]_{2\pi}\) si \( T[u,v]=R_{\theta}\).
\end{definition}
Notons dans cette définition qu'écrire \( T[u,v]=R_{\theta}\) dans \( \SO(2)\) ne définit pas \( \theta\), mais seulement sa classe modulo \( 2\pi\). C'est pour cela que la mesure de l'angle orienté n'est également définie que modulo \( 2\pi\).

Pour la suite nous allons nous intéresser à des vecteurs qui ont, dans l'idée, un point de départ et un point d'arrivée. Si \( A,B\in \eR^2\) nous notons
\begin{equation}
    \vect{ AB }=\frac{ B-A }{ \| B-A \| }.
\end{equation}
C'est le vecteur unitaire dans la direction «de \( B\) vers $A$».

\begin{theorem}[Théorème de l'angle inscrit\cite{ooRGSCooNgALYH}]       \label{THOooQDNKooTlVmmj}
    Soit un cercle \( \Gamma\) de centre \( O\) et trois points distincts \( A,B,M\in \Gamma\). Alors
    \begin{equation}
        2(\vect{ MA },\vect{ MB })\in (\vect{ OA },\vect{ OB })_{2\pi}
    \end{equation}
    où l'indice \( 2\pi\) indique la classe modulo \( 2\pi\).
\end{theorem}

\begin{proof}
    Le triangle \( MOA\) est isocèle en \( O\), donc les angles à la base sont égaux. Et de plus la somme des angles est dans \( [\pi]_{2\pi}\). Bon, entre nous, nous savons que la somme des angles est exactement \( \pi\), mais comme nous n'avons pas défini les angles autrement que modulo \( \pi\), nous ne pouvons pas dire mieux. Donc
    \begin{equation}
        2(\vect{ AB },\vect{ AO })+(\vect{ OB },\vect{ OA })\in [\pi]_{2\pi}.
    \end{equation}
    Il faut être sûr de l'orientation de tout cela. Le nombre \( (\vect{ AB },\vect{ AO })\) est l'angle qui sert à amener \( \vect{ AB }\) sur \( \vect{ AO }\). Vu que nous l'avons choisit dans le sens trigonométrique, il faut bien prendre les autres dans le sens trigonométrique et utiliser \( (\vect{ OA }, \vect{ OB })\) et non \( (\vect{ OB },\vect{ OA })\).

\begin{center}
   \input{auto/pictures_tex/Fig_YQIDooBqpAdbIM.pstricks}
\end{center}

De la même manière sur le triangle \( MOB\) nous écrivons
\begin{equation}
    2(\vect{ MB },\vect{ MO })+(\vect{ OM },\vect{ OB })\in[\pi]_{2\pi}.
\end{equation}
Nous faisons la différence entre les deux équations en nous souvenant que \( -(\vect{ MB },\vect{ MO })=(\vect{ MO },\vect{ MB })\) et les relations de Chasles du lemme \ref{LEMooWISVooYsStJp}\ref{ITEMooBKTFooWbEvIU} nous avons :
\begin{equation}
    2(\vect{ MA },\vect{ MB })+(\vect{ OB },\vect{ OA })\in[0]_{2\pi}.
\end{equation}
\end{proof}

\begin{normaltext}
    Comment exprimer le fait qu'un angle orienté soit égal à \( \theta\) modulo \( \pi\) alors que les angles orientés sont des classes modulo \( 2\pi\) ? Nous ne pouvons certainement pas écrire
    \begin{equation}
        (u,v)=[\theta]_{\pi}
    \end{equation}
    parce que \( (u,v)\) est un élément de \( S^1\times S^1\) alors que \( [\theta]_{\pi}\) est un ensemble de nombres. Nous pouvons écrire
    \begin{equation}
        [u,v]\subset [\theta]_{\pi}.
    \end{equation}
    C'est cohérent parce que nous avons des deux côtés des ensembles de nombres. Les opérations permises sont l'égalité ou l'inclusion. L'égalité entre les deux ensembles n'est pas possible parce que la différence minimale ente deux éléments dans \( [u,v]\) est \( 2\pi\) alors que celle dans \( [\theta]_{\pi}\) est \( \pi\).

    Si \( u\) et \( v\) forment un angle droit, nous avons
    \begin{equation}
        [u,v]=\{ \frac{ \pi }{2}+2k\pi \}_{k\in \eZ}.
    \end{equation}
    Et cela est bien un sous-ensemble de \( [\pi/2]_{\pi}\).

    Pour exprimer que la différence entre deux angles orientés diffèrent de \( \pi\) nous devrions écrire :
    \begin{equation}
        [u,v]\subset[a,b]_{\pi}
    \end{equation}
    où le membre de droite signifie la classe modulo \( \pi\) d'un représentant de \( [a,b]\). 

    Nous allons cependant nous permettre d'écrire
    \begin{equation}
        [u,v]=[a,b]_{\pi}
    \end{equation}
    voire carrément
    \begin{equation}
        (u,v)=(a,b)_{\pi}.
    \end{equation}
    Cette dernière égalité devant être comprise comme voulant dire que l'angle pour passer de \( u\) à \( v\) est soit le même que celui pour alle de \( a\) à \( b\) soit ce dernier plus \( \pi\).
\end{normaltext}

\begin{theorem}[\cite{ooRGSCooNgALYH}]      \label{THOooUDUGooTJKDpO}
    Soient \( 4\) points distincts du plan \( A,B,C,D\). Ils sont alignés ou cocycliques\footnote{C'est à dire sur un même cercle.} si et seulement si
    \begin{equation}
        (\vect{ CA },\vect{ CB })=(\vect{ DA },\vect{ DB })_{\pi}.
    \end{equation}
\end{theorem}

Nous allons seulement démontrer l'implication directe.
\begin{proof}
    Si les quatre points sont alignés nous avons \( [\vect{ CA },\vect{ CB }]=[0]_{2\pi}\) et \( [\vect{ DA },\vect{ DB }]=[0]_{2\pi}\). En particulier nous avons
    \begin{equation}
        [\vect{ CA },\vect{ CB }]=[\vect{ DA },\vect{ DB }]
    \end{equation}
    et a fortiori l'égalité modulo \( \pi\) au lieu de \( 2\pi\).

    Nous nous relâchons en termes de notations. Si les quatre points sont cocycliques, nous pouvons utiliser le théorème de l'angle inscrit \ref{THOooQDNKooTlVmmj} dans les triangles \( ABC\) et \( ADB\) :
    \begin{subequations}
        \begin{align}
            2(\vect{ CA },\vect{ CB })=(\vect{ OA },\vect{ OB })_{2\pi}\\
            2(\vect{ DA },\vect{ DB })=(\vect{ OA },\vect{ OB })_{2\pi},
        \end{align}
    \end{subequations}
    ce qui donne \(  2(\vect{ CA },\vect{ CB })=2(\vect{ DA },\vect{ DB })_{2\pi}  \) et donc
    \begin{equation}
        (\vect{ CA },\vect{ CB })=(\vect{ DA },\vect{ DB })_{\pi}.
    \end{equation}

    Comme annoncé, nous ne faisons pas la preuve dans l'autre sens; elle peut être trouvée dans~\cite{ooRGSCooNgALYH}.
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Angles et nombres complexes}
%---------------------------------------------------------------------------------------------------------------------------
\label{SUBSECooKNUVooUBKaWm}

Les nombres complexes peuvent être repérés par une norme et un angle, ce qui en fait un terrain propice à l'utilisation des angles orientés. Nous en ferons d'ailleurs usage dans \( \hat\eC=\eC\cup\{ \infty \}\) pour parler d'alignement, de cocyclicité et de birapport dans la proposition \ref{PROPooSGCJooLnOLCx}.

Soient deux éléments \( z_1,z_2\in \eC\). Nous les écrivons sous la forme \( z_1=r_1 e^{i\theta_1}\) et \( z_2=r_2 e^{i\theta_2}\); remarquons que cela ne définit \( \theta_i\) qu'à \( 2\pi\) près. Nous avons
\begin{equation}
    [z_1,z_2]=[\theta_2-\theta_1]_{2\pi}.
\end{equation}

Soient maintenant \( a,b,c,d\in \eC\). Nous écrivons \( \vect{ ab }\) le vecteur unitaire dans le sens «de \( a\) vers \( b\)», c'est à dire un multiple positif bien choisi du nombre \( b-a\). Nous notons \( \theta_{ab}\) l'argument du nombre complexe \( b-a\), et nous avons encore
\begin{equation}
    [\vect{ ab },\vect{ cd }]=[\theta_{ab}-\theta_{cd}].
\end{equation}

Avec toutes ces notations, ce qui est bien est que les produits et quotients de nombres complexes se comportent très bien par rapport aux angles : l'argument de \( a/b\) est \( \theta_a-\theta_b\) et en particulier l'argument de 
\begin{equation}
    \frac{ a-b }{ c-d }
\end{equation}
est dans la classe de l'angle orienté
\begin{equation}
    [\vect{ ba },\vect{ dc }].
\end{equation}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Valeurs propres dans \( \gO(n)\)}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[\cite{ooPWOHooHwgPzO}]      \label{PROPooVEJGooWnqtMm}
    Soit une matrice \( A\in O(n)\). Si \( \lambda\in \eC\) est une valeur propre de \( A\), alors \( \bar\lambda\) est également une valeur propre de \( A\), et de plus \( | \lambda |=1\).
\end{proposition}

\begin{proof}
    Dire que \( \lambda\in \eC\) est une valeur propre de \( A\) signifie qu'il exist \( x\in \eC^n\) (non nul) tel que \( Ax=\lambda x\). Vu que les éléments de la matrice \( A\) sont réels,
    \begin{equation}
        A\bar x=\bar A\bar x=\overline{ Ax }=\overline{ \lambda x }=\bar \lambda\bar x.
    \end{equation}
    Donc \( \bar \lambda\) est une valeur propre de \( A\) pour le vecteur propre \( \bar x\).

    Soit \( \lambda\)  une valeur propre de \( A\) de vecteur propre \( x\). Alors nous avons d'une part
    \begin{equation}
        \langle \overline{ Ax }, Ax\rangle =\langle A^tA\bar x, x\rangle =\langle x, \bar x\rangle ,
    \end{equation}
    et d'autre part
    \begin{equation}
        \langle \overline{ Ax }, Ax\rangle =\langle \bar \lambda \bar x, \lambda x\rangle =| \lambda |^2\langle \bar x, x\rangle .
    \end{equation}
    Vu que \( x\neq 0\) nous avons aussi \( \langle \bar x, x\rangle \neq 0\). Par conséquent \( | \lambda |^2=1\) et \( | \lambda |=1\).
\end{proof}

\begin{lemma}[\cite{ooPWOHooHwgPzO}]        \label{LEMooNEDQooNRmASH}
    Soit un espace vectoriel euclidien \( E\) de dimension finie et une isométrie \( f\) de \( E\). Soit \( F\) un sous-espace de \( E\) stable par \( f\). Alors \( F^{\perp}\) est stable par \( f\).
\end{lemma}

\begin{proof}
    La restriction \( f_F\colon F\to F\) est encore une isométrie; elle est donc inversible : pour tout $y\in F$, il existe \( x\in F\) tel que \( y=f(x)\). Soit \( a\in F^{\perp}\); nous montrons que \( f(a)\in F^{\perp}\). Soit donc \( y\in F\) et calculons :
    \begin{equation}
        \langle y, f(a)\rangle =\langle f(x), f(a)\rangle =\langle x,a, \rangle =0
    \end{equation}
    parce que \( x\in F^{\perp}\).
\end{proof}

\begin{proposition}[\cite{ooPWOHooHwgPzO}]      \label{PROPooOMORooWzsrDB}
    Soit une isométrie \( f\colon \eR^3\to \eR^3\).
    \begin{enumerate}
        \item
            L'application linéaire \( f\) possède au moins une valeur propre réelle qui vaut \( \pm 1\).
        \item
            Il existe une base orthonormée de \( \eR^3\) dans laquelle la matrice de \( f\) est de la forme
            \begin{equation}
                \begin{pmatrix}
                    \lambda    &   0    &   0    \\
                    0    &   \cos(\theta)    &   -\epsilon\cos(\theta)    \\
                    0    &   \sin(\theta)    &   \epsilon\cos(\theta)
                \end{pmatrix}
            \end{equation}
            avec \( \epsilon,\lambda=\pm 1\) et \( \theta\in \mathopen[ 0 , 2\pi \mathclose[\).
    \end{enumerate}
\end{proposition}

\begin{proof}
    Le polynôme caractéristique de \( f\), donné par \( \det(f-\lambda\id)\), est à coefficients réels et de degré \( 3\). Il possède dont au moins une solution réelle par le corollaire \ref{CORooKKNWooWEQukb}. Soit donc une valeur propre réelle \( \lambda\) de \( \chi_f\); par le lemme \ref{PROPooVEJGooWnqtMm} nous avons \( \lambda=\pm 1\). Soit \( u_1\) le vecteur propre correspondant. Nous notons \( F\) l'espace engendré par \( u_1\).

    Nous avons \( f(F)=F\) et donc \( f(F^{\perp})=F^{\perp}\) par le lemme \ref{LEMooNEDQooNRmASH}. Soit une base orthonormée \( \{ u_2,u_3 \}\) de \( F^{\perp}\) et la matrice \( B\) de la restriction \( f_{p}\) à \( F^{\perp}\). Vu que l'application \( f_p\) est une isométrie de \( F^{\perp}\), la matrice \( B\) est, par le lemme \ref{LEMooAJMAooXPSKtS}, de la forme
    \begin{equation}
        B=\begin{pmatrix}
            \cos(\theta)    &   -\epsilon\sin(\theta)    \\ 
            \sin(\theta)    &   \epsilon\cos(\theta)    
        \end{pmatrix}
    \end{equation}
    pour un certain \( \theta\in\mathopen[ 0 , 2\pi \mathclose[\) et \( \epsilon=\pm 1\).

    Dans la base \( \{u_1,u_2,u_3\}\) de \( \eR^3\), la matrice de \( f\) est alors
    \begin{equation}
        \begin{pmatrix}
            \lambda    &   0    \\ 
            0    &   B    
        \end{pmatrix},
    \end{equation}
    comme annoncé.
\end{proof}

Pour classifier les isométries de \( \eR^3\), nous pouvons nous baser sur les possibilités de la matrice donne dans le lemme \ref{PROPooOMORooWzsrDB}. Il y a essentiellement quatre possibilités suivant les valeurs de \( \lambda=\pm 1\) et \( \epsilon=\pm 1\).

\begin{subproof}
    \item[Si \( \epsilon=\lambda=1\)] Alors la matrice est
    \begin{equation}
        A=\begin{pmatrix}
            1    &   0    &   0    \\
            0    &   \cos(\theta)    &   -\sin(\theta)    \\
            0    &   \sin(\theta)    &   \cos(\theta)
        \end{pmatrix}
    \end{equation}
    et l'isométrie correspondante est la rotation d'angle \( -\theta\) autour de la droite de \( u_1\).

    \item[Si \( \epsilon=\lambda=-1\)]
    Alors la matrice est
    \begin{equation}
        A=\begin{pmatrix}
            -1    &  0     &   0    \\
            0    &   \cos(\theta)    &   \sin(\theta)    \\
            0    &   \sin(\theta)    &   -\cos(\theta)
        \end{pmatrix}
    \end{equation}
    Cette application est plus subtile, parce que même dans le plan \( \Span(u_2,u_3)\), ce n'est pas une rotation. Nous allons montrer qu'il s'agit d'une réflexion autour de la droite d'angle \( \theta/2\) dans le plan \( \Span(u_2,u_3)\). Nous nommons \( D\) cette droite. Dans la base \( \{ u_1,u_2,u_3 \}\), les points de cette droite sont de la forme\footnote{Les plus acharnés remarquerons que \( \{ u_1,u_2,u_3 \}\) est un ensemble, qui est une base. Mais un ensemble n'est pas ordonné, alors que pour écrire l'équation de droite qui suit, nous supposons un ordre. Je laisse au tel lecteur le soin de trouver une bonne notation.}
    \begin{equation}
        \big( 0,\cos(\theta/2),\sin(\theta/2) \big).
    \end{equation}
    
    L'image de \( u_1\) par cette réflexion est \(-u_1\), c'est clair.

    Faisons en détail l'image de \( u_3\). Nous devons démontrer que la droite \( D\) coupe le segment \( \mathopen[ u_3 , A(u_3) \mathclose]\) perpendiculairement en son milieu.
    
    Dans le plan \( \Span(u_2,u_3)\) nous avons \( u_3=\begin{pmatrix}
        0    \\ 
        1    
    \end{pmatrix}\) et \( A(u_3)=\begin{pmatrix}
        \sin(\theta)    \\ 
        \cos(\theta)    
    \end{pmatrix}\). Le milieu du segment \( \mathopen[ u_3 , A(u_3) \mathclose]\) est le point
    \begin{equation}
        M=\left( \frac{ \sin(\theta) }{2},\frac{ 1-\cos(\theta) }{2} \right).
    \end{equation}
    Les formules de duplication d'angle du corollaire \ref{CORooQZDQooWjMXTF} nous permettent d'écrire \( \sin(\theta)\) et \( \cos(\theta)\) en fonction de \( \sin(\theta/2)\) et \( \cos(\theta/2)\), et donc d'exprimer le point \( M\) de la façon suivante :
    \begin{subequations}
        \begin{align}
            M&=\left( \cos(\theta/2)\sin(\theta/2),\frac{ 1-\big( \cos^2(\theta/2)-\sin^2(\theta/2) \big) }{2} \right)\\
            &=\big( \cos(\theta/2)\sin(\theta/2),\sin^2(\theta/2) \big)\\
            &=\sin(\theta/2)\big( \cos(\theta/2),\sin(\theta/2) \big).
        \end{align}
    \end{subequations}
    Ce point fait donc partie de la droite \( D\). La droite \( D\) coupe le segment \( \mathopen[ u_3 , A(u_3) \mathclose]\) en son milieu.

    En ce qui concerne l'orthogonalité, nous calculons le produit scalaire
    \begin{equation}
            \big( A(u_3)-u_3 \big)\cdot\begin{pmatrix}
                \cos(\theta/2)    \\ 
                \sin(\theta/2)    
            \end{pmatrix}
            =\sin(\theta)\cos(\theta/2)-\big( 1+\cos(\theta) \big)\sin(\theta/2)=0
    \end{equation}
    où nous avons encore utilisé les duplications d'angles et le fait que \( 1=\cos^2(\theta/2)+\sin^2(\theta/2)\) (lemme \ref{LEMooAEFPooGSgOkF}).

    \item[Si \( \epsilon=-1\) et \( \lambda=1\)] Alors la matrice est
        \begin{equation}
            A=\begin{pmatrix}
                1    &   0    &   0    \\
                0    &   \cos(\theta)    &   \sin(\theta)    \\
                0    &   \sin(\theta)    &   -\cos(\theta)
            \end{pmatrix}.
        \end{equation}
        C'est la symétrie orthogonale par le plan engendré par \( u_1\) et \( v=\cos(\theta/2)u_2+\sin(\theta/2)u_3\).

        Le vecteur \( u_1\) est bien évidemment préservé par \( A\). En ce qui concerne le vecteur \( v\),
        \begin{equation}
            A(v)=\cos(\theta/2)\begin{pmatrix}
                0    \\ 
                \cos(\theta)    \\ 
                \sin(\theta)    
            \end{pmatrix}+\sin(\theta/2)\begin{pmatrix}
                0    \\ 
                -\sin(\theta)    \\ 
                \cos(\theta)    
            \end{pmatrix}=
            \begin{pmatrix}
                0    \\ 
                \cos(\theta/2)    \\ 
                \sin(\theta/2)    
            \end{pmatrix}=v.
        \end{equation}
        Nous avons sauté quelque étapes de calcul mettant en scène les formules de duplication d'angle : exprimer \( \cos(\theta)=\cos^2(\theta/2)-\sin^2(\theta/2)\) et \( \sin(\theta)=2\cos(\theta/2)\sin(\theta/2)\).

        Pour achever, nous devons trouver un vecteur \( w\) perpendiculaire au plan, et montrer qu'il est envoyé par \( A\) sur \( -w\). Un vecteur \( w=xu_1+yu_2+zu_3\) est perpendiculaire au plan si les deux égalités suivantes sont satisfaites :
        \begin{subequations}
            \begin{align}
                \big( \cos(\theta/2)u_2+\sin(\theta/2)u_3 \big)\cdot (xu_1+yu_2+zu_3)=0\\
                u_1\cdot(xu_1+yu_2+zu_3)=0.
            \end{align}
        \end{subequations}
        Nous avons immédiatement \( x=0\) et ensuite la relation
        \begin{equation}        \label{EQooXQMDooTvwrWk}
            y\cos(\theta/2)+z\sin(\theta/2)=0.
        \end{equation}
        En ne regardant que les deux dernières composantes pour alléger l'écriture,
        \begin{equation}
            A(w)=y\begin{pmatrix}
                \cos(\theta)    \\ 
                \sin(\theta)    
            \end{pmatrix}+z\begin{pmatrix}
                \sin(\theta)    \\ 
                -\cos(\theta)    
            \end{pmatrix}.
        \end{equation}
        Le but est de montrer que cela est égal à \( -y\cos(\theta/2)-z\sin(\theta/2)\).

        Notons \( c=\cos(\theta/2)\) et \( s=\sin(\theta/2)\). Alors \( A(w)_2=y(c^2-s^2)+2zcs\). Évacuons tout de suite les deux cas limite : si \( c=0\) alors \( A(w)_2=-y\) (parce que \( s=\pm1\)) et c'est bon. Si \( s=0\), alors \( A(w)_2=y\), mais la relation \eqref{EQooXQMDooTvwrWk} donne \( y=0\), donc c'est bon aussi. Dans la cas générique, \( z=-yc/2\) et
        \begin{equation}
            A(w)_2=y(c^2-s^2)-2cs\frac{ yc }{ s }=-y(c^2+s^2)=-y.
        \end{equation}

        En ce qui concerne \( A(w)_3\), c'est très similaire :
        \begin{equation}
            A(w)_3=2ysc-z(c^2-s^2).
        \end{equation}
        Avec \( z=0\) c'est \( -z\), donc c'est bon. Avec \( c=0\) c'est \( z\) mais \( z=0\). Et pour le cas générique, la substitution \( y=-zs/c\) donne le résultat.
        

    \item[Si \( \epsilon=1\) et \( \lambda=-1\)] Alors la matrice est
        \begin{equation}
            A=\begin{pmatrix}
                -1    &   0    &   0    \\
                0    &   \cos(\theta)    &   -\sin(\theta)    \\
                0    &   \sin(\theta)    &   \cos(\theta)
            \end{pmatrix}.
        \end{equation}
        Cela est la composition entre la symétrie de plan \( \Span(u_2,u_3)\) et la rotation d'angle \( \theta\) dans ce plan.
\end{subproof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Sous-groupes finis de \( \SO(3)\)}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[\cite{ooYODPooHeNKiQ}]
    Les sous-groupes finis de \( \SO(3)\) sont :
    \begin{multicols}{2}
        \begin{enumerate}
            \item
                les groupes cycliques \( \eZ/n\eZ\),
            \item
                les groupes diédraux \( D_n\),
            \item
                le groupe alterné \( A_4\),
            \item
                le groupe alterné \( A_5\)
            \item
                le groups symétrique \( S_4\).
        \end{enumerate}
    \end{multicols}
\end{proposition}

\begin{proof}
    Soit \( G\), un sous-groupe fini de \( \SO(3)\). Par la proposition \ref{PropKBCXooOuEZcS}, les éléments de \( G\) sont des isométries de \( \eR^3\). Le polynôme caractéristique d'une élément de \( G\) est de degré trois et possède dont (en comptant les multiplicités) trois racines
\end{proof}
<++>

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Coordonnées polaires}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Les coordonnées polaires}
%---------------------------------------------------------------------------------------------------------------------------

On a vu qu'un point $M$ dans $\eR^2$ peut être représenté par ses abscisses $x$ et ses ordonnées $y$. Nous pouvons également déterminer le même point $M$ en donnant un angle et une distance comme montré sur la figure \ref{LabelFigJWINooSfKCeA}.
\newcommand{\CaptionFigJWINooSfKCeA}{Un point en coordonnées polaires est donné par sa distance à l'origine et par l'angle qu'il faut avec l'horizontale.}
\input{auto/pictures_tex/Fig_JWINooSfKCeA.pstricks}


Le même point $M$ peut être décrit indifféremment avec les coordonnées $(x,y)$ ou bien avec $(r,\theta)$.

\begin{remark}
	L'angle $\theta$ d'un point n'étant a priori défini qu'à un multiple de $2\pi$ près, nous convenons de toujours choisir un angle $0\leq\theta<2\pi$. Par ailleurs l'angle $\theta$ n'est pas défini si $(x,y)=(0,0)$.

	La coordonnée $r$ est toujours positive.
\end{remark}

En utilisant la trigonométrie, il est facile de trouver le changement de variable qui donne $(x,y)$ en fonction de $(r,\theta)$:
\begin{subequations}		\label{EqrthetaxyPoal}
	\begin{numcases}{}
		x=r\cos(\theta)\\
		y=r\sin(\theta).
	\end{numcases}
\end{subequations}

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Transformation inverse : théorie}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Voyons la question inverse : comment retrouver $r$ et $\theta$ si on connait $x$ et $y$ ? Tout d'abord,
\begin{equation}
	r=\sqrt{x^2+y^2}
\end{equation}
parce que la coordonnée $r$ est la distance entre l'origine et $(x,y)$. Comment trouver l'angle ? Nous supposons $(x,y)\neq (0,0)$. Si $x=0$, alors le point est sur l'axe vertical et nous avons
\begin{equation}
	\theta=\begin{cases}
		\pi/2	&	\text{si }y>0\\
		3\pi/2	&	 \text{si }y<0
	\end{cases}
\end{equation}
Notez que si $y<0$, conformément à notre convention $\theta\geq 0$, nous avons noté $\frac{ 3\pi }{2}$ et non $-\frac{ \pi }{ 2 }$.

Supposons maintenant le cas général avec $x\neq 0$. Les équations \eqref{EqrthetaxyPoal} montrent que
\begin{equation}
	\tan(\theta)=\frac{ y }{ x }.
\end{equation}
Nous avons donc
\begin{equation}
	\theta=\tan^{-1}\left( \frac{ y }{ x } \right).
\end{equation}
La fonction inverse de la fonction tangente est celle définie plus haut.

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Transformation inverse : pratique}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Le code suivant utilise \href{http://www.sagemath.org}{Sage}.

\lstinputlisting{tex/frido/calculAngle.py}

Son exécution retourne :
\begin{verbatim}
(sqrt(2), 1/4*pi)
(sqrt(5), pi - arctan(1/2))
(6, 1/6*pi)
\end{verbatim}
Notez que ce sont des valeurs \emph{exactes}. Ce ne sont pas des approximations, Sage travaille de façon symbolique.

Voici un tableau qui rappelle les valeurs à retenir pour les fonctions sinus, cosinus et tangente.\label{PGooIMQFooTnBdIl}
\begin{equation*}
    \begin{array}[]{|c|c|c|c|}
      \hline
      x&\sin(x)&\cos(x)&\tan(x)\\
      \hline
      0&0&1&0\\
      \hline
      \pi/6&1/2&\sqrt{3}/2&\sqrt{3}/3\\
      \hline
      \pi/6&1/2&\sqrt{3}/2&\sqrt{3}/3\\
      \hline
      \pi/4&\sqrt{2}/2&\sqrt{2}/2&1\\
      \hline
      \pi/3&\sqrt{3}/2&1/2&\sqrt{3}\\
      \hline
      \pi/2&1&0&\text{N.D.}\\
      \hline
    \end{array}
\end{equation*}
où «N.D.»  signifie «non défini».

Rappelons le graphe de la fonction sinus :
\begin{center}
   \input{auto/pictures_tex/Fig_TWHooJjXEtS.pstricks}
\end{center}
celui de la fonction cosinus :
\begin{center}
   \input{auto/pictures_tex/Fig_JJAooWpimYW.pstricks}
\end{center}


\begin{lemma}
  Pour toute valeur de $x\in \eR$ on a $|\sin(x)|\leq |x|$. 
\end{lemma}

\begin{proof}
        Nous séparons des cas en fonction des valeurs.
    \begin{itemize}
    \item Si $0\leq x\leq \pi/2$ alors le sinus de $x$ est la longueur du cathète verticale du triangle rectangle de sommets $O = (0,0)$, $A = (\cos(x), \sin(x))$ et $B = (\cos(x), 0)$. Le triangle de sommets $A$, $B$ et $C = (1, 0)$ est aussi rectangle et nous savons que chacun des cathètes ne peut pas être plus long que l'hypoténuse. Donc $\sin(x)$ est inférieur à la longueur du segment $AC$. À son tour le segment $AC$ ne peut pas être plus long que l'arc de cercle $\wideparen{A0C}$, car le chemin le plus court entre deux points du plan est toujours donné par un morceau de droite. La longueur de l'arc de cercle $\frown{AC}$ est \emph{par définition} la mesure en radiants de l'angle $\widehat{AOC}$, qui est $x$ et on a l'inégalité $\sin(x)\leq x$. 
    \item Si $-\pi/2\leq x\leq 0$ le m\^eme raisonnement que au point précédent permet de conclure que $\sin(x)\leq |x|$.
    \item Nous savons par ailleurs que la fonction sinus prend ses valeurs dans l'intervalle $[-1,1]$ et donc pour tout $x$ tel que $|x|\geq \pi/2 \equiv 1,57\ldots$ on a forcement $|\sin(x)|\leq |x|$.  
    \end{itemize}
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Coordonnées polaires comme changement de variables pour intégrales}
%---------------------------------------------------------------------------------------------------------------------------
\label{SUBSECooUUAKooMSJHsL}

Le théorème \ref{THOooUMIWooZUtUSg} manque un peu d'exemples. Nous allons en voir quelque uns maintenant.

\begin{example} 
\textbf{Coordonnées polaires : }On veut évaluer l'intégrale de la fonction $f(x,y)= x^2+y^2$ sur la région $V$ suivante :
\[
V=\{(x,y) \in \eR^2\,\vert\, x^2+y^2\leq 1,\, x>0,\, y>0\}.
\]
On peut faire le calcul directement,
\[
\int_{V}f(x,y)\, dV=\int_0^1\int_0^{\sqrt{1-x^2}}x^2+y^2\, dy\,dx=\int_0^1x^2\sqrt{1-x^2} + \frac{(1-x^2)^{3/2}}{3}\, dx  
\] 
mais c'est un peu ennuyeux. On peut simplifier beaucoup les calculs avec un changement de variables vers les coordonnées polaires. Dans ce cas, on sait bien que le difféomorphisme à utiliser est $\phi(r,\theta)=(r\cos \theta, r\sin\theta)$. Le jacobien  $J_{\phi}$ est
\begin{equation}
 J_{\phi}(r, \theta)= \left\vert\begin{array}{cc}
\cos \theta & \sin \theta \\
-r\sin \theta  & r\cos \theta
\end{array}\right\vert= r,
\end{equation}
qui est toujours positif. La fonction $f$ peut s'écrire comme $f(\phi(r,\theta))=r^2$ et $\phi^{-1}(V)=]0,1]\times]0, \pi/2[$.  
La formule du changement de variables nous donne
\[
\int_{V}f(x,y)\, dV=\int_0^{\pi/2}\int_0^{1}r^3 dr\,d\theta=\int_0^{\pi/2}\frac{1}{4}\,d\theta=\frac{\pi}{8}.  
\] 
\end{example}

\begin{example}
\textbf{Coordonnées cylindriques : }On veut calculer le volume de la région $A$ définie par  l'intersection entre la boule unité et le cylindre qui a pour base un disque de rayon $1/2$ centré en $(0, 1/2)$
\[
A=\{(x,y,z) \in\eR^3 \,\vert\, x^2+y^2+z^1\leq 1\}\cap\{(x,y,z) \in \eR^3\,\vert\, x^2+(y-1/2)^2\leq 1/4\}.
\]
On peut décrire $A$ en coordonnées cylindriques
\begin{equation}
  \begin{aligned}
    A=\Big\{(r,\theta,z) &\in ]0, +\infty[\times [-\pi,\pi[\times \eR\,\vert\,\\
& -\pi/2<\theta<\pi, \, 0<r\leq \sin\theta, \, -\sqrt{1-r^2}\leq z\leq\sqrt{1-r^2} \Big\}.
  \end{aligned}
\end{equation}
Le jacobien de ce changement de variables,  $J_{cyl}$, est
\begin{equation}
 J_{cyl}(r, \theta), z= \left\vert\begin{array}{ccc}
\cos \theta & \sin \theta & 0\\
-r\sin \theta  & r\cos \theta &0 \\
0&0&
\end{array}\right\vert= r,
\end{equation}
qui est toujours positif. Le volume de $A$ est donc
\[
\int_{\eR^3}\chi_{A}(x,y,z)\, dV=\int_{-\pi/2}^{\pi/2}\int_0^{\sin\theta}\int_{-\sqrt{1-r^2}}^{\sqrt{1-r^2}} r dz\,dr\,d\theta=\frac{2\pi}{8}+\frac{8}{9}.  
\] 
\end{example}

\begin{example}
\textbf{Volume d'un solide de révolution : }Soit $g:[a,b]\to\eR_+$ une fonction continue et positive. On dit que le solide $A$ décrit par
\[
A=\left\{(x,y,z)\in\eR^3\, \vert \, z\in[a,b], \,\sqrt{x^2+y^2}\leq g^2(z) \right\}
\]
est un solide de révolution. Afin de calculer son volume, on peut décrire $A$ en coordonnées cylindriques, 
\[
A=\left\{(r,\theta,z) \in ]0, +\infty[\times [-\pi,\pi[\times \eR\,\vert\, a\leq z\leq b, \, 0<r^2\leq g^2(z) \right\}.
\]
Le jacobien de ce changement de variables est  $J_{cyl}=r$, comme dans l'exemple précédent. Le volume de $A$ est donc
\[
\int_{\eR^3}\chi_{A}(x,y,z)\, dV=\int_a^{b}\int_{-\pi}^{\pi}\int_{0}^{g(z)} r  \,dr\,d\theta\, dz=\int_a^{b} \pi g^2(z) \, dz.
\] 
Cette formule peut être utilisée pour tout solide de révolution. 
\end{example}

\begin{example}
\textbf{Coordonnées sphériques : }On veut calculer le volume du cornet de glace  $A$ 
\[
A=\left\{(x,y,z)\in\eR^3\, \vert \, (x,y)\in \mathbb{S}^2, \,\sqrt{x^2+y^2}\leq z\leq \sqrt{1-x^2-y^2} \right\}. 
\]
On peut décrire $A$ en coordonnées sphériques. 
\[
A=\{(\rho,\theta,\phi) \in ]0, +\infty[\times [-\pi,\pi[\times [0,\pi[\,\vert\, 0<\phi\leq\pi/4, \, 0<\rho\leq 1 \}.
\]
Le jacobien de ce changement de variables  $J_{sph}$ est
\begin{equation}
 J_{sph}(\rho, \theta, \phi)= \left\vert\begin{array}{ccc}
\cos \theta \sin\phi & \sin \theta\sin\phi & \cos\phi\\
-\rho\sin \theta\sin\phi  & \rho\cos \theta\sin\phi & 0 \\
\rho\cos\theta\cos\phi&\rho\sin\theta\cos\phi& -\rho\sin\phi
\end{array}\right\vert= \rho^2\sin\phi,
\end{equation}
Le volume de $A$ est donc
\[
\int_{\eR^3}\chi_{A}(x,y,z)\, dV=\int_{-\pi}^{\pi}\int_0^{\pi/4}\int_{0}^{1}\rho^2\sin\phi \,d\rho\,d\phi\,d\theta=\frac{2\pi}{3}\left(1-\frac{1}{\sqrt{2}}\right).  
\] 
\end{example}

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Changement de variables}
%---------------------------------------------------------------------------------------------------------------------------

Le domaine $E=\{ (x,y)\in\eR^2\tq x^2+y^2<1 \}$ s'écrit plus facilement $E=\{ (r,\theta)\tq r<1 \}$ en coordonnées polaires. Le passage aux coordonnées polaire permet de transformer une intégration sur un domaine rond à une intégration sur le domaine rectangulaire $\mathopen]0,2\pi\mathclose[\times\mathopen]0,1\mathclose[$. La question est évidement de savoir si nous pouvons écrire
\begin{equation}
	\int_Ef=\int_{0}^{2\pi}\int_0^1f(r\cos\theta,r\sin\theta)drd\theta.
\end{equation}
Hélas, non; la vie n'est pas aussi simple.

\begin{theorem}
Soit $g\colon A\to B$ un difféomorphisme. Soient $F\subset B$ un ensemble mesurable et borné et $f\colon F\to \eR$ une fonction bornée et intégrable. Supposons que $g^{-1}(F)$ soit borné et que $Jg$ soit borné sur $g^{-1}(F)$. Alors
\begin{equation}
	\int_Ff(x)dy=\int_{g^{-1}(F)f\big( g(x) \big)}| Jg(x) |dx
\end{equation}
\end{theorem}
Pour rappel, $Jg$ est le déterminant de la matrice \href{http://fr.wikipedia.org/wiki/Matrice_jacobienne}{jacobienne} (aucun lien de \href{http://fr.wikipedia.org/wiki/Jacob}{parenté}) donnée par
\begin{equation}
	Jg=\det\begin{pmatrix}
	\partial_xg_1	&	\partial_yg_1	\\ 
	\partial_xg_2	&	\partial_tg_2	
\end{pmatrix}.
\end{equation}
Un \defe{difféomorphisme}{difféomorphisme} est une application $g\colon A\to B$ telle que $g$ et $g^{-1}\colon B\to A$ soient de classe $C^1$.

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
					\subsubsection{Coordonnées polaires}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Les coordonnées polaires sont données par le difféomorphisme
\begin{equation}
	\begin{aligned}
		g\colon \mathopen]0,\infty\mathclose[\times\mathopen]0,2\pi\mathclose[ &\to\eR^2\setminus D\\
		(r,\theta)&\mapsto \big( r\cos(\theta),r\sin(\theta) \big)
	\end{aligned}
\end{equation}
où $D$ est la demi droite $y=0$, $x\geq 0$. Le fait que les coordonnées polaires ne soient pas un difféomorphisme sur tout $\eR^2$ n'est pas un problème pour l'intégration parce que le manque de difféomorphisme est de mesure nulle dans $\eR^2$. Le jacobien est donné par
\begin{equation}
	Jg=\det\begin{pmatrix}
	\partial_rx	&	\partial_{\theta}x	\\ 
	\partial_ry	&	\partial_{\theta}y
\end{pmatrix}=\det\begin{pmatrix}
	\cos(\theta)	&	-r\sin(\theta)	\\ 
	\sin(\theta)	&	r\cos(\theta)	
\end{pmatrix}=r.
\end{equation}

\begin{example}    
    Montrons comment intégrer la fonction $f(x,y)=\sqrt{1-x^2-y^2}$ sur le domaine délimité par la droite $y=x$ et le cercle $x^2+y^2=y$, représenté sur la figure \ref{LabelFigQXyVaKD}. Pour trouver le centre et le rayon du cercle $x^2+y^2=y$, nous commençons par écrire $x^2+y^2-y=0$, et ensuite nous reformons le carré : $y^2-y=(y-\frac{ 1 }{2})^2-\frac{1}{ 4 }$.
    \newcommand{\CaptionFigQXyVaKD}{Passage en polaire pour intégrer sur un morceau de cercle.}
\input{auto/pictures_tex/Fig_QXyVaKD.pstricks}

    Le passage en polaire transforme les équations du bord du domaine en
    \begin{equation}
        \begin{aligned}[]
            \cos(\theta)&=\sin(\theta)\\
            r^2&=r\sin(\theta).
        \end{aligned}
    \end{equation}
    L'angle $\theta$ parcours donc $\mathopen] 0 , \pi/4 \mathclose[$, et le rayon, pour chacun de ces $\theta$ parcours $\mathopen] 0 , \sin(\theta) \mathclose[$. La fonction à intégrer se note maintenant $f(r,\theta)=\sqrt{1-r^2}$. Donc l'intégrale à calculer est
    \begin{equation}		\label{PgRapIntMultFubiniBoutCercle}
        \int_{0}^{\pi/4}\left( \int_0^{\sin(\theta)}\sqrt{1-r^2}r\,rd \right).
    \end{equation}
    Remarquez la présence d'un $r$ supplémentaire pour le jacobien.

    Notez que les coordonnées du point $P$ sont $(1,1)$.
\end{example}

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées sphériques}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Les coordonnées sphériques sont données par
\begin{equation}		\label{EqChmVarSpherique}
	\left\{
\begin{array}{lllll}
x=r\cos\theta\sin\varphi	&			&r\in\mathopen] 0 , \infty \mathclose[\\
y=r\sin\theta\sin\varphi	&	\text{avec}	&\theta\in\mathopen] 0 , 2\pi \mathclose[\\
z=r\cos\varphi			&			&\phi\in\mathopen] 0 , \pi \mathclose[.
\end{array}
\right.
\end{equation}
Le jacobien associé est $Jg(r,\theta,\varphi)=-r^2\sin\varphi$. Rappelons que ce qui rentre dans l'intégrale est la valeur absolue du jacobien.

Si nous voulons calculer le volume de la sphère de rayon $R$, nous écrivons donc
\begin{equation}
	\int_0^Rdr\int_{0}^{2\pi}d\theta\int_0^{\pi}r^2 \sin(\phi)d\phi=4\pi R=\frac{ 4 }{ 3 }\pi R^3.
\end{equation}
Ici, la valeur absolue n'est pas importante parce que lorsque $\phi\in\mathopen] 0,\pi ,  \mathclose[$, le sinus de $\phi$ est positif.

Des petits malins pourraient remarquer que le changement de variable \eqref{EqChmVarSpherique} est encore une paramétrisation de $\eR^3$ si on intervertit le domaine des angles : 
\begin{equation}
	\begin{aligned}[]
		\theta&\colon 0 \to \pi\\
		\phi	&\colon 0\to 2\pi,
	\end{aligned}
\end{equation}
alors nous paramétrons encore parfaitement bien la sphère, mais hélas
\begin{equation}		\label{EqVolumeIncorrectSphere}
	\int_0^Rdr\int_{0}^{\pi}d\theta\int_0^{2\pi}r^2 \sin(\phi)d\phi=0.
\end{equation}
Pourquoi ces «nouvelles» coordonnées sphériques sont-elles mauvaises ? Il y a que quand l'angle $\phi$ parcours $\mathopen] 0 , 2\pi \mathclose[$, son sinus n'est plus toujours positif, donc la \emph{valeur absolue} du jacobien n'est plus $r^2\sin(\phi)$, mais $r^2\sin(\phi)$ pour les $\phi$ entre $0$ et $\pi$, puis $-r^2\sin(\phi)$ pour $\phi$ entre $\pi$ et $2\pi$. Donc l'intégrale \eqref{EqVolumeIncorrectSphere} n'est pas correcte. Il faut la remplacer par
\begin{equation}
	\int_0^Rdr\int_{0}^{\pi}d\theta\int_0^{\pi}r^2 \sin(\phi)d\phi- \int_0^Rdr\int_{0}^{\pi}d\theta\int_{\pi}^{2\pi}r^2 \sin(\phi)d\phi = \frac{ 4 }{ 3 }\pi R^3
\end{equation}

\subsection{Coordonnées polaires}
Soit $T$ la fonction de $]0, +\infty[\times \eR$ dans $\eR^2\setminus\{(0,0)\}$ définie par
\begin{equation}
  \begin{array}{lccc}
    T: &]0, +\infty[\times \eR & \to & \eR^2\setminus\{(0,0)\}\\
 & (r, \theta)&\mapsto& (r\cos \theta, r \sin \theta),
  \end{array}
\end{equation}
Cette fonction est surjective. Elle est bijective sur chaque bande de la forme  $]0, +\infty[\times [a-\pi,a+\pi[$. Si $a=0$ l'inverse de $T$  est la fonction $T^{-1}(x,y)= (\sqrt{x^2+y^2}, \arctg (y/x))$. Soit $P=(x,y)$ un élément dans $\eR^2$, on dit que $r=\sqrt{x^2+y^2}$ est le rayon de $P$ et que $\theta=\arctg (y/x) $ est son argument principal. L'origine ne peut pas être décrite en coordonnées polaires parce que si son rayon est manifestement zéro, on ne peut pas lui associer une valeur univoque de l'angle $\theta$. 

\begin{example}
L'équation du cercle de rayon $a$ et centre $(0, 0)$ en coordonnées polaires est $r=a$. 
\end{example}

\begin{example}
	Une équation possible pour la demi-droite $x=y$, $x>0$,  est $\theta=\pi/4$.         
\end{example}

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++   
\subsection{Coordonnées cylindriques}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Soit $T$ la fonction de $]0, +\infty[\times \eR^2$ dans $\eR^3\setminus\{(0,0,0)\}$ définie par
\begin{equation}
  \begin{array}{lccc}
    T: &]0, +\infty[\times \eR\times \eR & \to & \eR^3\setminus\{(0,0,0)\}\\
 & (r, \theta, z)&\mapsto& (r\cos \theta, r \sin \theta, z),
  \end{array}
\end{equation}
Cette fonction est surjective. Elle est bijective sur chaque bande de la forme  $]0, +\infty[\times [a-\pi,a+\pi[\times \eR$, $a$ dans $\eR$. Il n'y a presque rien de nouveau par rapport aux coordonnées polaires. Les coordonnées  cylindriques sont intéressantes si on décrit un objet invariant par rapport aux rotations autour de l'axe des $z$. 

\begin{example}
Il faut savoir ce que décrivent les équations les plus simples en coordonnées cylindriques, 
\begin{itemize}
\item $r\leq a$, pour $a$ constant dans  $]0, +\infty[$, est le cylindre de hauteur infinie qui a pour axe l'axe des $z$ et pour base le disque de rayon $a$ centré à l'origine, 
\item $r= a$ est  la surface du cylindre,
\item $\theta = b$ est un demi-plan ouvert et sa fermeture contient l'axe des $z$,
\item $z=c$ est un plan parallèle au plan $x$-$y$. 
\end{itemize}
\end{example}

\begin{example}
  Un demi-cône qui a  son sommet en l'origine et  pour axe l'axe des $z$ est décrit par $z=d r$.  Si $d$ est positif  il s'agit  de la moitié supérieure du cône, si $d<0$ de la moitié inférieure.
\end{example}

\begin{example}
 De même,  la sphère de rayon $a$ et centrée à l'origine est l'assemblage des calottes $z=\sqrt{a^2-r^2}$ et $z=-\sqrt{a^2-r^2}$. 
\end{example}

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++   
\subsection{Coordonnées sphériques}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit $T$ la fonction de $]0, +\infty[\times \eR^2$ dans $\eR^3\setminus\{(0,0,0)\}$ définie par
\begin{equation}
  \begin{array}{lccc}
    T: &]0, +\infty[\times \eR\times \eR & \to & \eR^3\setminus\{(0,0,0)\}\\
 & (\rho, \theta, \phi)&\mapsto& (\rho\cos \theta\sin \phi, \rho \sin \theta\sin \phi, \rho\cos \phi),
  \end{array}
\end{equation}
Cette fonction est surjective. Elle est bijective sur chaque bande de la forme  $]0, +\infty[\times [a-\pi,a+\pi[\times [b-\pi/2, b+\pi/2[$, $a$ et $b$ dans $\eR$.  Si $a =0$ et $b=-\pi/2$ la fonction inverse $T^{-1}$ est donnée donnée
\begin{equation}
  \begin{array}{lccc}
    T: &\eR^3\setminus\{(0,0,0)\} & \to & ]0, +\infty[\times [-\pi,\pi[\times [0, \pi[\\
 & (x,y,z)&\mapsto& \left(\sqrt{x^2+y^2+z^2}, \arctg \frac{y}{x}, \arccos \left(\frac{z}{\sqrt{x^2+y^2+z^2}}\right)\right). 
  \end{array}
\end{equation}
Soit $ P$ un point dans $\eR^3$. L'angle $\phi$ est l'angle entre le demi-axe positif des $z$ et le vecteur $\overrightarrow{OP}$, $\rho$ est la norme de $\overrightarrow{OP}$ et $\theta$ est l'argument en coordonnées polaires de la projection de $\overrightarrow{OP}$ sur le plan $x$-$y$.  

\begin{remark}
	Dans la littérature, les angles $\theta$ et $\phi$ sont parfois inversés (voire, changent de nom, par exemple $\varphi$ au lieu de $\phi$). Il faut donc être très prudent lorsqu'on veut utiliser dans un cours des formules données dans un autre cours.
\end{remark}

\begin{example}
Il faut connaître le sens des équations plus simples, 
\begin{itemize}
\item $\rho\leq a$, pour $a$ constant dans  $]0, +\infty[$, est la boule fermée de rayon $a$ centrée à l'origine, 
\item $\rho= a$ est  la sphère de rayon $a$ centrée à l'origine,
\item $\theta = b$ est un demi-plan ouvert et sa fermeture contient l'axe des $z$,
\item $\phi= c$ est un demi-cône qui a  son sommet à l'origine et  pour axe l'axe des $z$.  Si $c$ est positif  il s'agit  de la moitié supérieure du cône, si $d<0$ de la moitié inférieure. 
\end{itemize}
 \end{example}

%--------------------------------------------------------------------------------------------------------------------------- 
 \subsection{Coordonnées cylindriques et sphériques}
%---------------------------------------------------------------------------------------------------------------------------

Les \defe{coordonnées cylindriques}{coordonnées!cylindrique} sont un perfectionnement des coordonnées polaires. Il s'agit simplement de donner le point $(x,y,z)$ en faisant la conversion $(x,y)\mapsto(r,\theta)$ et en gardant le $z$. Les formules de passage sont
\begin{subequations}
	\begin{numcases}{}
		x=r\cos(\theta)\\
		y=r\sin(\theta)\\
		z=z.
	\end{numcases}
\end{subequations}

Les \defe{coordonnées sphériques}{coordonnées!sphériques} sont ce qu'on appelle les «méridiens» et «longitudes» en géographie. Les formules de transformation sont 
\begin{subequations}		%\label{SubEqsCoordSphe}
	\begin{numcases}{}
		x=\rho\sin(\theta)\cos(\varphi)\\
		y=\rho\sin(\theta)\sin(\varphi)\\
		z=\rho\cos(\theta)
	\end{numcases}
\end{subequations}
avec $0\leq\theta\leq\pi$ et $0\leq\varphi<2\pi$.

\begin{remark}
	Attention : d'un livre à l'autre les conventions sur les noms des angles changent. N'essayez donc pas d'étudier par cœur des formules concernant les coordonnées sphériques trouvées autre part. Par exemple sur le premier dessin de \href{http://fr.wikipedia.org/wiki/Coordonnées_sphériques}{wikipédia}, l'angle $\varphi$ est noté $\theta$ et l'angle $\theta$ est noté $\Phi$. Mais vous noterez que sur cette même page, les convention de noms de ces angles changent plusieurs fois.
\end{remark}

Trouvons le changement inverse, c'est à dire trouvons $\rho$, $\theta$ et $\varphi$ en termes de $x$, $y$ et $z$. D'abord nous avons
\begin{equation}
	\rho=\sqrt{x^2+y^2+z^2}.
\end{equation}
Ensuite nous savons que
\begin{equation}
	\cos(\theta)=\frac{ z }{ \rho }
\end{equation}
détermine de façon unique\footnote{Le problème $\rho=0$ ne se pose pas; pourquoi ?} un angle $\theta\in\mathopen[ 0 , \pi \mathclose]$. Dès que $\rho$ et $\theta$ sont connus, nous pouvons poser $r=\rho\sin\theta$ et alors nous nous trouvons avec les équations
\begin{subequations}
	\begin{numcases}{}
		x=r\cos(\varphi)\\
		y=r\sin(\varphi),
	\end{numcases}
\end{subequations}
qui sont similaires à celles déjà étudiées dans le cas des coordonnées polaires.

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Récapitulatif des changements de variables}
%---------------------------------------------------------------------------------------------------------------------------

En pratique, nous retiendrons les formules suivantes:
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées polaires}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

\begin{subequations}
    \begin{numcases}{}
        x=r\cos\theta\\
        y=r\sin\theta
    \end{numcases}
\end{subequations}
avec \( r\in\mathopen] 0 , \infty \mathclose[\) et \( \theta\in\mathopen[ 0 , 2\pi [\). Le jacobien vaut \( r\).

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées cylindriques}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

\begin{subequations}
    \begin{numcases}{}
        x=r\cos\theta\\
        y=r\sin\theta\\
        z=z
    \end{numcases}
\end{subequations}
avec \( r\in\mathopen] 0 , \infty \mathclose[\), \( \theta\in\mathopen[ 0 , 2\pi [\) et \( z\in\eR\). Le jacobien vaut \( r\).

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Coordonnées sphériques}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

\begin{subequations}
    \begin{numcases}{}
        x=\rho\cos\theta\sin\phi\\
        y=\rho\sin\theta\sin\phi\\
        z=\rho\cos\phi
    \end{numcases}
\end{subequations}
avec \( \rho\in\mathopen] 0 , \infty \mathclose[\), \( \theta\in\mathopen[ 0 , 2\pi [\) et \( \phi\in\mathopen[ 0 , \pi [\). Le jacobien vaut \( -\rho^2\sin(\phi)\). 

N'oubliez pas que lorsqu'on effectue un changement de variables dans une intégrale, la \emph{valeur absolue} du jacobien apparaît.

Cependant notre convention de coordonnées sphériques fait venir \( \sin(\phi)\) avec \( \phi\in\mathopen[ 0 , \pi [\); vu que le signe de \( \sin(\phi)\) y est toujours positif, cette histoire de valeur absolue est sans grandes conséquent. Ce n'est pas le cas de toutes les conventions possibles.


%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{une limite}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}
    Nous avons la limite
    \begin{equation}\label{sinsurx}
      \lim_{x\to 0} \frac{\sin(x)}{x} = 1.
    \end{equation}
\end{proposition}

\begin{proof}
    On commence par observer que la fonction $g(x)=\frac{\sin(x)}{x}$ est un rapport entre deux fonction impaires et est donc une fonction paire. Nous pouvons alors nous réduire à considérer le cas où $x$ est positif. La première étape de cette preuve nous dit que $g(x)\leq 1$ pour tout $x\in\eR^{+,*}$. 

    Nous voulons étudier le comportement de $g$ dans un voisinage de $0$. Nous pouvons alors supposer que $x$ soit inférieur à $\pi/2$. Soit $D = (1, \tan (x))$. On voit très bien dans le dessin que l'aire du triangle de sommets $O$, $D$ et $C$ est supérieure à l'aire du secteur circulaire de sommets $O$, $A$ et $C$. Ces deux aires peuvent \^etre calculées très facilement et nous obtenons
    \begin{equation*}
      \frac{\sin(x)}{2\cos(x)} \geq \frac{x}{2}.
    \end{equation*}
    À partir de cette dernière inégalité nous pouvons écrire 
    \begin{equation*}
      1\geq \frac{\sin(x)}{x}\geq \cos(x).
    \end{equation*}
    En prenant la limite lorsque $x$ tend vers $0$ dans les trois membres de l'inégalité la règle de l'étau nous permet d'obtenir la limite remarquable  \eqref{sinsurx}. 
\end{proof}


