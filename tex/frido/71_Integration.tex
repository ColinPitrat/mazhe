% This is part of Mes notes de mathématique
% Copyright (c) 2011-2017
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Propriétés}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{theorem}[\cite{ooGMNAooSLnIio}]      \label{THOooVADUooLiRfGK}
    Soient deux espaces mesurables \( (S_1,\tribF_1)\) et \( (S_2,\tribF_2)\) ainsi qu'une application mesurable \( \varphi\colon S_1\to S_2\). Soit encore \( \mu\), une mesure positive sur \( (S_1,\tribF_1)\).

    Si \( f\colon S_2\to\bar \eR\) ou \( \eC\) est mesurable alors,
    \begin{enumerate}
        \item      \label{ItemooKMBIooZpHJSS}
            \( f\) est \( \varphi(\mu)\)-intégrale si et seulement si \( f\circ\varphi\) est \( \mu\)-intégrable.
        \item       \label{ItemooLAPYooUreDEl}
            dans le cas où \( f\) est \( \varphi(\mu)\)-intégrable, nous avons
            \begin{equation}        \label{EqooSOHXooXSbdoy}
                \int_{S_2}fd\big( \varphi(\mu) \big)=\int_{S_1}(f\circ\varphi)d\mu.
            \end{equation}
    \end{enumerate}
\end{theorem}

\begin{proof}
    L'intégrabilité est la définition \ref{DefTCXooAstMYl}, et demande que \( | f |\) soit intégrable. L'égalité \eqref{EqooSOHXooXSbdoy} a un sens si les deux membres sont infinis. Tant que les fonctions considérées sont positives, le point \ref{ItemooKMBIooZpHJSS} est immédiat. Ce n'est qu'au moment où les fonctions considérées deviennent à valeurs dans \( \eC\) ou \( \eR\) que l'intégrabilité de \( | f |\) commence à jouer parce qu'il faut que \(  f^+  \) et \( f^-\) soient séparément intégrables.

    Nous allons prouver la formule \eqref{EqooSOHXooXSbdoy} pour des fonctions de plus en plis générales. Pour la suite nous notons \( \mu'=\varphi(\mu)\).

    \begin{subproof}
        \item[Pour \( f=\mtu_B\), \( B \) mesurable]
            Soit \( B\in\tribF_2 \). Nous avons \( \mtu_B\circ\varphi=\mtu_{\varphi^{-1}(B)}\). Donc en utilisant le lemme \ref{LemooPJLNooVKrBhN} nous avons
            \begin{equation}
                \int_{S_2}\mtu_{B}d\mu'=\mu'(B)=\mu\big( \varphi^{-1}(B) \big)=\int_{S_1}\mtu_{\varphi^{-1}(B)}d\mu=\int_{S_1}(\mtu_B\circ \varphi)d\mu.
            \end{equation}
        \item[\( f\) est étagée positive]

            La fonction \( f\) peut être écrite sous la forme
            \begin{equation}
                f=\sum_{k=1}^na_k\mtu_{B_k}
            \end{equation}
            avec \( B_k\in\tribF_2\) et \( a_k\in \eR^+\). Nous avons alors, en utilisant la sous-additivité de l'intégrale du théorème \ref{ThoooCZCXooVvNcFD}\ref{ITEMooOJRAooQkoQyD},
            \begin{subequations}
                \begin{align}
                    \int_{S_2}fd\mu'&=\sum_ka_k\int_{S_2}\mtu_{B_k}d\mu'\\
                    &=\sum_ka_k\int_{S_1}(\mtu_{B_k}\circ\varphi)d\mu\\
                    &=\int_{S_1}\Big( \sum_ka_k\mtu_{B_k} \Big)\circ \varphi d\mu\\
                    &=\int_{S_1}(f\circ\varphi)d\mu.
                \end{align}
            \end{subequations}
        \item[\( f\) à valeurs dans \( \bar \eR^+\)]

            Vu que \( f\) est mesurable, par le théorème \ref{THOooXHIVooKUddLi} il existe une suite croissante de fonctions étagées positives convergeant vers \( f\). Soit donc cette suite, \( f_n\colon S_2\to \eR^+\). Les fonction s\( f_n\circ\varphi\) sont étagées et positives et nous avons aussi la limite ponctuelle et croissante \( f_n\circ\varphi\to f\circ\varphi\) parce que \( \varphi\) est continue. Le théorème de la convergence monotone (théorème \ref{ThoRRDooFUvEAN}) permet d'écrire ceci :
            \begin{equation}
                \int_{S_2}fd\mu'=\lim\int_{S_2}f_nd\mu'= \lim\int_{S_1}(f_n\circ\varphi)d\mu=\int_{S_1}(f\circ\varphi)d\mu.
            \end{equation}
        \item[Pour \( f\colon S_2\to \bar \eR\) ou \( \eC\) ]
            
            C'est maintenant que l'intégrabilité va jouer. Nous avons \( | f |\circ\varphi=| f\circ\varphi |\), donc
            \begin{equation}
                \int_{S_2}| f |d\mu'=\int_{S_1}| f |\circ\varphi d\mu=\int_{S_1}| f\circ \varphi |d\mu,
            \end{equation}
            ce qui montre que \( f\) est \( \mu'\)-intégrable si et seulement si \( f\circ\varphi\) est \( \mu\)-intégrable.

            De plus si \(f=f^+-f^- \) alors \( f^+\circ\varphi=(f\circ\varphi)^+\), \( f^-\circ\varphi=(f\circ\varphi)^-\), et de façon similaire pour les parties imaginaires et réelles.
    \end{subproof}
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Primitives et intégrales}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

En termes de notations, si \( a<b\) nous posons
\begin{equation}
    \int_a^bf(t)dt=\int_{\mathopen[ a , b \mathclose]}f.
\end{equation}
Si par contre \( a>b\) nous posons \( \int_a^bf=-\int_b^af\).

\begin{proposition}[Primitive et intégrale] \label{PropEZFRsMj}
    Soit \( f\) une fonction intégrable sur \( \mathopen[ a , b \mathclose]\) et continue sur \( \mathopen] a , b \mathclose[\). Alors la fonction
    \begin{equation}
        \begin{aligned}
            F\colon \mathopen[ a , b \mathclose]&\to \eR \\
            x&\mapsto \int_{\mathopen[ a , x \mathclose]}f(t)dt.
        \end{aligned}
    \end{equation}
est l'unique primitive de \( f\) sur \( \mathopen] a , b \mathclose[\) s'annulant en \( x=a\).
\end{proposition}
\index{primitive!et intégrale}
\index{théorème!fondamental du calcul intégral}

\begin{proof}
Nous devons prouver que \( F\) est dérivable et que pour tout \( x_0\in\mathopen] a , b \mathclose[\) nous ayons \( F'(x_0)=f(x_0)\). Soit \( \epsilon>0\). Par continuité de \( f\) en \( x_0\), il existe une fonction \( \alpha\colon \eR\to \eR\) telle que
    \begin{equation}
        f(x_0+h)=f(x_0)+\alpha(h)
    \end{equation}
    avec \( \lim_{h\to 0} \alpha(h)=0\). De plus il existe un \( \delta>0\) tel que \( |\alpha(h)|<\epsilon\) pour tout \( h<\delta\). À partir de maintenant nous ne considérons plus que de tels \( h\).

    Nous calculons la dérivée de \( F\) en \( x_0\). Pour cela,
    \begin{subequations}
        \begin{align}
            F(x_0+h)-F(x_0)&=\int_{x_0}^{x_0+h}f(t)dt\\
        &=\int_0^hf(x_0+t)dt\\
        &=\int_0^h\big[ f(x_0)+\alpha(t) \big]dt\\
        &=hf(x_0)+\int_0^{h}\alpha(t)dt.
        \end{align}
    \end{subequations}
    Nous avons donc, pour tout \( h<\delta\),
    \begin{equation}
        hf(x_0)-h\epsilon\leq F(x_0+h)-F(x_0)\leq hf(x_0)+h\epsilon.
    \end{equation}
    En divisant par \( h\) et en prenant la limite \( h\to 0\),
    \begin{equation}
        F'(x_0)\in B\big( f(x_0),\epsilon \big).
    \end{equation}
    Cela étant valable pour tout \( \epsilon>0\) nous en déduisons que
    \begin{equation}
        F'(x_0)=f(x_0).
    \end{equation}

    Le fait que \( F\) s'annule en \( x=a\) est par sa définition. L'unicité provient du corollaire \ref{CorZeroCst}.
\end{proof}

Le théorème suivant est à utiliser pour calculer des intégrales des fonctions réelle lorsqu'on a des primitives sur un domaine strictement plus large que le domaine sur lequel nous voulons intégrer. Une version pour les intégrales impropres sera donnée au corollaire \ref{CorMUIooXREleR}.
\begin{theorem}[Théorème fondamental du calcul intégral]    \label{ThoRWXooTqHGbC}
    Soit \( f\) une fonction continue sur un intervalle ouvert \( I\) contenant strictement l'intervalle \( \mathopen[ a , b \mathclose]\subset \eR\) et \( F\) une primitive de \( f\) sur \( I\). Alors
    \begin{equation}
        \int_a^bf(t)dt=F(b)-F(a).
    \end{equation}
\end{theorem}

\begin{proof}
    Nous avons vu par la proposition \ref{PropEZFRsMj} que la fonction
    \begin{equation}
        \begin{aligned}
            \tilde F\colon \mathopen[ a , b \mathclose]&\to \eR \\
            x&\mapsto  \int_a^xf(t)dt
        \end{aligned}
    \end{equation}
    était une primitive de \( f\); c'est même l'unique\footnote{} primitive de \( f\) sur \( \mathopen[ a , b \mathclose]\) à s'annuler pour \( x=a\). Nous avons évidemment
    \begin{equation}
        \int_a^bf(t)dt=\tilde F(b).
    \end{equation}
    Si \( F\) est une primitive quelconque, il suffit de soustraire sa valeur en \( x=a\) : \( \tilde F(x)=F(x)-F(a)\) et donc
    \begin{equation}
        \int_a^bf(t)dt=\tilde F(b)=F(b)-F(a),
    \end{equation}
    comme il fallait le prouver.
\end{proof}

\begin{remark}
    Le lien entre primitive et intégrale est fondamentalement lié à l'invariance par translation de la mesure de Lebesgue, et non à la construction précise de cette mesure. Mais en même temps, la mesure de Lebesgue est l'unique à être invariante par translation.
\end{remark}

\begin{remark}
    Une primitive est forcément une fonction continue parce qu'une primitive est dérivable.
\end{remark}

Ce petit résultat nous donne une façon «pratique» de calculer des intégrales en cherchant des primitives. Nous rappelons qu'en vertu du corollaire \ref{CorZeroCst}, une fonction ne possède qu'une seule primitive à constante près.

\begin{corollary}[Théorème fondamental du calcul intégral]       \label{CORooKRBZooEMDobC}
    Soit une fonction \( f\colon I\to \eR\) où \( I\) est un intervalle. Nous supposons que \( f\) est continue sur \( I\). Soient \( a<b\) dans \( I\) et une primitive \( F\) de \( f\) sur \( I\).

    Alors
    \begin{equation}        \label{EQooXEKDooEnWcbn}
        \int_a^bf=F(b)-F(a).
    \end{equation}
\end{corollary}

\begin{proof}
    Nous savons par la proposition \ref{PropEZFRsMj} que la fonction donnée par
    \begin{equation}
        G(x)=\int_a^xf
    \end{equation}
    est une primitive de \( f\). Vu que \( F\) est également une primitive nous avons \( F(x)=G(x)+C\) pour une certaine constante \( C\in \eR\) (c'est le corollaire \ref{CorZeroCst}). Vu que \( G(a)=0\), l'égalité \( F(a)=G(a)+C\) donne \( C=F(a)\).

    Ce que l'on nous demande de calculer dans \eqref{EQooXEKDooEnWcbn} est \( G(b)\), c'est à dire l'égalité
    \begin{equation}
        F(b)=G(b)+C=G(b)+F(a),
    \end{equation}
    et donc \( G(b)=F(b)-F(a)\), ce qu'il fallait.
\end{proof}

\begin{proposition}[\cite{ooIEJXooIYpBbd}]      \label{PROPooWZFGooMVLtFz}
    Soient des fonction \( f,g\colon I\to \eR\) de classe \(  C^{1}\) sur l'ouvert \( I\) de \( \eR\) telles que \( f^2+g^2=1\). Soit \( t_0\in I\) et \( \theta_0\) tel que \( f(t_0)=\cos(\theta_0)\) et \( g(t_0)=\sin(\theta_0)\).

    Alors il existe une unique fonction continue \( \theta\colon I\to \eR\) telle que 
    \begin{subequations}
        \begin{numcases}{}
            \theta(t_0)=\theta_0\\
            f=\cos\circ \theta\\
            g=\sin\circ \theta.
        \end{numcases}
    \end{subequations}
\end{proposition}

\begin{proof}
    Nous commençons par l'existence, en passant par les nombres complexes. Soit \( h\colon I\to \eC\) définie par \( h=f+ig\). Nous avons \( h\bar h=1\) et nous définissons
    \begin{equation}
        \theta(t)=\theta_0-i\int_{t_0}^th'(s)\overline{ h(s) }ds.
    \end{equation}
    Cette intégrale existe pour tout \( t\) parce que les fonctions \( f\) et \( g\) étant de classe \(  C^{\infty}\), elles sont bornées sur le compact \( \mathopen[ t_0 , t  \mathclose]\). De plus \( \theta\) est une fonction continue parce que c'est une primitive (proposition \ref{PropEZFRsMj})\footnote{En réalité nous appliquons la proposition \ref{PropEQRooQXazLz} à chacune des parties réelles et imaginaires de la fonction \( s\mapsto h'(s)\overline{ h(s) }\).}.

    La dérivée de \( \theta\) est la fonction \( s\mapsto -i h'(s)\overline{ h(s) }\).

    Calculons 
    \begin{equation}
        \Dsdd{ h e^{-i\theta} }{t}{0}= e^{-i\theta}(h'-h\theta')= e^{-i\theta}(h'-ih(-i)h'\bar h)=0.
    \end{equation}
    Par conséquent il existe \( c\in \eC\) tel que \( h e^{-i\theta}=c\). Mais \( h(t_0)=f(t_0)+ig(t_0)=\cos(\theta_0)+i\sin(\theta_0)= e^{i\theta_0}\), du coup
    \begin{equation}
        h(t_0) e^{-i\theta(t_0)}=c
    \end{equation}
    donne immédiatement \( c=1\), ou encore \(  e^{i\theta(t)}=h(t)\), c'est à dire que
    \begin{equation}
        f+ig=\cos\circ\theta+i\sin\circ\theta,
    \end{equation}
    ce qu'il fallait pour l'existence.

    Pour l'unicité nous supposons avoir une autre fonction, \(\alpha\) qui satisfait aux exigences. Pour tout \( t\in I\) nous avons
    \begin{equation}
        e^{i\theta(t)}= e^{i\alpha(t)}.
    \end{equation}
    Il existe donc une fonction \( n\colon I\to \eN\) telle que \( \theta(t)=\alpha(t)+2n(t)\pi\). Par continuité de \( \theta\) et \( \alpha\), la fonction \( n\) doit être constante, mais vu que \( \theta(t_0)=\alpha(t_0)\) nous avons \( n=1\).
\end{proof}


%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Primitives et intégrales}
%---------------------------------------------------------------------------------------------------------------------------

Si \( f\) est une fonction définie sur un intervalle \( I\) et y admettant des primitives, nous notons
\begin{equation}
    \int f(x)dx
\end{equation}
l'ensemble des primitives de \( f\) sur \( I\) :
\begin{equation}
    \int f(x)dx=\left\{    F(x)+C\tq C\in \eR   \right\}
\end{equation}
où \( F\) est une quelconque primitive de \( f\).

\begin{example}
    Une primitive bien connue de \(  f\colon x\mapsto x^2 \) est la fonction \( F\colon x\to \frac{ x^3 }{ 3 }\). Nous écrivons donc
    \begin{equation}
        \int x^2dx=\frac{ x^3 }{ 3 }+C.
    \end{equation}
    Cela est un abus de notations terrible pour dire en réalité
    \begin{equation}
        \{ x\mapsto \frac{ x^3 }{ 3 }+C\tq C\in \eR \}.
    \end{equation}
\end{example}

En termes de notations, nous posons
\begin{equation}\label{Thfondcalc}
    \int_a^bf(t)dt=\Big[ F(t) \Big]_{t=a}^{t=b}=F(b)-F(a).
\end{equation}

\begin{remark}
  La valeur de l'intégrale ne dépend pas de la primitive qu'on choisi pour le calculer, car si $F_1$ et $F_2$ sont deux primitives de $f$ alors $F_1 = F_2 + C$ et $F_1(b)-F_1(a) = (F_2(b) + C)-(F_2(a)+C) = F_2(b)-F_2(a)$.
\end{remark}

\begin{remark}
  Si l'intervalle d'intégration est réduit à un seul point alors la valeur de l'intégrale est zéro, car $ \int_a^af(t)dt=F(a)-F(a) =0$.
\end{remark}

\begin{remark}
    Conformément à ce que nous montre la figure \ref{LabelFigKKRooHseDzC}, si une fonction continue est positive sur l'intervalle \( \mathopen[ a , b \mathclose]\), alors le nombre \( \int_a^bf(t)dt\) est l'aire de la portion de plan comprise entre les droites verticales \( x=a\), \( x=b\), la courbe représentant la fonction \( f\) et l'axe des abscisses.

    Si la fonction est négative : l'aire est comptée négativement.
\end{remark}

\begin{example} 
    Comme nous le voyons sur le dessin suivant,
    \begin{equation}
        \int_{-3\pi/2}^{3\pi/2}\sin(x)\,dx=0
    \end{equation}
    parce que les deux parties bleues s'annulent avec les deux parties rouges (qui sont comptées comme des aires négatives).
    \begin{center}
       \input{auto/pictures_tex/Fig_JSLooFJWXtB.pstricks}
    \end{center}
\end{example}

\begin{remark}
  Toute intégrale d'une fonction impaire sur un intervalle symétrique par rapport à l'origine est nulle. 
\end{remark}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Intégrales impropres}
%---------------------------------------------------------------------------------------------------------------------------
\label{SecGAVooBOQddU}

% TODO : l'exemple avec arcsin(1/x)-1/x de la page 
%  http://fr.wikipedia.org/wiki/Intégrale_impropre

\begin{definition}[\cite{TrenchRealAnalisys}]
    Une fonction \( f\colon D\subset\eR\to \eR\) est \defe{localement intégrable}{localement!intégrable} sur un intervalle \( I\) si \( f\) est intégrable sur tout intervalle compact contenu dans \( I\).
\end{definition}
\index{intégrale!impropre}

%Dans \cite{TrenchRealAnalisys}, la proposition \ref{PropCJAooQhNYkp} est prise comme une définition de \( \int_a^bf\) lorsque \( f\) est localement intégrable sur \( \mathopen[ a , b [\). Le point est que lui, il ne passe pas par Lebesgue et la construction abstraite d'intégrale par rapport à une mesure. Nous par contre nous avons déjà une définition de
%\begin{equation}
%    \int_a^bf=\int_{\mathopen[ a , b \mathclose]}f
%\end{equation}
%pour tout choix de \( a\), \( b\) et \( f\), que ce soit borné ou non.

\begin{proposition}     \label{PropCJAooQhNYkp}
    Soit \( f\colon \mathopen[ a , b \mathclose]\to \eR\) une fonction intégrable. Alors
    \begin{equation}    \label{EqPPMooBQDTYl}
        \int_{\mathopen[ a , b \mathclose]}f=\lim_{x\to b^-} \int_a^xf.
    \end{equation}
\end{proposition}

\begin{proof}
    Notons que la valeur de \( f\) en \( b\) n'a strictement aucune importance parce que l'intégrale de Lebesgue ne dépend pas du choix de la valeur de la fonction en un ensemble de mesure nulle; et en même temps la limite à gauche de \eqref{EqPPMooBQDTYl} ne dépend pas non plus de la valeur de \( f\) en \( b\). Bref si \( f\) n'est pas définie en \( b\), nous pouvons poser \( f(b)=42\).

    Notons de plus que du point de vue de l'intégrale de Lebesgue, \( \int_{\mathopen[ a , b \mathclose]}\) et \( \int_{\mathopen[ a , b [}\) sont identiques et valent toutes les deux \( \int_a^b\) (lorsque ça existe).

    Supposons d'abord que \( f\) est positive. Alors nous posons \( f_n=f\mtu_{\mathopen[ a , b-\frac{1}{ n } \mathclose]}\). Ponctuellement nous avons la limite croissante \( f_n\to f\) et de plus
    \begin{equation}
        \lim_{x\to b^-} \int_{\mathopen[ a , x \mathclose]}f=\lim_{n\to \infty} \int_{\mathopen[ a , b \mathclose]}f_n.
    \end{equation}
    Chacun des \( f_n\) est intégrable sur \( \mathopen[ a , b \mathclose]\). Le théorème de Beppo-Levi \ref{ThoRRDooFUvEAN} implique que \( f\) est intégrable sur \( \mathopen[ a , b \mathclose]\) et que
    \begin{equation}
        \lim_{n\to \infty} \int_a^bf_n=\int_a^bf.
    \end{equation}
    Cela montre que dans le cas d'une fonction \( f\) positive nous avons bien \eqref{EqPPMooBQDTYl}.

    Si \( f\) n'est pas positif, alors nous la décomposons en partie positive et négative \( f=f^+-f^{-}\) et par définition de l'intégrale d'une fonction non positive,
    \begin{equation}
        \lim_{x\to b^-} \int_{\mathopen[ a , x [}f=\lim\int f^{+}-\lim\int f^-.
    \end{equation}
\end{proof}

Il peut cependant arriver que la limite \( \lim_{x\to b} \int_a^bf\) existe alors que \( f\) n'est pas intégrable sur \( \mathopen[ a , b \mathclose]\). C'est l'ennui des fonctions non positives. Un exemple classique est
\begin{equation}\label{EqMMVooDSpgfz}
    \int_0^{\infty}\frac{ \sin(t) }{ t }dt
\end{equation}

\begin{definition}[\cite{DWNooWUZxRP}]      \label{DEFooINPOooWWObEz}
    Si
    \begin{equation}
        \lim_{x\to b} \int_a^bf
    \end{equation}
    existe alors nous disons que l'intégrale est \defe{convergente}{intégrale!convergente} en \( b\). Ce procédé de limite est l'intégrale \defe{impropre}{intégrale!impropre} de \( f\) sur \( \mathopen[ a , b \mathclose]\).
\end{definition}

\begin{example}[Intégale impropre]
    Nous considérons la fonction \( f\colon \mathopen[ 0 , \infty [\to \eR\) définie par
    \begin{equation}
        f(x)=\begin{cases}
            \frac{1}{ n }    &   \text{si } x\in\mathopen[ 2n-2 , 2n-1 [\\
                -\frac{1}{ n }    &    \text{si } x\in\mathopen[ 2n-1 , 2n [\text{.}
        \end{cases}
    \end{equation}
    Par la divergence de la série harmonique, \( \int_{0}^{\infty}| f |\) n'existe pas. La fonction \( f\) n'est donc pas intégrable au sens de Lebesgue (définition \ref{DefTCXooAstMYl}).

    Cependant pour tout \( n\) pair nous avons
    \begin{equation}
        \int_0^nf=0.
    \end{equation}
    Du coup pour tout \( x\geq 0\) nous avons
    \begin{equation}
        \int_0^xf=\int_{2n}^xf
    \end{equation}
    où \( 2n\) est le plus grand nombre pair inférieur à \( x\). Nous avons \( | x-2n |\leq 2\) et \( | f(x) |\leq \frac{1}{ n }\) pour \( x\in\mathopen[ 2n , x \mathclose]\). Donc
    \begin{equation}
        \int_{2n}^xf\leq \frac{ 2 }{ n }.
    \end{equation}
    Nous avons par conséquent
    \begin{equation}
        \lim_{x\to \infty} \int_0^xf=0,
    \end{equation}
    ce qui signifie que l'intégrale de \( f\) sur \( \mathopen[ 0 , \infty [\) converge au sens des intégrales impropres.
\end{example}


L'intégrale \eqref{EqMMVooDSpgfz} est une intégrale convergente mais la fonction n'est pas intégrable (parce que pour être intégrale il faut que \( | f |\) soit intégrable). Nous pouvons ainsi dire que cette intégrale converge mais n'existe pas.

Le corollaire suivant nous autorise à utiliser le théorème fondamental du calcul intégral \ref{ThoRWXooTqHGbC} même dans les cas limites.
\begin{corollary}   \label{CorMUIooXREleR}
    Si \( f\) est localement intégrable sur \( \mathopen[ a , b \mathclose]\) et si \( F\) est une primitive de \( f\) sur tout ouvert de \( \mathopen[ a , b \mathclose]\) alors
    \begin{equation}
        \int_a^bf=\lim_{x\to b^-} F(x)-F(a).
    \end{equation}
\end{corollary}
\index{primitive!et intégrale}

\begin{proof}
    Pour chaque \( x\) dans \( \mathopen[ a , b [\) nous avons
    \begin{equation}
        \int_a^xf=F(x)-F(b).
    \end{equation}
    La proposition \ref{PropCJAooQhNYkp} nous explique que la limite \( x\to b^-\) du membre de gauche existe et vaut \( \int_a^bf\). Donc également le membre de droite :
    \begin{equation}
        \int_a^bf=\lim_{x\to b^-} \int_a^xf=\lim_{x\to b^-} F(x)-F(b).
    \end{equation}
\end{proof}

La convergence des intégrales de fonctions \( \frac{1}{ x^{\alpha} }\) en \( 0\) et \( \infty\) est une question classique de l'intégration. De plus ces fonctions servent souvent à utiliser une théorème de comparaison (type intégrale dominée de Lebesgue).
\begin{proposition} \label{PropBKNooPDIPUc}
    Deux intégrales remarquables.
    \begin{enumerate}
        \item
            
            Nous avons 
    \begin{equation}
        \int_0^1\frac{1}{ x^\alpha }=\infty
    \end{equation}
    si et seulement si \( \alpha\geq 1\).

\item

    Nous avons
    \begin{equation}
        \int_1^{\infty}\frac{1}{ x^{\alpha} }=\infty
    \end{equation}
    si et seulement si \( \alpha\leq1\).

    \end{enumerate}
    
\end{proposition}

\begin{proof}
La fonction \( \frac{1}{ x^{\alpha} }\) admet la primitive \( F(x)=\frac{1}{ 1-\alpha }\frac{1}{ x^{\alpha-1} }\) sur tout compact de \( \mathopen] 0 , \infty \mathclose[\). Le corollaire \ref{CorMUIooXREleR} nous permet\footnote{Tout ce que nous avons fait avec la borne \( b\) de l'intégrale \( \int_a^b\) reste valable avec la borne \( a\).} de dire que \( \int_0^1\frac{1}{ x^{\alpha} }\) vaudra
    \begin{equation}
        \lim_{x\to 0-^+} \frac{1}{ 1-\alpha }\frac{1}{ x^{\alpha-1} }.
    \end{equation}
    Cela est strictement plus petit que \( \infty\) si et seulement si \( \alpha<1\).
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Théorème de Fubini-Tonelli et de Fubini}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Nous rappelons que \( \eR^n\) muni de la mesure de Lebesgue est un espace mesuré \( \sigma\)-fini, conformément à la définition \ref{DefBTsgznn}.

Le théorème de Fubini-Tonelli parle de fonctions réelles et non complexes, et même positives. Le truc est que ce théorème va servir de base pour construire les autres. Si nous avons une fonction à valeurs complexes, elle se décompose en parties réelles et imaginaires qui elles-mêmes se décomposent en parties positives et négatives. Au final, les preuves pour \( f\colon \Omega\to \eC\) se ramènent à appliquer quatre fois le théorème pour \( f\colon \Omega\to \bar \eR^+\).
\begin{theorem}[Fubini-Tonelli\cite{NBoIEXO}]\label{ThoWTMSthY}
    Soient \( (\Omega_i,\tribA_i,\mu_i)\) deux espaces mesurés \( \sigma\)-finis, et \( (\Omega,\tribA,\mu)\) l'espace produit. Soit une fonction \( f\colon \Omega_1\times \Omega_2\to \eR\) une fonction mesurable et positive (valant éventuellement \( \infty\) à certains endroits)
    Alors :
    \begin{enumerate}
        \item       \label{ITEMooUTMNooVIBdpP}
            Les fonction
            \begin{equation}        \label{EQooWLADooQwNhEy}
                F_1\colon x\mapsto \int_{\Omega_2}f(x,y)d\mu_2(y)
            \end{equation}
            et
            \begin{equation}
                F_2\colon y\mapsto \int_{\Omega_1}f(x,y)d\mu_1(x)
            \end{equation}
            sont mesurables.
        \item   \label{ITEMooFKQUooCoCOLV}
            Toutes les intégrales imaginables existent et sont égales :
            \begin{subequations}    \label{EqJRVtOGx}
                \begin{align}
                    \int_{\Omega_1\times \Omega_2}f(x,y)d(\mu_1\otimes \mu_2)(x,y)&=\int_{\Omega_1}\left[ \int_{\Omega_2}f(x,y)d\mu_2(y) \right]d\mu_1(x)\\
                &=\int_{\Omega_2}\left[ \int_{\Omega_1}f(x,y)d\mu_1(x) \right]d\mu_2(y)
                \end{align}
            \end{subequations}
            où tous les membres de l'égalité valent éventuellement \( +\infty\).
    \end{enumerate}
\end{theorem}
\index{théorème!Fubini-Tonelli}

\begin{proof}
    Commençons par prouver le théorème dans le cas d'une fonction caractéristique d'un ensemble mesurable : \( f(x,y)=\mtu_{A}(x,y)\) pour un certain ensemble \( A\subset \Omega_1\times \Omega_2\). Dans ce cas,
    \begin{equation}
        F_1(x)=\int_{\Omega_2}\mtu_A(x,y)d\mu_2(y)=\int_{\Omega_2}\mtu_{A_1(y)}(x)d\mu_2(y)=\mu_2\big( A_1(x) \big),
    \end{equation}
    et nous avons déjà vu au théorème \ref{ThoCCIsLhO} que cette fonction \( F_1\) était alors mesurable. En utilisant maintenant les égalités \eqref{EqDFxuGtH} ainsi que le fait que \( \mtu_A(x,y)=\mtu_{A_2(x)}(y)\) nous avons
    \begin{subequations}
        \begin{align}
            \int_{\Omega_1\times \Omega_2}\mtu_A(x,y)d(\mu_1\otimes \mu_2)(x,y)&=(\mu_1\otimes \mu_2)(A)\\
            &=\int_{\Omega_1}\mu_2\big( A_2(x) \big)d\mu_1(x)\\
            &=\int_{\Omega_1}\left[   \int_{\Omega_2}\mtu_{A_2(x)}(y)d\mu_2(y)  \right]d\mu_1(x)\\
            &=\int_{\Omega_1}\left[ \int_{\Omega_2}\mtu_A(x,y)d\mu_2(y) \right]d\mu_1(x).
        \end{align}
    \end{subequations}
    Le théorème étant valable pour les fonctions caractéristiques, il est valable pour les fonctions simples (définition \ref{DefBPCxdel}) par linéarité de l'intégrale.

    Si \( f\) n'est pas une fonction simple, alors la proposition \ref{THOooXHIVooKUddLi} nous donne une suite croissante de fonctions simples et positives convergeant ponctuellement vers \( f\). La partie du théorème sur les fonctions simples dit que pour chaque \( n\) l'intégrale
    \begin{equation}
        \int_{\Omega_1\times \Omega_2}f_n(x,y)d(\mu_1\otimes\mu_2)(x,y)
    \end{equation}
    peut être décomposée comme il faut en suivant la formule \eqref{EqJRVtOGx}. Il faut pouvoir permuter la limite et l'intégrale dans chacun de cas. D'abord le théorème de la convergence monotone \ref{ThoRRDooFUvEAN} appliqué à l'espace \( \Omega_1\times \Omega_2\) dit que
    \begin{equation}
        \lim_{n\to \infty} \int_{\Omega_1\times \Omega_2}f_n(x,y)d(\mu_1\otimes \mu_2)(x,y)= \int_{\Omega_1\times \Omega_2}f(x,y)d(\mu_1\otimes \mu_2)(x,y).
    \end{equation}
    Ensuite, pour chaque \( x\in\Omega_1\), les fonctions
    \begin{equation}
        \sigma_n(y)=\int_{\Omega_1}f_n(x,y)d\mu_1(x)
    \end{equation}
    forment une suite croissante de fonctions mesurables; nous leur appliquons encore le théorème de la convergence monotone :
    \begin{subequations}
        \begin{align}
            \lim_{n\to \infty} \int_{\Omega_2}\left[ \int_{\Omega_1}f_n(x,y)d\mu_1(x) \right]d\mu_2(y)&=\lim_{n\to \infty} \int_{\Omega_2}\sigma_n(y)d\mu_2(y)\\
            &=\int_{\Omega_2}\left[\lim_{n\to \infty} \int_{\Omega_1}f_n(x,y)d\mu_1(x)\right]d\mu_2(y)\\
            &=\int_{\Omega_2}\left[ \int_{\Omega_1}f(x,y)d\mu_1(x) \right]d\mu_2(y)
        \end{align}
    \end{subequations}
    où nous avons utilisé une seconde fois Beppo-Levi.
\end{proof}

\begin{remark}
    Les formules \eqref{EqJRVtOGx} sont bien, mais ne garantissent en aucun cas que \( f\in L^1(\Omega_1\times \Omega_2)\) : il faut encore que ces intégrales soient finies.
\end{remark}

\begin{corollary}[\cite{MesIntProbb}]           \label{CorTKZKwP}
    Soient \( (\Omega_i,\tribA_i,\mu_i)\) deux espaces mesurés \( \sigma\)-finis, et \( (\Omega,\tribA,\mu)\) l'espace produit\footnote{Définition \ref{DefUMlBCAO}.}. Soit une fonction mesurable \( f\colon \Omega\to \eR\text{ ou }\eC\). Alors les conditions suivantes sont équivalentes
    \begin{enumerate}
        \item   \label{ITEMooZRAXooTRDIlZ}
            \( f\in L^1(\Omega_1\times \Omega_2)\),
        \item       \label{ITEMooJMPLooZKwxQC}
            \begin{equation}
                \int_{\Omega_1}\left[ \int_{\Omega_2}| f |d\mu_2 \right]d\mu_1 <\infty,
            \end{equation}
        \item   \label{ITEMooLLBCooTRycwG}
            \begin{equation}
                \int_{\Omega_2}\left[ \int_{\Omega_1}| f |d\mu_1 \right]d\mu_2 <\infty.
            \end{equation}
    \end{enumerate}
\end{corollary}

\begin{proof}

    Nous commençons par supposer que \( f\) est à valeurs dans \( \eR\). La notation \( | f |\), pour l'instant,  dénote donc bien la valeur absolue et non le module.

    La fonction \( | f |\) est mesurable et positive par hypothèse et par le fait que si \( f\) est mesurable, alors \( | f |\) l'est également par le corollaire \ref{CORooNXYUooEcvDlP}. Le théorème \ref{ThoWTMSthY}\ref{ITEMooFKQUooCoCOLV} nous dit alors que les intégrales suivantes existent et sont égales :
    \begin{equation}        \label{EQooAIQGooNtBOuC}
            \int_{\Omega_1\times \Omega_2}| f |d(\mu_1\otimes \mu_2)=\int_{\Omega_1}\left[ \int_{\Omega_2}|f(x,y)|d\mu_2(y) \right]d\mu_1(x)
            =\int_{\Omega_2}\left[ \int_{\Omega_1}|f(x,y)|d\mu_1(x) \right]d\mu_2(y).
    \end{equation}
    Attention : rien ne dit encore que ces intégrales sont finies.

    \begin{subproof}
        \item[\ref{ITEMooZRAXooTRDIlZ} implique \ref{ITEMooJMPLooZKwxQC} et \ref{ITEMooLLBCooTRycwG}]
            Si \( f\in L^1(\Omega_1\times \Omega_2)\) alors \( | f |\) y est également. Cela implique que le membre de droite de \eqref{EQooAIQGooNtBOuC} est fini. Les deux autres sont alors également finis.
        \item[\ref{ITEMooJMPLooZKwxQC} ou \ref{ITEMooLLBCooTRycwG} implique \ref{ITEMooZRAXooTRDIlZ}]
            Les expressions à droite de \eqref{EQooAIQGooNtBOuC} sont finies. Donc celle de gauche également. Cele signifie que \( | f |\in L^1(\Omega_1\times \Omega_2)\). Par conséquent \( f\) est également dans \(L^1(\Omega_2\times \Omega_2) \).
    \end{subproof}

    Nous passons maintenant au cas où \( f\) est à valeurs dans \( \eC\). Nous décomposons 
    \begin{equation}
        f=f_R+if_I
    \end{equation}
    où \( f_R\) et \( f_I\) sont des fonctions réelles. Nous avons
    \begin{equation}        \label{EQooZEOAooIMwKwk}
        \int_{\Omega}| f |\leq \int_{\Omega}| f_R |+\int_{\Omega}| f_I |.
    \end{equation}
    Donc si \( f_R\) et \( f_I\) sont dans \( L^1(\Omega)\), la fonction \( f\) le sera aussi. De même,
    \begin{equation}
        \int_{\Omega}| f_R |\leq \int_{\Omega}| f |,
    \end{equation}
    qui donne l'inverse : si \( f\in L^1(\Omega)\) alors \( f_R,f_I\in L^1(\Omega)\). Bref, \( f\) est intégrable sur \( \Omega\) si et seulement si \( f_R\) et \( f_I\) le sont.

    Supposons que \( f\in L^1(\Omega_1\times \Omega_2)\). Alors
    \begin{subequations}
        \begin{align}
            \int_{\Omega_1}\left[ \int_{\Omega_2}| f |d\mu_2 \right]d\mu_1&\leq \int_{\Omega_1}\left[ \int_{\Omega_2}| f_R | \right]+\int_{\Omega_1}\left[ \int_{\Omega_2}| f_I | \right]<\infty
        \end{align}
    \end{subequations}
    où nous avons appliqué \ref{ITEMooZRAXooTRDIlZ} implique \ref{ITEMooJMPLooZKwxQC} aux fonctions \( f_R\) et \( f_I\) qui sont dans \( L^1(\Omega_1\times \Omega_2)\) parce que \( f\) y est.

    Dans l'autre sens, si
    \begin{equation}
        \int_{\Omega_1}\left[ \int_{\Omega_2}| f | \right]<\infty,
    \end{equation}
    alors en remplaçant \( | f |\) par \( | f_R |\) ou par \( | f_I |\) nous restons fini. En appliquant alors «\ref{ITEMooJMPLooZKwxQC} implique \ref{ITEMooZRAXooTRDIlZ}» nous trouvons que \( f_R\) et \( f_I\) sont dans \( L^1(\Omega_1\times \Omega_2)\). Et cela implique que \( f\in L^1(\Omega_1\times \Omega_2)\).
\end{proof}

\begin{theorem}[Fubini\cite{MesIntProbb}]\label{ThoFubinioYLtPI}
    Soient \( (\Omega_i,\tribA_i,\mu_i)\) deux espaces mesurés \( \sigma\)-finis, et \( (\Omega,\tribA,\mu)\) l'espace produit. Soit 
    \begin{equation}
        f\in L^1\big( (\Omega,\tribA),\eC \big),
    \end{equation}
    c'est à dire une fonction à valeurs mesurable et intégrable sur \( \Omega\). Alors :
    \begin{enumerate}
        \item       \label{ITEMooVFGWooZTePQS}
            Pour presque tout \( x\in \Omega_1\), la fonction \( y\mapsto f(x,y)\) est \( L^1(\Omega_2)\).
        \item       \label{ITEMooCYMKooUdizni}
            Si nous posons
            \begin{equation}
                \varphi_f(x)=\int_{\Omega_2}f(x,y)d\mu_2(y);
            \end{equation}
            alors \( \varphi_f\in L^1(\Omega_1)\).
        \item   \label{ItemQMWiolgiii}
            Nous avons la formule d'inversion d'intégrale
            \begin{subequations}
                \begin{align}
                \int_{\Omega}fd(\mu_1\otimes \mu_2)&=\int_{\Omega_1}\varphi_fd\mu_1\\
                &=\int_{\Omega_1}\left[ \int_{\Omega_2}f(x,y)d\mu_2(y) \right]d\mu_1(x)\\
                &=\int_{\Omega_2}\left[ \int_{\Omega_1}f(x,y)d\mu_1(x) \right]d\mu_2(y).
                \end{align}
            \end{subequations}
    \end{enumerate}

\end{theorem}
\index{théorème!Fubini!espace mesuré}

\begin{proof}
    Nous commençons par supposer que \( f\) est à valeurs réelles : \( f\in L^1\big( (\Omega_1\times \Omega_2,\tribA_1\otimes\tribA_2 ),\eR\big)\). Nous décomposons la fonction \( f\) en parties positives et négatives : \( f=f^+-f^-\) avec \( f^+\) et \( f^-\) positives ou nulles. Nous avons évidemment
    \begin{equation}
        \int_{\Omega_1\times \Omega_2}| f^+ |\leq \int_{\Omega_1\times \Omega_2}| f |<\infty.
    \end{equation}
    Donc \( f^+\) et \( f^-\) sont des éléments de \( L^1(\Omega_1\times \Omega_2)\). 
    
    \begin{subproof}
    \item[Pour \ref{ITEMooVFGWooZTePQS}]

    Nous posons
    \begin{equation}
        \varphi_{f^+}(x)=\int_{\Omega_2}f^{+}(x,y)d\mu_2(y)
    \end{equation}
    pour tous les \( x\in \Omega_1\) pour lesquels cette intégrale est bien définie. Vu que \( f^+\) est positive et mesurable, le théorème de Fubini-Tonelli \ref{ThoWTMSthY}\ref{ITEMooUTMNooVIBdpP} s'applique donc pour nous dire que \( \varphi_{f^+}\) est mesurable.

    De plus le résultat \eqref{EqJRVtOGx} appliqué à \( f^+\) donne
    \begin{equation}        \label{EQooSETWooRwkCuW}
        \int_{\Omega_1}\varphi_{f^+}d\mu_1=\int_{\Omega_1\times \Omega_2}f^+d(\mu_1\otimes \mu_2)<\infty.
    \end{equation}
    Le fait que le tout soit fini est une conséquence du fait déjà mentionné que \( f^+\in L^1(\Omega_1\times \Omega_2\). Vu que \( \varphi_{f^+}\) est une fonction positive, l'inégalité \eqref{EQooSETWooRwkCuW} signifie que \( \varphi_{f^+}\in L^1(\Omega_1,\mu_1)\).

    En particulier, \( \varphi_{f^+}(x)<\infty\) pour presque tout \( x\in\Omega_1\). C'est à dire pour presque tout \( x\in \Omega_1\) :
    \begin{equation}
        \int_{\Omega_2}f^+(x,y)d\mu_2(y)<\infty,
    \end{equation}
    et sachant que \( f^+\geq 0\) nous avons \( f^+(x,\cdot)\in L^1(\Omega_2)\) pour presque tout \( x\).
    
        \item[Pour \ref{ITEMooCYMKooUdizni}]

            Partout où \( \varphi_{f^+}\) et \( \varphi_{f^-}\) sont finies nous avons
            \begin{equation}
                \varphi_f=\varphi_{f^+}-\varphi_{f^-},
            \end{equation}
            et comme cela a lieu presque partout, nous pouvons considérer une partie mesurable \( A\subset \Omega_1\) telle que \( \mu_1(A)=0\) et \( \varphi_f(x)=\varphi_{f^+}(x)-\varphi_{f^-}(x)\) pour tout \( x\) hors de \( A\). Bref, nous posons
            \begin{equation}
                g(x)=\begin{cases}
                    \varphi_{f^+}-\varphi_{f^-}(x)    &   \text{si } x\in A^c\\
                    0    &    \text{si } x\in A.
                \end{cases}
            \end{equation}
            Cette fonction \( g\) est mesurable et \( g=\varphi_f\) presque partout. De plus
            \begin{equation}
                \int_{\Omega_1}| g |d\mu_1   = \int_{A^c}| g |\leq \int_{A^c}\varphi_{f^+}+\int_{A^c}\varphi_{f^-}<\infty.
            \end{equation}
            La dernière inégalité est le fait que \( \varphi_{f^{\pm}}\) sont dans \( L^1(\Omega_1)\). Et notons au passage que nous aurions pu laisser toutes les intégrales sur \( \Omega_1\) sans faire de précisions sur la distinction entre \( \Omega_1\) et \( A^c\) parce que la partie de \( \Omega_1\) sur laquelle \( \varphi_{f^{\pm}}\) sont infinies est trop petite pour changer la valeur de l'intégrale.

            Nous avons donc \( g\in L^1(\Omega_1)\), et par conséquent également \( \varphi_f\in L^1(\Omega_1)\) parce que ces deux fonctions sont égales presque partout (les classes sont égales).

        \item[Pour \ref{ItemQMWiolgiii}]

            En utilisant l'équation \eqref{EQooSETWooRwkCuW} nous avons
            \begin{subequations}
                \begin{align}
                    \int_{\Omega_1}\varphi_fd\mu_1&=\int gd\mu_1=\int_{\Omega_1}\varphi_{f^+}-\int_{\Omega_1}\varphi_{f^-}\\
                    &=\int_{\Omega_1\times }f^+d\mu-\int_{\Omega_1\times \Omega_2}f^-d\mu\\
                    &=\int_{\Omega_1\times \Omega2}fd\mu.
                \end{align}
            \end{subequations}
            Et toutes ces intégrales sont finies.
    \end{subproof}

    Et c'est maintenant que nous considérons le cas complexe. Nous décomposons \( f=f_R+if_I\) avec des fonctions réelles \( f_R\) et \( f_I\). Comme déjà mentionné autour de \eqref{EQooZEOAooIMwKwk}, les fonctions \( f_R\) et \( f_I\) sont intégrables. Nous leur appliquons le théorème.

    Les valeurs de \( x\) pour lesquelles \( f_R(x,\cdot)\) et \( f_I(x,\cdot)\) ne sont pas dans \( L^1(\Omega_2)\) forment un ensemble de mesure nulle, nommons le \( A\). En posant
    \begin{equation}
        g(x,y)=\begin{cases}
            f_R(x,y)+if_I(x,y)    &   \text{si } x\in A^c\\
            0    &    \text{si } x\in A,
        \end{cases}
    \end{equation}
    nous avons que \( g(x,\cdot)\) est intégrable pour tout \( x\in A^c\). Vu que pour ces valeurs de \( x\) nous avons \( g(x,y)=f(x,y)\) nous en déduisons que pour \( x\in A^c\) nous avons aussi \( f(x,\cdot)\in L^1(\Omega_2)\).

    Les autres points se traitent de la même façon\quext{Attention : je n'ai pas vérifié explicitement. C'est juste une intuition.}.
\end{proof}

\begin{normaltext}      \label{NORMooKIRJooPvyPWQ}
    En pratique, il n'est pas toujours évident qu'une fonction soit intégrable sur \( \Omega_1\times \Omega_2\). Pour permuter des intégrales sur une fonction à deux paramètres nous faisons comme suit.
    \begin{enumerate}
        \item
            Nous testons l'intégrabilité en chaîne de \( | f |\), et si c'est bon, le corollaire \ref{CorTKZKwP} nous donne \( f\in L^1(\Omega_1\times \Omega_2)\).
        \item
            Nous utilisons le théorème de Fubini \ref{ThoFubinioYLtPI} pour séparer et permuter les intégrales comme des ingénieurs.
    \end{enumerate}

    Si la fonction \( (x,y)\mapsto f(x)g(y)\) satisfait aux hypothèse du théorème de Fubini alors
    \begin{equation}    \label{EqTJEEsJW}
        \int_{\Omega_1\times \Omega_2} f(x)g(y)dx\otimes dy=\left( \int_{\Omega_1}f(x)dx \right)\left( \int_{\Omega_2}g(y)dy \right).
    \end{equation}
    Le théorème de Fubini est souvent utilisé sous cette forme.
    
\end{normaltext}

\begin{example}[Nécessité d'avoir des mesures \( \sigma\)-finies]
    Nous montrons que le théorème ne tient pas si une des deux mesures n'est pas \( \sigma\)-finie. Soit \( I=\mathopen[ 0 , 1 \mathclose]\). Nous considérons l'espace mesuré
    \begin{equation}
        (I,\Borelien(I),\lambda)
    \end{equation}
    où \( \Borelien(I)\) est la tribu des boréliens sur \( I\) et \( \lambda\) est la mesure de Lebesgue (qui est $\sigma$-finie). D'autre part nous considérons l'espace mesuré
    \begin{equation}
        (I,\partP(I),m)
    \end{equation}
    où \( \partP(I)\) est l'ensemble des parties de \( I\) et \( m\) est la mesure de comptage. Cette dernière n'est pas $\sigma$-finie parce que les seuls ensembles de mesure finie pour la mesure de comptage sont des ensembles finis, or une union dénombrable d'ensemble finis ne peut pas recouvrir l'intervalle \( I\).

    Nous allons montrer que dans ce cadre, l'intégrale de la fonction indicatrice de la diagonale sur \( I^2\) ne vérifie pas le théorème de Fubini. Étant donné que \( \Borelien(I)\subset\partP(I)\) nous avons
    \begin{equation}
        \Borelien(I^2)\subset\Borelien(I)\otimes\partP(I).
    \end{equation}
    Soit \( \Delta=\{ (x,x)\tq x\in I \}\). La fonction
    \begin{equation}
        \begin{aligned}
            g\colon I^2&\to \eR \\
            (x,y)&\mapsto x-y 
        \end{aligned}
    \end{equation}
    est continue et \( \Delta=g^{-1}(\{ 0 \})\) est donc fermé dans \( I^2\). L'ensemble \( \Delta\) est donc un borélien de \( I^2\) et par conséquent un élément de la tribu \( \Borelien(I)\otimes\partP(I)\). La fonction indicatrice \( \mtu_{\Delta}\) est alors mesurable pour l'espace mesuré
    \begin{equation}
        (I\times I,\Borelien(I)\otimes\partP(I),\lambda\otimes m).
    \end{equation}
    Pour \( x\) fixé nous avons
    \begin{equation}
        \mtu_{\Delta}(x,y)=\begin{cases}
            1    &   \text{si } y= x\\
            1    &    \text{si } y\neq x
        \end{cases}=\mtu_{\{ x \}}(y),
    \end{equation}
    et donc
    \begin{subequations}
        \begin{align}
            A_1&=\int_I\left( \int_I\mtu_{\Delta}(x,y)dm(y) \right)d\lambda(x)\\
            &=\int_I\left( \int_I\mtu_{\{ x \}}(y)dm(y) \right)d\lambda(x)\\
            &=\int_I\Big( m(\{ x \}) \Big)d\lambda(x)\\
            &=\int_I 1d\lambda(x)\\
            &=1.
        \end{align}
    \end{subequations}
    Par contre le support de \( \mtu_{\Delta}\) étant de mesure nulle pour la mesure de Lebesgue, nous avons
    \begin{equation}
        \int_I\mtu_{\Delta}(x,y)d\lambda(x)=0
    \end{equation}
    et par conséquent
    \begin{equation}
        A_2=\int_I\left( \int_I\mtu_{\Delta}(x,y)d\lambda(x) \right)dm(y)=0.
    \end{equation}
    Nous voyons donc que le théorème de Fubini ne s'applique pas.
\end{example}

\begin{example}  \label{EXooLUFAooGcxFUW}
    Nous nous proposons de calculer l'intégrale suivante en utilisant le théorème de Fubini :
    \begin{equation}
        G=\int_{\eR} e^{-x^2}dx=\sqrt{ \pi }
    \end{equation}
    alors que la fonction \( x\mapsto  e^{-x^2}\) n'a pas de primitives parmi les fonctions élémentaires.

    Nous allons le faire de deux façons. Une première directe en utilisant le théorème de Fubini sur un domaine non borné, et une seconde en utilisant Fubini sur un domaine borné, et en passant à la limite ensuite.

    \begin{subproof}
        \item[Fubini, domaine non borné]

    Par symétrie nous pouvons nous contenter de calculer
    \begin{equation}
        G_+=\int_0^{\infty} e^{-x^2}dx.
    \end{equation}
    L'astuce est de passer par l'intermédiaire
    \begin{subequations}
        \begin{align}
            H&=\int_{\eR^+\times\eR^+} e^{-(x^2+y^2)}dxdy       \label{EqIntFausasub}\\
            &=\int_{\eR^+}\left( \int_{\eR^+} e^{-x^2} e^{-y^2}dx \right)dy\\
            &=\left( \int_{\eR^+} e^{-x^2} dx\right)^2\\
            &=G_+^2
        \end{align}
    \end{subequations}
    L'intégrale \eqref{EqIntFausasub} se calcule en passant aux coordonnées polaires et le résultat est \( H=\frac{ \pi }{ 4 }\). Nous avons alors \( G=\frac{ \sqrt{\pi} }{ 2 }\) et
    \begin{equation}
        \int_{\eR} e^{-x^2}=\sqrt{\pi}.
    \end{equation}

        \item[Fubini, domaine borné, puis limite]
    Une variante, qui n'applique pas Fubini sur un domaine non borné. Nous commençons par écrire
\begin{equation}
	I=\int_{-\infty}^{+\infty} e^{-x^2} dx := \lim_{R \to +\infty} \int_{-R}^{+R} e^{-x^2} dx 
\end{equation}
et puis nous faisons le calcul
\begin{equation}		\label{EqCalculInteeemoisxcar}
	\begin{aligned}[]
		I^2 &= \lim_{R \to +\infty} \left( (\int_{-R}^{+R} e^{-x^2} dx)( \int_{-R}^{+R} e^{-y^2} dy) \right) \\
		&= \lim_{R \to +\infty} \left( \iint_{K_R}e^{-(x^2+y^2)} dx dy \right) \\
		&= \lim_{R \to +\infty} \left( \iint_{C_R}e^{-(x^2+y^2)} dx dy \right) 
	\end{aligned}
\end{equation}
où $K$ est le carré de demi côté $R$ centré à l'origine et de côtés parallèles aux axes et $C_R$ est le cercle de rayon $R$ centré à l'origine.

	La première étape à justifier est simplement l'application de Fubini. Pour le passage de l'intégrale du carré vers le cercle, définissons
	\begin{equation}
		\begin{aligned}[]
			I_K(r)&=\int_{K_r}f,&I_C(r)&=\int_{C_r}f
		\end{aligned}
	\end{equation}
	où $K_r$ est la carré de demi côté $r$ et $C_r$ est le cercle de rayon $r$. Le demi côté du carré inscrit à $C_r$ est $\sqrt{2}$, donc pour tout $r$ nous avons
	\begin{equation}
		I_K(\sqrt{2}r)\leq I_C(r)<I_K(r),
	\end{equation}
	et en prenant la limite, nous avons évidement
	\begin{equation}
		\lim_{r\to \infty}I_K(\sqrt{2}r)=\lim_{r\to\infty}I_K(r),
	\end{equation}
	et donc cette limite est également égale à $\lim_{r\to\infty}I_C(t)$.

    Il ne reste qu'à calculer la dernière intégrale sur le cercle en passant aux coordonnées polaires :
	\begin{equation}
        \iint_{C_R} e^{-(x^2+y^2)}dxdy=\int_0^{2\pi}d\theta\int_0^Rr e^{-r^2}dr=\pi(1- e^{-R^2}).
	\end{equation}
	La limite donne $\pi$, nous en déduisons que
    \begin{equation}    \label{EqFDvHTg}
		\int_{-\infty}^{\infty} e^{-x^2}dx=\sqrt{\pi}.
	\end{equation}
    \end{subproof}

\end{example}

Le théorème de Fubini-Tonelli nous permet également d'inverser des sommes et des séries. En effet une somme n'est rien d'autre qu'une intégrale pour la mesure de comptage :
\begin{equation}
    \sum_{n=0}^{\infty}a_n=\int_{\eN}a_ndm(n).
\end{equation}
La proposition suivante montre comment il faut faire.

\begin{proposition}\label{PropInversSumIntFub}  
    Soient les espaces mesurés \( (\eN,\partP(\eN),m)\), \( (\eR^n,\Borelien(\eR^n),\lambda)\) où \( \lambda\) est la mesure de Lebesgue ainsi qu'une suite de fonctions positives \( f_n\colon \eR^d\to \eR\). Nous supposons de plus que la fonction \( f_n\) soit intégrable pour tout \( n\) et que les résultats forment une suite sommable. Alors
    \begin{equation}   
        \sum_{n=0}^{\infty}\int_{\eR^n}f_n(x)dx=\int_{\eR^d}\sum_{n\in \eN}f_n(x)dx.
    \end{equation}
\end{proposition}
\index{mesure!de comptage}
\index{permuter!intégrale!et série}

\begin{proof}
    Nous pouvons la récrire le membre de gauche sous la forme
    \begin{equation}
        \int_{\eN}\left( \int_{\eR^n}f(n,x)dx \right)dm(n)
    \end{equation}
    avec la notation évidente \( f(n,x)=f_n(x)\). Prouvons que la fonction \( f\colon \eN\times\eR^d\to \eR\) ainsi définie est une fonction mesurable pour l'espace mesuré
    \begin{equation}
        \big( \eN\times\eR^d,\partP(\eN)\otimes\Borelien(\eR^d),m\otimes\lambda \big).
    \end{equation}
    Si \( A\subset\eR\), nous avons
    \begin{equation}
        f^{-1}(A)=\bigcup_{n\in\eN}\{ n \}\times f_n^{-1}(A).
    \end{equation}
    Chacun des ensembles dans l'union appartient à la tribu \( \partP(\eN)\times\Borelien(\eR^d)\) tandis que les tribus sont stables sous les unions dénombrables. La fonction \( f\) est donc mesurable. Comme nous avons supposé que \( f\) était positive, le théorème de Fubini-Tonelli s'applique et nous avons
    \begin{equation}
        \int_{\eR^d}\left( \int_{\eN}f(n,x)dm(n) \right)dx=\int_{\eR^d}\sum_{n\in \eN}f_n(x)dx.
    \end{equation}
\end{proof}

\begin{theorem}[Fubini]\label{ThoFubini}
Soit $(x,t)\mapsto f(x,y)\in\bar \eR$ une fonction intégrable sur $B_n\times B_m\subset\eR^{n+m}$ où $B_n$ et $B_m$ sont des ensembles mesurables de $\eR^n$ et $\eR^m$. Alors :
\begin{enumerate}
\item pour tout $x\in B_n$, sauf éventuellement en les points d'un ensemble $G\subset B_n$ de mesure nulle, la fonction $y\in B_m\mapsto f(x,y)\in\bar\eR$ est intégrable sur $B_m$
\item
la fonction
\begin{equation}
	x\in B_n\setminus G\mapsto\int_{B_m}f(x,y)dy\in\eR
\end{equation}
est intégrable sur $B_n\setminus G$

\item 
On a
\begin{equation}
	\int_{B_n\times B_m}f(x,y)dxdy=\int_{B_n}\left( \int_{B_m}f(x,y)dy \right)dx.
\end{equation}

\end{enumerate}
\end{theorem}
\index{théorème!Fubini!dans $ \eR^n$}
\index{Fubini!théorème!dans $ \eR^n$}

Notons en particulier que si $f(x,y)=\varphi(x)\phi(y)$, alors $\int_{B_m}\varphi(y)dy$ est une constante qui peut sortir de l'intégrale sur $B_n$, et donc
\begin{equation}		\label{EqFubiniFactori}
	\int_{B_n\times B_m}\varphi(x)\phi(y)dxdy=\int_{B_n}\varphi(x)dx\int_{B_m}\phi(y)dy.
\end{equation}
